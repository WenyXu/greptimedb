
running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 32 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 7 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 1 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 20 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 4 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 23 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 4 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 9 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 37 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 2 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 3 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 25 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 6 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 3 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 80 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 2 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 23 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 1 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 8 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 1 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 232 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 47 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 9 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 13 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 10 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 10 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 95 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 7 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 22 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 229 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 3 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 63 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 7 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 63 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 42 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 26 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 152 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 29 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 395 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 6 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 7 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 22 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 16 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 36 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 4 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 5 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 3 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 2 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 6 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 4 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 4 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 2 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 3 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 6 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 2 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 88 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 64 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 126 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 16 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 72 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 3 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 52 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 2 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 158 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 41 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 36 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 20 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 126 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 0 tests

test result: ok. 0 passed; 0 failed; 0 ignored; 0 measured; 0 filtered out; finished in 0.00s


running 186 tests
test integration_grpc_gcs_test::test_insert_and_select ... ok
test integration_grpc_azblob_test::test_prom_gateway_query ... ok
test integration_grpc_azblob_test::test_grpc_timezone ... ok
test integration_grpc_azblob_test::test_grpc_zstd_compression ... ok
test integration_grpc_azblob_test::test_insert_and_select ... ok
test integration_grpc_azblob_test::test_health_check ... ok
test integration_grpc_azblob_test::test_grpc_auth ... ok
test integration_grpc_azblob_test::test_grpc_message_size_limit_send ... ok
test integration_grpc_azblob_test::test_invalid_dbname ... ok
test integration_grpc_azblob_test::test_auto_create_table ... ok
test integration_grpc_gcs_test::test_auto_create_table ... ok
test integration_grpc_azblob_test::test_dbname ... ok
test integration_grpc_oss_test::test_grpc_auth ... ok
test integration_grpc_azblob_test::test_auto_create_table_with_hints ... ok
test integration_grpc_oss_test::test_grpc_tls_config ... ok
test integration_grpc_gcs_test::test_grpc_message_size_limit_send ... ok
test integration_grpc_oss_test::test_auto_create_table ... ok
test integration_grpc_gcs_test::test_grpc_timezone ... ok
2024-08-28T16:27:43.240112Z  INFO common_telemetry::logging: logs dir = /tmp/__unittest_logs
2024-08-28T16:27:43.240563Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.240563Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.240644Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.240630Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.240949Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.240946Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.241817Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.242393Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.242409Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.242438Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.242449Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.242458Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.242470Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.242576Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.242579Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.242613Z  INFO log: Recovering raft logs takes 536.077µs    
test integration_grpc_azblob_test::test_grpc_message_size_ok ... ok
2024-08-28T16:27:43.243508Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.243856Z  INFO log: Recovering raft logs takes 869.029µs    
2024-08-28T16:27:43.244166Z  INFO servers::grpc: gRPC server is bound to 127.0.0.1:45383
2024-08-28T16:27:43.244225Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 114s
2024-08-28T16:27:43.244246Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 32s
2024-08-28T16:27:43.244250Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 115s
2024-08-28T16:27:43.244304Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 142s
2024-08-28T16:27:43.244411Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 131s
2024-08-28T16:27:43.244525Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 124s
2024-08-28T16:27:43.244368Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 9s
2024-08-28T16:27:43.244444Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 83s
2024-08-28T16:27:43.244670Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 10s
2024-08-28T16:27:43.244560Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 64s
2024-08-28T16:27:43.245073Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 43s
2024-08-28T16:27:43.245154Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 85s
2024-08-28T16:27:43.245188Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 63s
2024-08-28T16:27:43.245232Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 154s
2024-08-28T16:27:43.245256Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 158s
2024-08-28T16:27:43.245343Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 11s
2024-08-28T16:27:43.245330Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 137s
2024-08-28T16:27:43.245381Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 179s
2024-08-28T16:27:43.245405Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 78s
2024-08-28T16:27:43.245547Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.245544Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 53s
2024-08-28T16:27:43.245682Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 51s
2024-08-28T16:27:43.245681Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 107s
2024-08-28T16:27:43.245796Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 159s
2024-08-28T16:27:43.245804Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 62s
2024-08-28T16:27:43.245842Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 27s
2024-08-28T16:27:43.246051Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 170s
2024-08-28T16:27:43.246048Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.246134Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.246174Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.246281Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.246501Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.246611Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.248729Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
test integration_grpc_gcs_test::test_dbname ... ok
2024-08-28T16:27:43.250533Z  INFO servers::grpc: gRPC server is bound to 127.0.0.1:36241
2024-08-28T16:27:43.251046Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.251171Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_prom_gatewayKwQcVf/
test integration_grpc_s3_test::test_grpc_message_size_limit_send ... ok
2024-08-28T16:27:43.251912Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_prom_gatewayKwQcVf/wal/
2024-08-28T16:27:43.251976Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.252045Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 38s
2024-08-28T16:27:43.251978Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.252129Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 140s
2024-08-28T16:27:43.252187Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.252220Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 142s
2024-08-28T16:27:43.252271Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 84s
2024-08-28T16:27:43.252358Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 15s
2024-08-28T16:27:43.252437Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 169s
2024-08-28T16:27:43.252517Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 170s
2024-08-28T16:27:43.252556Z  INFO log: Recovering raft logs takes 546.597µs    
2024-08-28T16:27:43.252587Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 116s
2024-08-28T16:27:43.252623Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 75s
2024-08-28T16:27:43.252794Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 174s
2024-08-28T16:27:43.253212Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 83s
2024-08-28T16:27:43.253231Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.253263Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.253287Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.253285Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 160s
2024-08-28T16:27:43.253374Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 2s
2024-08-28T16:27:43.253387Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.253511Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 158s
2024-08-28T16:27:43.253549Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.253598Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 81s
2024-08-28T16:27:43.253726Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 68s
2024-08-28T16:27:43.253813Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 29s
2024-08-28T16:27:43.253810Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 75s
2024-08-28T16:27:43.253891Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 37s
2024-08-28T16:27:43.254108Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 117s
2024-08-28T16:27:43.254206Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 74s
2024-08-28T16:27:43.254249Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 85s
2024-08-28T16:27:43.254341Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 160s
2024-08-28T16:27:43.254375Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 157s
2024-08-28T16:27:43.254471Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 117s
2024-08-28T16:27:43.254524Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.254542Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 159s
2024-08-28T16:27:43.254575Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.254594Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.254627Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.254693Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.254855Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.255861Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.256317Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 108s
2024-08-28T16:27:43.256328Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 33s
2024-08-28T16:27:43.256379Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 38s
2024-08-28T16:27:43.256437Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 173s
2024-08-28T16:27:43.256430Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 172s
2024-08-28T16:27:43.256462Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 11s
2024-08-28T16:27:43.256484Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 143s
2024-08-28T16:27:43.256504Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 11s
2024-08-28T16:27:43.256489Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 19s
2024-08-28T16:27:43.256575Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 28s
2024-08-28T16:27:43.256847Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 54s
test integration_grpc_oss_test::test_auto_create_table_with_hints ... ok
2024-08-28T16:27:43.256962Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 147s
2024-08-28T16:27:43.257168Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 100s
2024-08-28T16:27:43.257173Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 73s
2024-08-28T16:27:43.257166Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.257271Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 87s
2024-08-28T16:27:43.257391Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 69s
2024-08-28T16:27:43.257581Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 82s
2024-08-28T16:27:43.257614Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 165s
2024-08-28T16:27:43.257646Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 2s
2024-08-28T16:27:43.257645Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 60s
2024-08-28T16:27:43.257676Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 51s
2024-08-28T16:27:43.257704Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 83s
2024-08-28T16:27:43.257789Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 169s
2024-08-28T16:27:43.257870Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 33s
2024-08-28T16:27:43.257884Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 145s
2024-08-28T16:27:43.257867Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 46s
2024-08-28T16:27:43.257893Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.257933Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.257958Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.258036Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.258181Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.259311Z  INFO servers::grpc: gRPC server is bound to 127.0.0.1:46535
test integration_grpc_gcs_test::test_grpc_message_size_ok ... ok
test integration_grpc_gcs_test::test_health_check ... ok
2024-08-28T16:27:43.261598Z  INFO servers::grpc: gRPC server is bound to 127.0.0.1:45823
test integration_grpc_oss_test::test_dbname ... ok
test integration_grpc_gcs_test::test_grpc_auth ... ok
test integration_grpc_oss_test::test_insert_and_select ... ok
test integration_grpc_gcs_test::test_auto_create_table_with_hints ... ok
2024-08-28T16:27:43.264451Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.264422Z  INFO flow::server: Flow Worker started in new thread
test integration_grpc_oss_test::test_grpc_message_size_ok ... ok
2024-08-28T16:27:43.264801Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
test integration_grpc_oss_test::test_health_check ... ok
2024-08-28T16:27:43.266489Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.266555Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.266579Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.266715Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
test integration_grpc_oss_test::test_grpc_zstd_compression ... ok
test integration_grpc_oss_test::test_prom_gateway_query ... ok
test integration_grpc_s3_test::test_grpc_tls_config ... ok
test integration_grpc_gcs_test::test_grpc_tls_config ... ok
test integration_grpc_oss_test::test_grpc_message_size_limit_recv ... ok
test integration_grpc_oss_test::test_invalid_dbname ... ok
test integration_grpc_s3_test::test_auto_create_table_with_hints ... ok
test integration_grpc_s3_test::test_grpc_message_size_limit_recv ... ok
2024-08-28T16:27:43.268915Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.269176Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.268905Z  INFO flow::server: Flow Worker started in new thread
test integration_grpc_gcs_test::test_grpc_message_size_limit_recv ... ok
2024-08-28T16:27:43.270840Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_insert_and_selectubMqXd/
2024-08-28T16:27:43.271098Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.271148Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.271165Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.271292Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
test integration_grpc_oss_test::test_grpc_timezone ... ok
test integration_grpc_s3_test::test_dbname ... ok
test integration_grpc_gcs_test::test_invalid_dbname ... ok
test integration_grpc_oss_test::test_grpc_message_size_limit_send ... ok
2024-08-28T16:27:43.274805Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_insert_and_selectubMqXd/wal/
test integration_grpc_s3_test::test_grpc_message_size_ok ... ok
test integration_grpc_azblob_test::test_grpc_message_size_limit_recv ... ok
test integration_grpc_azblob_test::test_grpc_tls_config ... ok
test integration_grpc_s3_test::test_grpc_auth ... ok
test integration_grpc_s3_test::test_auto_create_table ... ok
test integration_grpc_gcs_test::test_grpc_zstd_compression ... ok
test integration_grpc_s3_test::test_grpc_timezone ... ok
test integration_grpc_gcs_test::test_prom_gateway_query ... ok
2024-08-28T16:27:43.500445Z  INFO log: Recovering raft logs takes 225.376989ms    
2024-08-28T16:27:43.506183Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.510730Z  INFO servers::grpc: gRPC server is bound to 127.0.0.1:36171
2024-08-28T16:27:43.512863Z  INFO servers::grpc: gRPC server is bound to 127.0.0.1:45633
2024-08-28T16:27:43.520341Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.523917Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.525637Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 177s
2024-08-28T16:27:43.525650Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 132s
2024-08-28T16:27:43.525673Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 141s
2024-08-28T16:27:43.525783Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 47s
2024-08-28T16:27:43.525796Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 94s
2024-08-28T16:27:43.525897Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 116s
2024-08-28T16:27:43.525964Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 4s
2024-08-28T16:27:43.526051Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 45s
test integration_grpc_s3withcache_test::test_auto_create_table_with_hints ... ok
2024-08-28T16:27:43.526143Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 120s
2024-08-28T16:27:43.526227Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 25s
2024-08-28T16:27:43.527002Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 75s
2024-08-28T16:27:43.527026Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 151s
2024-08-28T16:27:43.527052Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 165s
2024-08-28T16:27:43.527069Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 109s
2024-08-28T16:27:43.527105Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 23s
2024-08-28T16:27:43.527107Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 156s
2024-08-28T16:27:43.527142Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 155s
2024-08-28T16:27:43.527154Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 33s
2024-08-28T16:27:43.527141Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 85s
2024-08-28T16:27:43.527214Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 114s
2024-08-28T16:27:43.527187Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 175s
2024-08-28T16:27:43.527208Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 66s
2024-08-28T16:27:43.527237Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 164s
2024-08-28T16:27:43.527289Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 25s
2024-08-28T16:27:43.527339Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 65s
2024-08-28T16:27:43.527397Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 123s
2024-08-28T16:27:43.527430Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.527514Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.527555Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.527750Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.527996Z  INFO datanode::datanode: all regions are opened
test integration_grpc_s3withcache_test::test_auto_create_table ... ok
test integration_grpc_s3_test::test_insert_and_select ... ok
test integration_grpc_s3_test::test_prom_gateway_query ... ok
test integration_grpc_s3_test::test_health_check ... ok
test integration_grpc_s3withcache_test::test_dbname ... ok
test integration_grpc_s3withcache_test::test_grpc_message_size_limit_send ... ok
test integration_grpc_s3_test::test_grpc_zstd_compression ... ok
test integration_grpc_s3withcache_test::test_grpc_auth ... ok
2024-08-28T16:27:43.542012Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.542005Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.542370Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
test integration_grpc_s3_test::test_invalid_dbname ... ok
2024-08-28T16:27:43.544142Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.544218Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.544235Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.544497Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
test integration_grpc_s3withcache_test::test_grpc_message_size_limit_recv ... ok
2024-08-28T16:27:43.554034Z  INFO servers::grpc: gRPC server is bound to 127.0.0.1:42647
test integration_grpc_s3withcache_test::test_grpc_tls_config ... ok
test integration_http_azblob_test::test_scripts_api ... ok
2024-08-28T16:27:43.687580Z  INFO log: Recovering raft logs takes 1.549263ms    
2024-08-28T16:27:43.692944Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.698872Z  INFO log: Recovering raft logs takes 703.479µs    
2024-08-28T16:27:43.702623Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.706919Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_config_apiwSJOm0/
2024-08-28T16:27:43.710447Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_config_apiwSJOm0/wal/
2024-08-28T16:27:43.713767Z  INFO log: Recovering raft logs takes 3.010229ms    
2024-08-28T16:27:43.715244Z  INFO log: Recovering raft logs takes 1.824442ms    
2024-08-28T16:27:43.718735Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_health_apiYMKOkH/
2024-08-28T16:27:43.722436Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.722625Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.729893Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.733474Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.736054Z  INFO log: Recovering raft logs takes 1.428034ms    
2024-08-28T16:27:43.737004Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 28s
2024-08-28T16:27:43.737070Z  INFO log: Recovering raft logs takes 1.261388ms    
2024-08-28T16:27:43.737182Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 177s
2024-08-28T16:27:43.737672Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 160s
2024-08-28T16:27:43.737707Z  INFO log: Recovering raft logs takes 633.935µs    
2024-08-28T16:27:43.737823Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 91s
2024-08-28T16:27:43.737926Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 6s
2024-08-28T16:27:43.738094Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.738228Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 151s
2024-08-28T16:27:43.738817Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.738721Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.739095Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 108s
2024-08-28T16:27:43.739433Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 175s
2024-08-28T16:27:43.739500Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 159s
2024-08-28T16:27:43.740157Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_apig0Djv8/
2024-08-28T16:27:43.741235Z  INFO log: Recovering raft logs takes 576.219µs    
2024-08-28T16:27:43.741629Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 70s
2024-08-28T16:27:43.741567Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.742150Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 162s
2024-08-28T16:27:43.742191Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 140s
2024-08-28T16:27:43.742233Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 141s
2024-08-28T16:27:43.742244Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 7s
2024-08-28T16:27:43.742295Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 176s
2024-08-28T16:27:43.742349Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 68s
2024-08-28T16:27:43.742383Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 41s
2024-08-28T16:27:43.742420Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 82s
2024-08-28T16:27:43.742441Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 0ns
2024-08-28T16:27:43.742478Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 77s
2024-08-28T16:27:43.742779Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 84s
2024-08-28T16:27:43.742754Z  INFO log: Recovering raft logs takes 613.488µs    
2024-08-28T16:27:43.742993Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 29s
2024-08-28T16:27:43.743120Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 9s
2024-08-28T16:27:43.743196Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 29s
2024-08-28T16:27:43.743785Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.743956Z  INFO log: Recovering raft logs takes 785.09µs    
2024-08-28T16:27:43.744068Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 163s
2024-08-28T16:27:43.744279Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 135s
2024-08-28T16:27:43.744286Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.744384Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.744414Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.744435Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.744561Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.744726Z  INFO log: Recovering raft logs takes 1.721141ms    
2024-08-28T16:27:43.744791Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.744999Z  INFO log: Recovering raft logs takes 958.966µs    
2024-08-28T16:27:43.745057Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.745421Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.747899Z  INFO log: Recovering raft logs takes 1.146914ms    
2024-08-28T16:27:43.748011Z  INFO log: Recovering raft logs takes 919.152µs    
2024-08-28T16:27:43.748860Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_test_pipeline_apigk0Lrl/
2024-08-28T16:27:43.749223Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.750003Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_metrics_apihcHV5g/
2024-08-28T16:27:43.750202Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:43.751265Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_health_apiYMKOkH/wal/
2024-08-28T16:27:43.751965Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_test_pipeline_apigk0Lrl/wal/
2024-08-28T16:27:43.752236Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_metrics_apihcHV5g/wal/
2024-08-28T16:27:43.752430Z  INFO log: Recovering raft logs takes 829.371µs    
2024-08-28T16:27:43.753566Z  INFO log: Recovering raft logs takes 1.063106ms    
2024-08-28T16:27:43.753668Z  INFO log: Recovering raft logs takes 1.479704ms    
2024-08-28T16:27:43.753933Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_promql_apiDXZXGT/
2024-08-28T16:27:43.754115Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_api1smrkN/
2024-08-28T16:27:43.754124Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_apiMuyJeu/
2024-08-28T16:27:43.754283Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.754338Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_prometheus_remote_writeQknRrj/
2024-08-28T16:27:43.754754Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_script_apiW0JMQZ/
2024-08-28T16:27:43.755965Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_vm_proto_remote_writeKF0x9c/
2024-08-28T16:27:43.756531Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.756993Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.757957Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_promql_apiDXZXGT/wal/
2024-08-28T16:27:43.758524Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_apig0Djv8/wal/
2024-08-28T16:27:43.759002Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.759202Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_status_apiLz1spK/
2024-08-28T16:27:43.759203Z  INFO log: Recovering raft logs takes 901.673µs    
2024-08-28T16:27:43.759573Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_apiMuyJeu/wal/
2024-08-28T16:27:43.760065Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.760205Z  INFO log: Recovering raft logs takes 1.477219ms    
2024-08-28T16:27:43.760439Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_vm_proto_remote_writeKF0x9c/wal/
2024-08-28T16:27:43.760656Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.760805Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_test_pipeline_apih4fCe6/
2024-08-28T16:27:43.760830Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_status_apiLz1spK/wal/
2024-08-28T16:27:43.760934Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 36s
2024-08-28T16:27:43.761000Z  INFO log: Recovering raft logs takes 1.249581ms    
2024-08-28T16:27:43.760866Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_prometheus_remote_writeQknRrj/wal/
2024-08-28T16:27:43.761100Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 134s
2024-08-28T16:27:43.761140Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.761177Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 169s
2024-08-28T16:27:43.761198Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 169s
2024-08-28T16:27:43.761322Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 162s
2024-08-28T16:27:43.761126Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.761467Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 124s
2024-08-28T16:27:43.761464Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.761535Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 34s
2024-08-28T16:27:43.761568Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.761671Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_script_apiW0JMQZ/wal/
2024-08-28T16:27:43.761709Z  INFO log: Recovering raft logs takes 741.438µs    
2024-08-28T16:27:43.761727Z  INFO log: Recovering raft logs takes 994.501µs    
2024-08-28T16:27:43.761895Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 24s
2024-08-28T16:27:43.761966Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 132s
2024-08-28T16:27:43.762138Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 134s
2024-08-28T16:27:43.762237Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 66s
2024-08-28T16:27:43.762311Z  INFO log: Recovering raft logs takes 1.129215ms    
2024-08-28T16:27:43.762537Z  INFO log: Recovering raft logs takes 746.369µs    
2024-08-28T16:27:43.762519Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 19s
2024-08-28T16:27:43.762602Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.762735Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 28s
2024-08-28T16:27:43.762774Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.762960Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 0ns
2024-08-28T16:27:43.762994Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 139s
2024-08-28T16:27:43.763086Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.763134Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 169s
test integration_grpc_s3withcache_test::test_prom_gateway_query ... ok
2024-08-28T16:27:43.763250Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.763307Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.763337Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.763341Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.763400Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 80s
2024-08-28T16:27:43.763477Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.763649Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.763886Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 0ns
2024-08-28T16:27:43.763980Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.764289Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 104s
2024-08-28T16:27:43.764371Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.764390Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.764652Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 27s
2024-08-28T16:27:43.764732Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 177s
2024-08-28T16:27:43.764837Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 107s
2024-08-28T16:27:43.764987Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 61s
2024-08-28T16:27:43.765013Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 143s
2024-08-28T16:27:43.765108Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 34s
2024-08-28T16:27:43.765096Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_test_pipeline_apih4fCe6/wal/
2024-08-28T16:27:43.765162Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 58s
2024-08-28T16:27:43.765174Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 41s
2024-08-28T16:27:43.765227Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 68s
2024-08-28T16:27:43.765261Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 111s
2024-08-28T16:27:43.765260Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 35s
2024-08-28T16:27:43.765271Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 87s
2024-08-28T16:27:43.765341Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 37s
2024-08-28T16:27:43.765531Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 172s
2024-08-28T16:27:43.765030Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_api1smrkN/wal/
2024-08-28T16:27:43.765760Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 154s
2024-08-28T16:27:43.765855Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 27s
2024-08-28T16:27:43.765988Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 40s
2024-08-28T16:27:43.766072Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 28s
2024-08-28T16:27:43.766122Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 123s
2024-08-28T16:27:43.766171Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.766180Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 9s
2024-08-28T16:27:43.766242Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.766283Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.766354Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.766394Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.766409Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 162s
2024-08-28T16:27:43.766456Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 39s
2024-08-28T16:27:43.766452Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 176s
2024-08-28T16:27:43.766506Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.766504Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 69s
2024-08-28T16:27:43.766532Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 172s
2024-08-28T16:27:43.766536Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.766549Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 116s
2024-08-28T16:27:43.766569Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.766580Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.766592Z  INFO log: Recovering raft logs takes 1.377149ms    
2024-08-28T16:27:43.766618Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 170s
2024-08-28T16:27:43.766704Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 104s
2024-08-28T16:27:43.766769Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 18s
2024-08-28T16:27:43.766817Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 76s
2024-08-28T16:27:43.766834Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.766833Z  INFO log: Recovering raft logs takes 1.108671ms    
2024-08-28T16:27:43.766844Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 57s
2024-08-28T16:27:43.766897Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 106s
2024-08-28T16:27:43.766895Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 36s
2024-08-28T16:27:43.766914Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.766921Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.766966Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.766976Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 140s
2024-08-28T16:27:43.766995Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.767020Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 22s
2024-08-28T16:27:43.767035Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 73s
2024-08-28T16:27:43.767046Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.767064Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 92s
2024-08-28T16:27:43.767098Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.767114Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 66s
2024-08-28T16:27:43.767133Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 61s
2024-08-28T16:27:43.767148Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 133s
2024-08-28T16:27:43.767166Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 9s
2024-08-28T16:27:43.767195Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 5s
2024-08-28T16:27:43.767220Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 74s
2024-08-28T16:27:43.767267Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.767273Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 148s
2024-08-28T16:27:43.767304Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 119s
2024-08-28T16:27:43.767330Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 152s
2024-08-28T16:27:43.767399Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 105s
2024-08-28T16:27:43.767410Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 165s
2024-08-28T16:27:43.767449Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 138s
2024-08-28T16:27:43.767520Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 144s
2024-08-28T16:27:43.767537Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 106s
2024-08-28T16:27:43.767552Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 26s
2024-08-28T16:27:43.767614Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 115s
2024-08-28T16:27:43.767615Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.767630Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 175s
2024-08-28T16:27:43.767702Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 132s
2024-08-28T16:27:43.767730Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.767738Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 128s
2024-08-28T16:27:43.767803Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 138s
2024-08-28T16:27:43.767815Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 52s
2024-08-28T16:27:43.767871Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 97s
2024-08-28T16:27:43.767882Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 27s
2024-08-28T16:27:43.767915Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 32s
2024-08-28T16:27:43.767932Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 163s
2024-08-28T16:27:43.767975Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 52s
2024-08-28T16:27:43.768009Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 40s
2024-08-28T16:27:43.768053Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.768060Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 142s
2024-08-28T16:27:43.768078Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 144s
2024-08-28T16:27:43.768103Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 172s
2024-08-28T16:27:43.768131Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 102s
2024-08-28T16:27:43.768133Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 160s
2024-08-28T16:27:43.768160Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 25s
2024-08-28T16:27:43.768152Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 45s
2024-08-28T16:27:43.768173Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 94s
2024-08-28T16:27:43.768187Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 170s
2024-08-28T16:27:43.768185Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.768206Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 117s
2024-08-28T16:27:43.768237Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 75s
2024-08-28T16:27:43.768237Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 171s
2024-08-28T16:27:43.768245Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 19s
2024-08-28T16:27:43.768271Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 36s
2024-08-28T16:27:43.768235Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 3s
2024-08-28T16:27:43.768275Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 80s
2024-08-28T16:27:43.768293Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 166s
2024-08-28T16:27:43.768306Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 85s
2024-08-28T16:27:43.768324Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 7s
2024-08-28T16:27:43.768335Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 174s
2024-08-28T16:27:43.768347Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 81s
2024-08-28T16:27:43.768355Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 50s
2024-08-28T16:27:43.768363Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.768365Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 55s
2024-08-28T16:27:43.768372Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 87s
2024-08-28T16:27:43.768393Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 18s
2024-08-28T16:27:43.768396Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 159s
2024-08-28T16:27:43.768414Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 48s
2024-08-28T16:27:43.768417Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 152s
2024-08-28T16:27:43.768440Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 66s
2024-08-28T16:27:43.768456Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 123s
2024-08-28T16:27:43.768467Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 115s
2024-08-28T16:27:43.768460Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 18s
2024-08-28T16:27:43.768483Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 160s
2024-08-28T16:27:43.768491Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 133s
2024-08-28T16:27:43.768502Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.768519Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 107s
2024-08-28T16:27:43.768533Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 106s
2024-08-28T16:27:43.768535Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 4s
2024-08-28T16:27:43.768549Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 101s
2024-08-28T16:27:43.768569Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.768608Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.768606Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 93s
2024-08-28T16:27:43.768610Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 113s
2024-08-28T16:27:43.768641Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 76s
2024-08-28T16:27:43.768669Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 11s
2024-08-28T16:27:43.768688Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 148s
2024-08-28T16:27:43.768710Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 159s
2024-08-28T16:27:43.768712Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 135s
2024-08-28T16:27:43.768725Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 110s
2024-08-28T16:27:43.768734Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.768758Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 29s
2024-08-28T16:27:43.768748Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 44s
2024-08-28T16:27:43.768755Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 29s
2024-08-28T16:27:43.768893Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 134s
2024-08-28T16:27:43.768910Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 2s
2024-08-28T16:27:43.768940Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 19s
2024-08-28T16:27:43.768965Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 112s
2024-08-28T16:27:43.768990Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 125s
2024-08-28T16:27:43.768997Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.769006Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 163s
2024-08-28T16:27:43.769010Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 30s
2024-08-28T16:27:43.769014Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 125s
2024-08-28T16:27:43.769030Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 38s
2024-08-28T16:27:43.769050Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 13s
2024-08-28T16:27:43.769059Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 76s
2024-08-28T16:27:43.769066Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 27s
2024-08-28T16:27:43.769063Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 6s
2024-08-28T16:27:43.769072Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 105s
2024-08-28T16:27:43.769090Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 160s
2024-08-28T16:27:43.769109Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 142s
2024-08-28T16:27:43.769126Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 82s
2024-08-28T16:27:43.769139Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 114s
2024-08-28T16:27:43.769138Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 165s
2024-08-28T16:27:43.769150Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 117s
2024-08-28T16:27:43.769181Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 108s
2024-08-28T16:27:43.769183Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 23s
2024-08-28T16:27:43.769188Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 157s
2024-08-28T16:27:43.769206Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 3s
2024-08-28T16:27:43.769213Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 58s
2024-08-28T16:27:43.769213Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 8s
2024-08-28T16:27:43.769250Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 70s
2024-08-28T16:27:43.769253Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 29s
2024-08-28T16:27:43.769268Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 15s
2024-08-28T16:27:43.769287Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 101s
2024-08-28T16:27:43.769291Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 142s
2024-08-28T16:27:43.769303Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 160s
2024-08-28T16:27:43.769307Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 149s
2024-08-28T16:27:43.769326Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 125s
2024-08-28T16:27:43.769337Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 1s
2024-08-28T16:27:43.769341Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 178s
2024-08-28T16:27:43.769338Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 109s
2024-08-28T16:27:43.769328Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 16s
2024-08-28T16:27:43.769349Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.769367Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 119s
2024-08-28T16:27:43.769381Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 122s
2024-08-28T16:27:43.769382Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 65s
2024-08-28T16:27:43.769391Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 69s
2024-08-28T16:27:43.769395Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 160s
2024-08-28T16:27:43.769399Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.769407Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 18s
2024-08-28T16:27:43.769413Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.769435Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.769441Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 115s
2024-08-28T16:27:43.769445Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 61s
2024-08-28T16:27:43.769451Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 129s
2024-08-28T16:27:43.769455Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.769448Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.769458Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 108s
2024-08-28T16:27:43.769467Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 147s
2024-08-28T16:27:43.769481Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 63s
2024-08-28T16:27:43.769479Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 134s
2024-08-28T16:27:43.769495Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 172s
2024-08-28T16:27:43.769510Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 83s
2024-08-28T16:27:43.769522Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 53s
2024-08-28T16:27:43.769517Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.769535Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 10s
2024-08-28T16:27:43.769543Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 82s
2024-08-28T16:27:43.769542Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.769546Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 136s
2024-08-28T16:27:43.769556Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 108s
2024-08-28T16:27:43.769566Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.769558Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 136s
2024-08-28T16:27:43.769563Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.769579Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 115s
2024-08-28T16:27:43.769589Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.769589Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 139s
2024-08-28T16:27:43.769600Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 125s
2024-08-28T16:27:43.769628Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 103s
2024-08-28T16:27:43.769647Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 10s
2024-08-28T16:27:43.769656Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.769665Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.769674Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 88s
2024-08-28T16:27:43.769669Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 148s
2024-08-28T16:27:43.769681Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 63s
2024-08-28T16:27:43.769692Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 116s
2024-08-28T16:27:43.769740Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 114s
2024-08-28T16:27:43.769732Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 156s
2024-08-28T16:27:43.769745Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 163s
2024-08-28T16:27:43.769763Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.769757Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.769768Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 12s
2024-08-28T16:27:43.769771Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 104s
2024-08-28T16:27:43.769817Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 79s
2024-08-28T16:27:43.769815Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 76s
2024-08-28T16:27:43.769879Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 59s
2024-08-28T16:27:43.769904Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 100s
2024-08-28T16:27:43.769924Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 37s
2024-08-28T16:27:43.769951Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 11s
2024-08-28T16:27:43.769967Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 68s
2024-08-28T16:27:43.769985Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 135s
2024-08-28T16:27:43.769999Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 76s
2024-08-28T16:27:43.770024Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 41s
2024-08-28T16:27:43.770026Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 137s
2024-08-28T16:27:43.770043Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 60s
2024-08-28T16:27:43.770044Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 80s
2024-08-28T16:27:43.770057Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 40s
2024-08-28T16:27:43.770049Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 22s
2024-08-28T16:27:43.770086Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 4s
2024-08-28T16:27:43.770103Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 0ns
2024-08-28T16:27:43.770108Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 138s
2024-08-28T16:27:43.770107Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 63s
2024-08-28T16:27:43.770116Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.770133Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 66s
2024-08-28T16:27:43.770138Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 17s
2024-08-28T16:27:43.770156Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.770168Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.770198Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 155s
2024-08-28T16:27:43.770217Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.770236Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.770252Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.770253Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 48s
2024-08-28T16:27:43.770301Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.770318Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.770335Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 154s
2024-08-28T16:27:43.770412Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.770411Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 94s
2024-08-28T16:27:43.770434Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.770480Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 32s
2024-08-28T16:27:43.770499Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 59s
2024-08-28T16:27:43.770546Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 9s
2024-08-28T16:27:43.770565Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 28s
2024-08-28T16:27:43.770572Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.770625Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.770666Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.770762Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.770915Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.771948Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.771717201Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.772714Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-18ca540e-ffc8-475c-bebb-43833b0fa8cb starts
2024-08-28T16:27:43.772928Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.773508Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.773619Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-18ca540e-ffc8-475c-bebb-43833b0fa8cb once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.774320Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.774291Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.774676Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.774976Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.775119Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.775109Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.775385Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.775790Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.775926Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.775786Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.775994Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.776048Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.775988Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.776179Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.776216Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.776040Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.776287Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.776278Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.776425Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.776649Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.776727Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.776766Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.776787Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.776848Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.776860Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.776906Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.776910Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.776927Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.776927Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.776938Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.777006Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.777025Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.777045Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.777191Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.777234Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.777238Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.777251Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.777272Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.777299Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.777283Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 46s
2024-08-28T16:27:43.777301Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.777337Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.777340Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.777339Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 95s
2024-08-28T16:27:43.777341Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 79s
2024-08-28T16:27:43.777360Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.777377Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.777371Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.777384Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 31s
2024-08-28T16:27:43.777435Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.777455Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 14s
2024-08-28T16:27:43.777357Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.777513Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 156s
2024-08-28T16:27:43.777545Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.777562Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 152s
2024-08-28T16:27:43.777608Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 144s
2024-08-28T16:27:43.777650Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 174s
2024-08-28T16:27:43.777826Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 150s
2024-08-28T16:27:43.777919Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 134s
2024-08-28T16:27:43.777941Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 161s
2024-08-28T16:27:43.778072Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 119s
2024-08-28T16:27:43.778110Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.778138Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 13s
2024-08-28T16:27:43.778161Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 76s
2024-08-28T16:27:43.778209Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 14s
2024-08-28T16:27:43.778092Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.778260Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 54s
2024-08-28T16:27:43.778275Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.778315Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 45s
2024-08-28T16:27:43.778355Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 103s
2024-08-28T16:27:43.778325Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.778434Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.778447Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.778475Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.778487Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.778479Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 136s
2024-08-28T16:27:43.778548Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.778570Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 25s
2024-08-28T16:27:43.778616Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.778666Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 50s
2024-08-28T16:27:43.778697Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 1s
2024-08-28T16:27:43.778757Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 36s
2024-08-28T16:27:43.778840Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 62s
2024-08-28T16:27:43.778895Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 26s
2024-08-28T16:27:43.778939Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.779012Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.779054Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.779098Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.779160Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.779072Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.778977555Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.779101Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.779009962Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.779191Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.779254Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.779198Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.779111668Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.779298Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.779315Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.779339Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.779265Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.779165581Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.779325Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.779406Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.779458Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-d9f1812e-d041-47c6-a328-e584c406c215 starts
2024-08-28T16:27:43.779399Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.779289771Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.779447Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:43.779620Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-540555d6-0e2e-4364-b066-1002bafe1323 starts
2024-08-28T16:27:43.779805Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-7188752d-06d4-4ad4-ab30-42b2fcdb1fb8 starts
2024-08-28T16:27:43.779897Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.779946Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:43.779959Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.779967Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-d9f1812e-d041-47c6-a328-e584c406c215 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.779988Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.779919792Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.780054Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-cc000385-ab18-4b17-a70d-7259f258bbbe starts
2024-08-28T16:27:43.780070Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.780141Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-540555d6-0e2e-4364-b066-1002bafe1323 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.780076Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-ed78f7a6-e3f3-4895-b7b1-86b744893487 starts
2024-08-28T16:27:43.780292Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.780416Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-3fc883b1-0e3a-48e3-8eda-473a8aaf9043 starts
2024-08-28T16:27:43.780565Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.780667Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-cc000385-ab18-4b17-a70d-7259f258bbbe once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.780645Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.780762Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.780832Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-3fc883b1-0e3a-48e3-8eda-473a8aaf9043 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.780809Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-7188752d-06d4-4ad4-ab30-42b2fcdb1fb8 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.780809Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.780857Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 99s
2024-08-28T16:27:43.780895Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 169s
2024-08-28T16:27:43.780951Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-ed78f7a6-e3f3-4895-b7b1-86b744893487 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.781012Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 76s
2024-08-28T16:27:43.781106Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 111s
2024-08-28T16:27:43.781160Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 116s
2024-08-28T16:27:43.781197Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 77s
2024-08-28T16:27:43.781228Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 26s
2024-08-28T16:27:43.781288Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 151s
2024-08-28T16:27:43.781289Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 46s
2024-08-28T16:27:43.781343Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 75s
2024-08-28T16:27:43.781423Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 70s
2024-08-28T16:27:43.781448Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.781487Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 68s
test integration_http_azblob_test::test_prometheus_promql_api ... ok
2024-08-28T16:27:43.781524Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.781530Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 139s
2024-08-28T16:27:43.781454Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.781344601Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.781598Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 158s
2024-08-28T16:27:43.781592Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.781610Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 12s
2024-08-28T16:27:43.781669Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 82s
2024-08-28T16:27:43.781672Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 23s
2024-08-28T16:27:43.781723Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 56s
2024-08-28T16:27:43.781722Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.781775Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.781817Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 110s
2024-08-28T16:27:43.781886Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 31s
2024-08-28T16:27:43.781860Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-d9d9ae27-c088-4044-9c43-381c3b2407b1 starts
2024-08-28T16:27:43.781947Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 82s
2024-08-28T16:27:43.782002Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 52s
2024-08-28T16:27:43.782055Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 134s
2024-08-28T16:27:43.782110Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 176s
2024-08-28T16:27:43.782103Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.782155Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.782163Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 100s
2024-08-28T16:27:43.782194Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.782212Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 82s
2024-08-28T16:27:43.782205Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.782273Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-d9d9ae27-c088-4044-9c43-381c3b2407b1 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.782299Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.782503Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.783132Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.783128Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.783293Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:43.783315Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
test integration_http_azblob_test::test_prometheus_remote_write ... ok
2024-08-28T16:27:43.784117Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 140s
2024-08-28T16:27:43.784204Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 41s
2024-08-28T16:27:43.784267Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 14s
2024-08-28T16:27:43.784322Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 70s
test integration_grpc_s3withcache_test::test_grpc_zstd_compression ... 2024-08-28T16:27:43.784372Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 118s
ok
2024-08-28T16:27:43.784435Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 50s
2024-08-28T16:27:43.784494Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 53s
2024-08-28T16:27:43.784554Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 28s
2024-08-28T16:27:43.784600Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 96s
2024-08-28T16:27:43.784620Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 126s
2024-08-28T16:27:43.784613Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.784658Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.784679Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.784785Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.784823Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 78s
2024-08-28T16:27:43.784920Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 115s
2024-08-28T16:27:43.784989Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 61s
2024-08-28T16:27:43.785056Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 65s
2024-08-28T16:27:43.785128Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 28s
2024-08-28T16:27:43.785192Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 11s
2024-08-28T16:27:43.785253Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 172s
2024-08-28T16:27:43.785342Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 46s
2024-08-28T16:27:43.785407Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 164s
2024-08-28T16:27:43.785479Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 108s
2024-08-28T16:27:43.785545Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 37s
2024-08-28T16:27:43.785614Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 81s
2024-08-28T16:27:43.785681Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 24s
2024-08-28T16:27:43.785741Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 104s
2024-08-28T16:27:43.785780Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:43.785805Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 53s
2024-08-28T16:27:43.785855Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:43.785870Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 174s
2024-08-28T16:27:43.785906Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:43.786041Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:43.786240Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:43.786926Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.786826088Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.787393Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-26b52d81-6738-4fde-8573-0049360d48e7 starts
test integration_grpc_s3withcache_test::test_health_check ... ok
2024-08-28T16:27:43.787784Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
test integration_http_azblob_test::test_http_auth ... ok
2024-08-28T16:27:43.787877Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-26b52d81-6738-4fde-8573-0049360d48e7 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.787995Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.788216Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.787984Z  INFO flow::server: Flow Worker started in new thread
test integration_http_azblob_test::test_config_api ... ok
2024-08-28T16:27:43.789791Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.789846Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.789863Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.790014Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
test integration_http_azblob_test::test_vm_proto_remote_write ... ok
test integration_http_azblob_test::test_metrics_api ... ok
test integration_http_gcs_test::test_config_api ... ok
test integration_http_azblob_test::test_prom_http_api ... ok
test integration_http_azblob_test::test_pipeline_api ... ok
2024-08-28T16:27:43.790998Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.791067Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.791079Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.791139Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.791144Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.791193Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.791216Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.791235Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.791221Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
test integration_http_azblob_test::test_plain_text_ingestion ... 2024-08-28T16:27:43.791293Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
ok2024-08-28T16:27:43.791297Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }

2024-08-28T16:27:43.791383Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:43.791414Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.791537Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.792441Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.792584Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.792614Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.792634Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.792652Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.792665Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.792690Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.792694Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.792695Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.792709Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.792717Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.792751Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.792791Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
test integration_grpc_s3withcache_test::test_grpc_message_size_ok ... ok
2024-08-28T16:27:43.792856Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.792848Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.792931Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.792935Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.792952Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.792932Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.792951Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:43.792981Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.792982Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.792981Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.792990Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.792993Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:43.793036Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.793037Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.793050Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.793057Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.793096Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:43.793127Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:43.793117Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.793141Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.793132Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:43.793189Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.793177Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:43.793229Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.793247Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.792415Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.793314Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.793360Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.794956Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.795013Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.795049Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.795290Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.796266Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.796133574Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.796889Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.796903Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.796910Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.796919Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.796918Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.796955Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.796955Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.796957Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.796960Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.796969Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.796970Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.796975Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.797041Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.797044Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.797103Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.797109Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.797107Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.797144Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.797162Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.797185Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.797209Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.797210Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.797278Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.797354Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.797369Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.797391Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.797389Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.797430Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.797411Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.797482Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.797489Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.797536Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.797674Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-26b52d81-6738-4fde-8573-0049360d48e7 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.797674Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-3fc883b1-0e3a-48e3-8eda-473a8aaf9043 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.797675Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-540555d6-0e2e-4364-b066-1002bafe1323 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.797700Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-7188752d-06d4-4ad4-ab30-42b2fcdb1fb8 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.797694Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-18ca540e-ffc8-475c-bebb-43833b0fa8cb once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.797706Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-d9f1812e-d041-47c6-a328-e584c406c215 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.797720Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-ed78f7a6-e3f3-4895-b7b1-86b744893487 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.797724Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-cc000385-ab18-4b17-a70d-7259f258bbbe once, status: Executing { persist: true }, need_persist: true
test integration_grpc_s3withcache_test::test_invalid_dbname ... ok
2024-08-28T16:27:43.799009Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.799019Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.799036Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.799093Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-7188752d-06d4-4ad4-ab30-42b2fcdb1fb8 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.799098Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-26b52d81-6738-4fde-8573-0049360d48e7 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.799101Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.799110Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.799140Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-cc000385-ab18-4b17-a70d-7259f258bbbe once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.798945Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.798788461Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.799206Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-540555d6-0e2e-4364-b066-1002bafe1323 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.799210Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-18ca540e-ffc8-475c-bebb-43833b0fa8cb once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.799194Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.799194Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.799232Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-7188752d-06d4-4ad4-ab30-42b2fcdb1fb8 done
2024-08-28T16:27:43.799234Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-26b52d81-6738-4fde-8573-0049360d48e7 done
2024-08-28T16:27:43.799295Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-cc000385-ab18-4b17-a70d-7259f258bbbe done
2024-08-28T16:27:43.799299Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-ed78f7a6-e3f3-4895-b7b1-86b744893487 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.799299Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-3fc883b1-0e3a-48e3-8eda-473a8aaf9043 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.799348Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-18ca540e-ffc8-475c-bebb-43833b0fa8cb done
2024-08-28T16:27:43.799377Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-540555d6-0e2e-4364-b066-1002bafe1323 done
2024-08-28T16:27:43.799380Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.799415Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(7188752d-06d4-4ad4-ab30-42b2fcdb1fb8)
2024-08-28T16:27:43.799445Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(26b52d81-6738-4fde-8573-0049360d48e7)
2024-08-28T16:27:43.799476Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-ed78f7a6-e3f3-4895-b7b1-86b744893487 done
2024-08-28T16:27:43.799478Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-3fc883b1-0e3a-48e3-8eda-473a8aaf9043 done
2024-08-28T16:27:43.799485Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-d9f1812e-d041-47c6-a328-e584c406c215 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.799493Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(cc000385-ab18-4b17-a70d-7259f258bbbe)
2024-08-28T16:27:43.799531Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.799540Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 26b52d81-6738-4fde-8573-0049360d48e7, step_keys: ["procedure/26b52d81-6738-4fde-8573-0049360d48e7/0000000000.step", "procedure/26b52d81-6738-4fde-8573-0049360d48e7/0000000001.step"], finish_keys: ["procedure/26b52d81-6738-4fde-8573-0049360d48e7/0000000002.commit"]
2024-08-28T16:27:43.799541Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 7188752d-06d4-4ad4-ab30-42b2fcdb1fb8, step_keys: ["procedure/7188752d-06d4-4ad4-ab30-42b2fcdb1fb8/0000000000.step", "procedure/7188752d-06d4-4ad4-ab30-42b2fcdb1fb8/0000000001.step"], finish_keys: ["procedure/7188752d-06d4-4ad4-ab30-42b2fcdb1fb8/0000000002.commit"]
2024-08-28T16:27:43.799566Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 18ca540e-ffc8-475c-bebb-43833b0fa8cb, step_keys: ["procedure/18ca540e-ffc8-475c-bebb-43833b0fa8cb/0000000000.step", "procedure/18ca540e-ffc8-475c-bebb-43833b0fa8cb/0000000001.step"], finish_keys: ["procedure/18ca540e-ffc8-475c-bebb-43833b0fa8cb/0000000002.commit"]
test integration_grpc_s3withcache_test::test_grpc_timezone ... ok
2024-08-28T16:27:43.799588Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.799569Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(18ca540e-ffc8-475c-bebb-43833b0fa8cb)
2024-08-28T16:27:43.799609Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.799602Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(540555d6-0e2e-4364-b066-1002bafe1323)
2024-08-28T16:27:43.799686Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 540555d6-0e2e-4364-b066-1002bafe1323, step_keys: ["procedure/540555d6-0e2e-4364-b066-1002bafe1323/0000000000.step", "procedure/540555d6-0e2e-4364-b066-1002bafe1323/0000000001.step"], finish_keys: ["procedure/540555d6-0e2e-4364-b066-1002bafe1323/0000000002.commit"]
2024-08-28T16:27:43.799687Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure cc000385-ab18-4b17-a70d-7259f258bbbe, step_keys: ["procedure/cc000385-ab18-4b17-a70d-7259f258bbbe/0000000000.step", "procedure/cc000385-ab18-4b17-a70d-7259f258bbbe/0000000001.step"], finish_keys: ["procedure/cc000385-ab18-4b17-a70d-7259f258bbbe/0000000002.commit"]
2024-08-28T16:27:43.799716Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-d9f1812e-d041-47c6-a328-e584c406c215 done
2024-08-28T16:27:43.799714Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(3fc883b1-0e3a-48e3-8eda-473a8aaf9043)
2024-08-28T16:27:43.799749Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(ed78f7a6-e3f3-4895-b7b1-86b744893487)
2024-08-28T16:27:43.799789Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-18ca540e-ffc8-475c-bebb-43833b0fa8cb exits
2024-08-28T16:27:43.799794Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.799821Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-26b52d81-6738-4fde-8573-0049360d48e7 exits
2024-08-28T16:27:43.799804Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.799820Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 3fc883b1-0e3a-48e3-8eda-473a8aaf9043, step_keys: ["procedure/3fc883b1-0e3a-48e3-8eda-473a8aaf9043/0000000000.step", "procedure/3fc883b1-0e3a-48e3-8eda-473a8aaf9043/0000000001.step"], finish_keys: ["procedure/3fc883b1-0e3a-48e3-8eda-473a8aaf9043/0000000002.commit"]
2024-08-28T16:27:43.799839Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.799885Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure ed78f7a6-e3f3-4895-b7b1-86b744893487, step_keys: ["procedure/ed78f7a6-e3f3-4895-b7b1-86b744893487/0000000000.step", "procedure/ed78f7a6-e3f3-4895-b7b1-86b744893487/0000000001.step"], finish_keys: ["procedure/ed78f7a6-e3f3-4895-b7b1-86b744893487/0000000002.commit"]
2024-08-28T16:27:43.799969Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-5f1aa3fa-59a8-46c3-b2de-88998798d36f starts
2024-08-28T16:27:43.799942Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(d9f1812e-d041-47c6-a328-e584c406c215)
2024-08-28T16:27:43.799980Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.800057Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:43.800041Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-540555d6-0e2e-4364-b066-1002bafe1323 exits
2024-08-28T16:27:43.800032Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-7188752d-06d4-4ad4-ab30-42b2fcdb1fb8 exits
2024-08-28T16:27:43.800095Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure d9f1812e-d041-47c6-a328-e584c406c215, step_keys: ["procedure/d9f1812e-d041-47c6-a328-e584c406c215/0000000000.step", "procedure/d9f1812e-d041-47c6-a328-e584c406c215/0000000001.step"], finish_keys: ["procedure/d9f1812e-d041-47c6-a328-e584c406c215/0000000002.commit"]
2024-08-28T16:27:43.800121Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.800107Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-cc000385-ab18-4b17-a70d-7259f258bbbe exits
2024-08-28T16:27:43.800118Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.800176Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.800186Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-3fc883b1-0e3a-48e3-8eda-473a8aaf9043 exits
2024-08-28T16:27:43.800193Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-ed78f7a6-e3f3-4895-b7b1-86b744893487 exits
2024-08-28T16:27:43.800230Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.800254Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-b5fc6f36-3d84-4d39-bbe6-98fc0187e36b starts
2024-08-28T16:27:43.800258Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.800287Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:43.800292Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-5f1aa3fa-59a8-46c3-b2de-88998798d36f once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.800452Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.800473Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-d9f1812e-d041-47c6-a328-e584c406c215 exits
2024-08-28T16:27:43.800033Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:43.800593Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.800639Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-d9d9ae27-c088-4044-9c43-381c3b2407b1 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.800690Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-b5fc6f36-3d84-4d39-bbe6-98fc0187e36b once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.801463Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
test integration_http_file_test::test_dashboard_path ... ok
2024-08-28T16:27:43.801540Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-d9d9ae27-c088-4044-9c43-381c3b2407b1 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.801660Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-d9d9ae27-c088-4044-9c43-381c3b2407b1 done
2024-08-28T16:27:43.801869Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(d9d9ae27-c088-4044-9c43-381c3b2407b1)
2024-08-28T16:27:43.801888Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure d9d9ae27-c088-4044-9c43-381c3b2407b1, step_keys: ["procedure/d9d9ae27-c088-4044-9c43-381c3b2407b1/0000000000.step", "procedure/d9d9ae27-c088-4044-9c43-381c3b2407b1/0000000001.step"], finish_keys: ["procedure/d9d9ae27-c088-4044-9c43-381c3b2407b1/0000000002.commit"]
2024-08-28T16:27:43.801903Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.801977Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.802003Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.802100Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-d9d9ae27-c088-4044-9c43-381c3b2407b1 exits
test integration_grpc_s3withcache_test::test_insert_and_select ... ok
2024-08-28T16:27:43.802683Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:43.802693Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.802740Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:43.802748Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.802762Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:43.802758Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.802796Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.802840Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.802864Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:43.802855Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:43.802995Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.803181Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.803255Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.803337Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
test integration_http_azblob_test::test_status_api ... ok2024-08-28T16:27:43.803434Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }

2024-08-28T16:27:43.803664Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:43.804976Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.805043Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.805139Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.805208Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.805252Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.805316Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
test integration_http_azblob_test::test_health_api ... ok
2024-08-28T16:27:43.805389Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.805499Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.805657Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-5f1aa3fa-59a8-46c3-b2de-88998798d36f once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.805686Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-b5fc6f36-3d84-4d39-bbe6-98fc0187e36b once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.805748Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:43.805587072Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:43.806801Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.806850Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-50225464-cdda-4b5f-a198-46224c9949b8 starts
2024-08-28T16:27:43.806876Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-b5fc6f36-3d84-4d39-bbe6-98fc0187e36b once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.806990Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-b5fc6f36-3d84-4d39-bbe6-98fc0187e36b done
2024-08-28T16:27:43.807118Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.807163Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:43.807213Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-5f1aa3fa-59a8-46c3-b2de-88998798d36f once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.807196Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(b5fc6f36-3d84-4d39-bbe6-98fc0187e36b)
2024-08-28T16:27:43.807237Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-50225464-cdda-4b5f-a198-46224c9949b8 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:43.807268Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure b5fc6f36-3d84-4d39-bbe6-98fc0187e36b, step_keys: ["procedure/b5fc6f36-3d84-4d39-bbe6-98fc0187e36b/0000000000.step", "procedure/b5fc6f36-3d84-4d39-bbe6-98fc0187e36b/0000000001.step"], finish_keys: ["procedure/b5fc6f36-3d84-4d39-bbe6-98fc0187e36b/0000000002.commit"]
2024-08-28T16:27:43.807343Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.807468Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-b5fc6f36-3d84-4d39-bbe6-98fc0187e36b exits
2024-08-28T16:27:43.807524Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-5f1aa3fa-59a8-46c3-b2de-88998798d36f done
test integration_http_gcs_test::test_dashboard_path ... ok
2024-08-28T16:27:43.807748Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(5f1aa3fa-59a8-46c3-b2de-88998798d36f)
2024-08-28T16:27:43.807865Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.807855Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 5f1aa3fa-59a8-46c3-b2de-88998798d36f, step_keys: ["procedure/5f1aa3fa-59a8-46c3-b2de-88998798d36f/0000000000.step", "procedure/5f1aa3fa-59a8-46c3-b2de-88998798d36f/0000000001.step"], finish_keys: ["procedure/5f1aa3fa-59a8-46c3-b2de-88998798d36f/0000000002.commit"]
2024-08-28T16:27:43.808262Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-5f1aa3fa-59a8-46c3-b2de-88998798d36f exits
test integration_http_gcs_test::test_health_api ... ok
2024-08-28T16:27:43.809869Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:43.809968Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:43.810390Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:43.810464Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:43.810587Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.810719Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:43.810955Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
test integration_http_azblob_test::test_dashboard_path ... ok
2024-08-28T16:27:43.813103Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:43.813162Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:43.813240Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:43.813484Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:43.813710Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-50225464-cdda-4b5f-a198-46224c9949b8 once, status: Executing { persist: true }, need_persist: true
test integration_http_azblob_test::test_sql_api ... ok
2024-08-28T16:27:43.814728Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:43.814820Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-50225464-cdda-4b5f-a198-46224c9949b8 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:43.814965Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-50225464-cdda-4b5f-a198-46224c9949b8 done
2024-08-28T16:27:43.815203Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(50225464-cdda-4b5f-a198-46224c9949b8)
2024-08-28T16:27:43.815253Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 50225464-cdda-4b5f-a198-46224c9949b8, step_keys: ["procedure/50225464-cdda-4b5f-a198-46224c9949b8/0000000000.step", "procedure/50225464-cdda-4b5f-a198-46224c9949b8/0000000001.step"], finish_keys: ["procedure/50225464-cdda-4b5f-a198-46224c9949b8/0000000002.commit"]
2024-08-28T16:27:43.815378Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:43.815538Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-50225464-cdda-4b5f-a198-46224c9949b8 exits
test integration_http_gcs_test::test_pipeline_api ... ok
test integration_http_gcs_test::test_http_auth ... ok
test integration_http_gcs_test::test_metrics_api ... ok
test integration_http_gcs_test::test_plain_text_ingestion ... ok
test integration_http_gcs_test::test_sql_api ... ok
test integration_http_gcs_test::test_prometheus_remote_write ... ok
test integration_http_oss_test::test_dashboard_path ... ok
test integration_http_gcs_test::test_prometheus_promql_api ... ok
test integration_http_gcs_test::test_vm_proto_remote_write ... ok
test integration_http_gcs_test::test_prom_http_api ... ok
test integration_http_oss_test::test_health_api ... ok
test integration_http_gcs_test::test_scripts_api ... ok
test integration_http_oss_test::test_config_api ... ok
test integration_http_oss_test::test_scripts_api ... ok
test integration_http_oss_test::test_metrics_api ... ok
test integration_http_oss_test::test_prometheus_remote_write ... ok
test integration_http_oss_test::test_prometheus_promql_api ... ok
test integration_http_gcs_test::test_status_api ... ok
test integration_http_oss_test::test_plain_text_ingestion ... ok
test integration_http_oss_test::test_http_auth ... ok
test integration_http_oss_test::test_sql_api ... ok
test integration_http_oss_test::test_prom_http_api ... ok
test integration_http_s3_test::test_dashboard_path ... ok
test integration_http_oss_test::test_pipeline_api ... ok
test integration_http_oss_test::test_status_api ... ok
test integration_http_s3_test::test_config_api ... ok
test integration_http_s3_test::test_health_api ... ok
test integration_http_oss_test::test_vm_proto_remote_write ... ok
test integration_http_s3_test::test_metrics_api ... ok
test integration_http_s3_test::test_http_auth ... ok
test integration_http_s3_test::test_plain_text_ingestion ... ok
test integration_http_s3_test::test_pipeline_api ... ok
test integration_http_s3_test::test_prom_http_api ... ok
test integration_http_s3_test::test_prometheus_promql_api ... ok
test integration_http_s3withcache_test::test_config_api ... ok
test integration_http_s3_test::test_status_api ... ok
test integration_http_s3_test::test_prometheus_remote_write ... ok
test integration_http_s3_test::test_vm_proto_remote_write ... ok
2024-08-28T16:27:44.197976Z  INFO common_grpc::channel_manager: ChannelManager: 0, channel recycle is started, running in the background!
2024-08-28T16:27:44.201196Z  INFO common_grpc::channel_manager: ChannelManager: 2, channel recycle is started, running in the background!
2024-08-28T16:27:44.202290Z  INFO common_grpc::channel_manager: ChannelManager: 4, channel recycle is started, running in the background!
2024-08-28T16:27:44.205731Z DEBUG servers::grpc::database: GreptimeDatabase::Handle: request from Some(127.0.0.1:34666) with hints: []
2024-08-28T16:27:44.205734Z DEBUG servers::grpc::database: GreptimeDatabase::Handle: request from Some(127.0.0.1:33772) with hints: [("append_mode", "true")]
test integration_http_s3withcache_test::test_health_api ... ok
2024-08-28T16:27:44.207874Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts: operator::insert: Table `greptime.public.demo` does not exist, try creating table
2024-08-28T16:27:44.207872Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts: operator::insert: Table `greptime.public.demo` does not exist, try creating table
2024-08-28T16:27:44.208760Z DEBUG GreptimeRequestHandler::handle_request_runtime:handle_inserts:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "Created on insertion", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {"append_mode": "true"}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"append_mode": "true"} }, created_on: 2024-08-28T16:27:44.208644307Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:44.208870Z DEBUG GreptimeRequestHandler::handle_request_runtime:handle_inserts:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "Created on insertion", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:44.208770641Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:44.209396Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-40d1ba85-5d48-4505-9b28-24881575505c starts
2024-08-28T16:27:44.209476Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-eea14e58-b022-4e79-ab7f-6913c28fdc21 starts
2024-08-28T16:27:44.209928Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:44.209972Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:44.210008Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-eea14e58-b022-4e79-ab7f-6913c28fdc21 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.210065Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-40d1ba85-5d48-4505-9b28-24881575505c once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.211912Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.211992Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:44.212173Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.212253Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:44.212356Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:44.212462Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:44.212557Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:44.212631Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:44.212652Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:44.212707Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:44.212799Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:44.212840Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:44.212889Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:44.213095Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
test integration_http_s3withcache_test::test_http_auth ... ok
test integration_http_s3withcache_test::test_plain_text_ingestion ... ok
2024-08-28T16:27:44.214772Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:44.214835Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:44.214834Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:44.214883Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: true, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:44.214923Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:44.214957Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:44.215187Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:44.215187Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:44.215432Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-eea14e58-b022-4e79-ab7f-6913c28fdc21 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.215556Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-40d1ba85-5d48-4505-9b28-24881575505c once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.216776Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:44.216777Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:44.216893Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-40d1ba85-5d48-4505-9b28-24881575505c once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:44.216893Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-eea14e58-b022-4e79-ab7f-6913c28fdc21 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:44.217050Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-40d1ba85-5d48-4505-9b28-24881575505c done
2024-08-28T16:27:44.217054Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-eea14e58-b022-4e79-ab7f-6913c28fdc21 done
2024-08-28T16:27:44.217356Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(eea14e58-b022-4e79-ab7f-6913c28fdc21)
2024-08-28T16:27:44.217358Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(40d1ba85-5d48-4505-9b28-24881575505c)
2024-08-28T16:27:44.217400Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 40d1ba85-5d48-4505-9b28-24881575505c, step_keys: ["procedure/40d1ba85-5d48-4505-9b28-24881575505c/0000000000.step", "procedure/40d1ba85-5d48-4505-9b28-24881575505c/0000000001.step"], finish_keys: ["procedure/40d1ba85-5d48-4505-9b28-24881575505c/0000000002.commit"]
2024-08-28T16:27:44.217419Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure eea14e58-b022-4e79-ab7f-6913c28fdc21, step_keys: ["procedure/eea14e58-b022-4e79-ab7f-6913c28fdc21/0000000000.step", "procedure/eea14e58-b022-4e79-ab7f-6913c28fdc21/0000000001.step"], finish_keys: ["procedure/eea14e58-b022-4e79-ab7f-6913c28fdc21/0000000002.commit"]
2024-08-28T16:27:44.217517Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:44.217526Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:44.217620Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-40d1ba85-5d48-4505-9b28-24881575505c exits
2024-08-28T16:27:44.217630Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-eea14e58-b022-4e79-ab7f-6913c28fdc21 exits
2024-08-28T16:27:44.217737Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts: operator::insert: Successfully created table greptime.public.demo with options: []
2024-08-28T16:27:44.217961Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts: operator::insert: Successfully created table greptime.public.demo with options: [("append_mode", "true")]
test integration_http_s3_test::test_scripts_api ... ok
test integration_http_s3withcache_test::test_prometheus_remote_write ... ok
2024-08-28T16:27:44.225244Z  WARN tests_integration::test_util: The endpoints is empty, skipping the test
test integration_http_s3withcache_test::test_dashboard_path ... ok
test integration_http_s3withcache_test::test_prom_http_api ... ok
test integration_http_s3withcache_test::test_prometheus_promql_api ... ok
test integration_http_s3withcache_test::test_metrics_api ... ok
test integration_http_s3_test::test_sql_api ... ok
test integration_http_s3withcache_test::test_scripts_api ... ok
test integration_http_s3withcache_test::test_sql_api ... ok
test integration_http_s3withcache_test::test_pipeline_api ... ok
test integration_http_s3withcache_test::test_status_api ... ok
test integration_region_migration_file_test::test_metric_table_region_migration_by_sql ... ok
2024-08-28T16:27:44.238084Z  WARN tests_integration::test_util: The endpoints is empty, skipping the test
2024-08-28T16:27:44.244103Z  INFO common_grpc::channel_manager: ChannelManager: 6, channel recycle is started, running in the background!
2024-08-28T16:27:44.247883Z  INFO common_grpc::channel_manager: ChannelManager: 8, channel recycle is started, running in the background!
2024-08-28T16:27:44.249052Z  INFO common_grpc::channel_manager: ChannelManager: 10, channel recycle is started, running in the background!
test integration_http_s3withcache_test::test_vm_proto_remote_write ... ok
test integration_region_migration_file_test::test_region_migration ... ok
2024-08-28T16:27:44.253211Z DEBUG servers::grpc::database: GreptimeDatabase::Handle: request from Some(127.0.0.1:57952) with hints: []
2024-08-28T16:27:44.254696Z ERROR client::database: Failed to do Flight get, addr: 127.0.0.1:46453, code: Operation was attempted past the valid range, source: 0: Failed to do Flight get, code: Operation was attempted past the valid range
1: Error, message length too large: found 46 bytes, the limit is: 10 bytes, at /root/work/repo/greptimedb/src/client/src/database.rs:236:67
2024-08-28T16:27:44.254923Z  INFO servers::grpc: Shutdown grpc server
2024-08-28T16:27:44.255554Z  INFO servers::grpc: Shutdown grpc server
2024-08-28T16:27:44.264082Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts: operator::insert: Table `greptime.public.demo` does not exist, try creating table
2024-08-28T16:27:44.265223Z DEBUG GreptimeRequestHandler::handle_request_runtime:handle_inserts:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "Created on insertion", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:44.265062460Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:44.266375Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-f1360f4c-eb7d-43bc-81bf-2d6a26c25096 starts
2024-08-28T16:27:44.266830Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:44.266829Z  INFO common_grpc::channel_manager: ChannelManager: 12, channel recycle is started, running in the background!
2024-08-28T16:27:44.266908Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-f1360f4c-eb7d-43bc-81bf-2d6a26c25096 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.268708Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.268771Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:44.269065Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:44.269110Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:44.269162Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:44.269221Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:44.269383Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:44.269909Z  WARN tests_integration::test_util: The endpoints is empty, skipping the test
2024-08-28T16:27:44.271402Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:44.271468Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:44.271572Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:44.271853Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:44.272145Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-f1360f4c-eb7d-43bc-81bf-2d6a26c25096 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.273389Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:44.273485Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-f1360f4c-eb7d-43bc-81bf-2d6a26c25096 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:44.273614Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-f1360f4c-eb7d-43bc-81bf-2d6a26c25096 done
2024-08-28T16:27:44.273872Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(f1360f4c-eb7d-43bc-81bf-2d6a26c25096)
2024-08-28T16:27:44.273946Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure f1360f4c-eb7d-43bc-81bf-2d6a26c25096, step_keys: ["procedure/f1360f4c-eb7d-43bc-81bf-2d6a26c25096/0000000000.step", "procedure/f1360f4c-eb7d-43bc-81bf-2d6a26c25096/0000000001.step"], finish_keys: ["procedure/f1360f4c-eb7d-43bc-81bf-2d6a26c25096/0000000002.commit"]
2024-08-28T16:27:44.274034Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:44.274310Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-f1360f4c-eb7d-43bc-81bf-2d6a26c25096 exits
2024-08-28T16:27:44.274342Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts: operator::insert: Successfully created table greptime.public.demo with options: []
2024-08-28T16:27:44.276367Z  INFO servers::grpc: Shutdown grpc server
test integration_grpc_file_test::test_auto_create_table_with_hints ... ok
test integration_grpc_file_test::test_grpc_message_size_limit_recv ... ok
2024-08-28T16:27:44.287461Z  INFO common_grpc::channel_manager: ChannelManager: 14, channel recycle is started, running in the background!
2024-08-28T16:27:44.291314Z  WARN tests_integration::test_util: The endpoints is empty, skipping the test
2024-08-28T16:27:44.292271Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:44.293615Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.294221Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.294921Z  WARN tests_integration::test_util: The endpoints is empty, skipping the test
2024-08-28T16:27:44.295739Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:44.296304Z  WARN tests_integration::test_util: The endpoints is empty, skipping the test
2024-08-28T16:27:44.296729Z  INFO common_grpc::channel_manager: ChannelManager: 16, channel recycle is started, running in the background!
2024-08-28T16:27:44.299946Z  WARN tests_integration::test_util: The endpoints is empty, skipping the test
2024-08-28T16:27:44.300605Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 1.925879ms
2024-08-28T16:27:44.301141Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 6, num_pruned_series: 0, num_rows: 6, num_batches: 6, scan_cost: 991.52µs }
2024-08-28T16:27:44.304275Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 4.813991ms, build_parts_cost: 337.925µs, build_reader_cost: 1.925879ms, scan_cost: 695.196µs, convert_cost: 2.424983ms, yield_cost: 211.089µs, total_cost: 11.88145ms, num_batches: 6, num_rows: 6, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 4.840059ms
2024-08-28T16:27:44.304387Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:44.304497Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 703.894µs, num_fetch_by_batches: 6, num_fetch_by_rows: 0, num_input_rows: 6, num_output_rows: 6, fetch_cost: 471.206µs }
2024-08-28T16:27:44.305967Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 9.148676ms, first_consume: 19.529932ms, do_get_cost: 10.401491ms
2024-08-28T16:27:44.307385Z  INFO main::integration_sql_file_test: test test_mysql_async_timestamp starts, store_type: File
2024-08-28T16:27:44.308912Z  INFO main::integration_sql_file_test: test test_mysql_auth starts, store_type: File
2024-08-28T16:27:44.310398Z ERROR client::database: Failed to do Flight get, addr: 127.0.0.1:36241, code: The request does not have valid authentication credentials, source: 0: Failed to do Flight get, code: The request does not have valid authentication credentials
1: Not found http or grpc authorization header, at /root/work/repo/greptimedb/src/client/src/database.rs:236:67
2024-08-28T16:27:44.310885Z  INFO main::integration_sql_file_test: test test_mysql_prepare_stmt_insert_timestamp starts, store_type: File
2024-08-28T16:27:44.311119Z  INFO servers::grpc: Shutdown grpc server
2024-08-28T16:27:44.311319Z  INFO common_grpc::channel_manager: ChannelManager: 18, channel recycle is started, running in the background!
2024-08-28T16:27:44.311739Z  INFO common_grpc::channel_manager: ChannelManager: 20, channel recycle is started, running in the background!
2024-08-28T16:27:44.313202Z  INFO log: Recovering raft logs takes 1.674242ms    
2024-08-28T16:27:44.313349Z  INFO log: Recovering raft logs takes 1.407943ms    
2024-08-28T16:27:44.313698Z  INFO main::integration_sql_file_test: test test_postgres_bytea starts, store_type: File
2024-08-28T16:27:44.313796Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.314058Z  INFO main::integration_sql_file_test: test test_mysql_crud starts, store_type: File
2024-08-28T16:27:44.315599Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.316498Z  INFO log: Recovering raft logs takes 520.422µs    
2024-08-28T16:27:44.319902Z  INFO log: Recovering raft logs takes 2.786431ms    
2024-08-28T16:27:44.320114Z  INFO log: Recovering raft logs takes 2.38614ms    
2024-08-28T16:27:44.320667Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.323912Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.323920Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.324527Z DEBUG servers::grpc::database: GreptimeDatabase::Handle: request from Some(127.0.0.1:54462) with hints: []
2024-08-28T16:27:44.325765Z  INFO servers::grpc: Shutdown grpc server
2024-08-28T16:27:44.326741Z ERROR client::database: Failed to do Flight get, addr: 127.0.0.1:36241, code: The request does not have valid authentication credentials, source: 0: Failed to do Flight get, code: The request does not have valid authentication credentials
1: Username and password does not match, username: greptime_user, at /root/work/repo/greptimedb/src/client/src/database.rs:236:67
2024-08-28T16:27:44.327759Z  INFO servers::grpc: Shutdown grpc server
2024-08-28T16:27:44.329431Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_timestamp46WiaU/
2024-08-28T16:27:44.331181Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_crudQo8s1B/
2024-08-28T16:27:44.331573Z  INFO main::integration_sql_file_test: test test_postgres_datestyle starts, store_type: File
2024-08-28T16:27:44.332970Z  INFO GreptimeRequestHandler::handle_request_runtime:handle_inserts: operator::insert: Table `greptime.tom.demo` does not exist, try creating table
2024-08-28T16:27:44.333201Z ERROR GreptimeRequestHandler::handle_request_runtime:handle_inserts: operator::insert: Failed to create table greptime.tom.demo err=0: Failed to find schema, schema info: tom, at /root/work/repo/greptimedb/src/operator/src/statement/ddl.rs:200:14
2024-08-28T16:27:44.334324Z DEBUG servers::grpc::greptime_handler: Failed to handle request, err: 0: Execute gRPC query error, at /root/work/repo/greptimedb/src/servers/src/query_handler/grpc.rs:60:14
1: Table operation error, at src/frontend/src/instance/grpc.rs:240:14
2: Failed to find schema, schema info: tom, at /root/work/repo/greptimedb/src/operator/src/statement/ddl.rs:200:14
2024-08-28T16:27:44.336058Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_bytea_outputZok3xD/
2024-08-28T16:27:44.337049Z  INFO servers::grpc: Shutdown grpc server
2024-08-28T16:27:44.337261Z  INFO main::integration_sql_file_test: test test_postgres_parameter_inference starts, store_type: File
2024-08-28T16:27:44.337945Z  INFO main::integration_sql_file_test: test test_mysql_timezone starts, store_type: File
2024-08-28T16:27:44.337993Z  INFO log: Recovering raft logs takes 1.253575ms    
2024-08-28T16:27:44.339297Z  INFO main::integration_sql_file_test: test test_postgres_auth starts, store_type: File
2024-08-28T16:27:44.339531Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.341049Z  INFO main::integration_sql_file_test: test test_postgres_crud starts, store_type: File
2024-08-28T16:27:44.341166Z  INFO main::integration_sql_file_test: test test_postgres_timezone starts, store_type: File
2024-08-28T16:27:44.342257Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_test_mysql_prepare_stmt_insert_timestampisj9G9/
2024-08-28T16:27:44.342257Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_crudB0IzN5/
test integration_region_migration_file_test::test_region_migration_all_regions ... ok
2024-08-28T16:27:44.343695Z  INFO log: Recovering raft logs takes 925.55µs    
2024-08-28T16:27:44.344018Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.344263Z  INFO log: Recovering raft logs takes 759.613µs    
2024-08-28T16:27:44.344141Z  INFO log: Recovering raft logs takes 616.412µs    
2024-08-28T16:27:44.344891Z  INFO log: Recovering raft logs takes 1.151267ms    
2024-08-28T16:27:44.344894Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.344894Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.345969Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.346616Z  INFO log: Recovering raft logs takes 1.901161ms    
2024-08-28T16:27:44.347072Z  INFO common_procedure::store: The procedure state store path is: procedure/
2024-08-28T16:27:44.348469Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:44.349165Z  INFO servers::grpc: Shutdown grpc server
2024-08-28T16:27:44.349161Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.349295Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_timestamp46WiaU/wal/
2024-08-28T16:27:44.349749Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.350508Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_various datestylekLagpA/
2024-08-28T16:27:44.350830Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:44.351813Z  INFO log: Recovering raft logs takes 2.357505ms    
2024-08-28T16:27:44.352930Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 1.751467ms
2024-08-28T16:27:44.353138Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 6, num_pruned_series: 0, num_rows: 6, num_batches: 6, scan_cost: 1.10165ms }
2024-08-28T16:27:44.354908Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:44.355054Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_crudQo8s1B/wal/
2024-08-28T16:27:44.355461Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.766528ms, build_parts_cost: 123.697µs, build_reader_cost: 1.751467ms, scan_cost: 783.92µs, convert_cost: 1.305513ms, yield_cost: 291.463µs, total_cost: 7.059949ms, num_batches: 6, num_rows: 6, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.794208ms
2024-08-28T16:27:44.355591Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:44.355685Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 1.695983ms, num_fetch_by_batches: 6, num_fetch_by_rows: 0, num_input_rows: 6, num_output_rows: 6, fetch_cost: 1.617593ms }
2024-08-28T16:27:44.355715Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_bytea_outputZok3xD/wal/
2024-08-28T16:27:44.356658Z  INFO log: Recovering raft logs takes 829.861µs    
2024-08-28T16:27:44.356681Z  INFO log: Recovering raft logs takes 1.4862ms    
2024-08-28T16:27:44.356675Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 5.053875ms, first_consume: 15.267746ms, do_get_cost: 10.278223ms
2024-08-28T16:27:44.357421Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_crudB0IzN5/wal/
2024-08-28T16:27:44.358257Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:44.358372Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_test_mysql_prepare_stmt_insert_timestampisj9G9/wal/
2024-08-28T16:27:44.359861Z  INFO log: Recovering raft logs takes 1.685201ms    
2024-08-28T16:27:44.359950Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_inferenceTt4KlK/
2024-08-28T16:27:44.359993Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_various datestylekLagpA/wal/
2024-08-28T16:27:44.360061Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.360326Z  INFO log: Recovering raft logs takes 1.584889ms    
2024-08-28T16:27:44.360390Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_crudHiTJDj/
2024-08-28T16:27:44.360684Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_crudeHAj4I/
2024-08-28T16:27:44.360703Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_mysql_timezonehrechh/
2024-08-28T16:27:44.360999Z  INFO log: Recovering raft logs takes 894.05µs    
2024-08-28T16:27:44.361118Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.361338Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.361643Z  INFO datanode::store::fs: The file storage home is: /tmp/gt_data_sql_inferencet3qbsF/
2024-08-28T16:27:44.361854Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:44.362432Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 153s
2024-08-28T16:27:44.362554Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.362591Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 75s
2024-08-28T16:27:44.362687Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:44.362706Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 108s
test integration_region_migration_file_test::test_region_migration_multiple_regions ... ok
2024-08-28T16:27:44.362851Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 149s
2024-08-28T16:27:44.362958Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 16s
2024-08-28T16:27:44.362968Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.363013Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.363038Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.363054Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 161s
2024-08-28T16:27:44.363048Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:44.363053Z  INFO servers::grpc: Shutdown grpc server
2024-08-28T16:27:44.363125Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 100s
2024-08-28T16:27:44.363092Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_crudeHAj4I/wal/
2024-08-28T16:27:44.363129Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_mysql_timezonehrechh/wal/
2024-08-28T16:27:44.363171Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.363225Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 42s
2024-08-28T16:27:44.363308Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.363313Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.363369Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 26s
2024-08-28T16:27:44.363492Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 31s
2024-08-28T16:27:44.363520Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_crudHiTJDj/wal/
2024-08-28T16:27:44.363596Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 142s
2024-08-28T16:27:44.363697Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 174s
2024-08-28T16:27:44.363767Z  INFO log: Recovering raft logs takes 550.566µs    
test integration_region_migration_file_test::test_region_migration_incorrect_region_id ... 2024-08-28T16:27:44.363802Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 92s
ok
2024-08-28T16:27:44.363839Z  INFO log: Recovering raft logs takes 624.817µs    
2024-08-28T16:27:44.363825Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_inferenceTt4KlK/wal/
2024-08-28T16:27:44.363893Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 171s
2024-08-28T16:27:44.363946Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:44.363976Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 166s
2024-08-28T16:27:44.364077Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 94s
2024-08-28T16:27:44.364170Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 10s
2024-08-28T16:27:44.364425Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 55s
2024-08-28T16:27:44.364443Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 28s
2024-08-28T16:27:44.364463Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 144s
2024-08-28T16:27:44.364501Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 104s
2024-08-28T16:27:44.364496Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 119s
2024-08-28T16:27:44.364518Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 62s
2024-08-28T16:27:44.364528Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 139s
2024-08-28T16:27:44.364558Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 94s
2024-08-28T16:27:44.364560Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 93s
2024-08-28T16:27:44.364574Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 141s
2024-08-28T16:27:44.364586Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 23s
2024-08-28T16:27:44.364603Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 93s
2024-08-28T16:27:44.364634Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 0ns
2024-08-28T16:27:44.364633Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 31s
2024-08-28T16:27:44.364655Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 162s
2024-08-28T16:27:44.364733Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 42s
2024-08-28T16:27:44.364743Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 59s
2024-08-28T16:27:44.364750Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 11s
2024-08-28T16:27:44.364775Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 167s
2024-08-28T16:27:44.364859Z  INFO log: Recovering raft logs takes 1.210391ms    
2024-08-28T16:27:44.365094Z  INFO datanode::datanode: Creating raft-engine logstore with config: RaftEngineConfig { dir: None, file_size: 256.0MiB, purge_threshold: 4.0GiB, purge_interval: 600s, read_batch_size: 128, sync_write: false, enable_log_recycle: true, prefill_log_files: false, sync_period: None } and storage path: /tmp/gt_data_sql_inferencet3qbsF/wal/
2024-08-28T16:27:44.365633Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 94s
2024-08-28T16:27:44.366119Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 148s
2024-08-28T16:27:44.366147Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 86s
2024-08-28T16:27:44.366223Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.366222Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.366402Z  INFO log: Recovering raft logs takes 2.490215ms    
2024-08-28T16:27:44.366741Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 160s
2024-08-28T16:27:44.366913Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 96s
2024-08-28T16:27:44.367189Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 18s
2024-08-28T16:27:44.367228Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 48s
2024-08-28T16:27:44.367281Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.367316Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 123s
2024-08-28T16:27:44.367333Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 87s
2024-08-28T16:27:44.367414Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 133s
2024-08-28T16:27:44.367475Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.367478Z  INFO log: Recovering raft logs takes 2.136732ms    
2024-08-28T16:27:44.367494Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 81s
2024-08-28T16:27:44.367595Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 57s
2024-08-28T16:27:44.367606Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 111s
2024-08-28T16:27:44.367624Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 35s
2024-08-28T16:27:44.367708Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 85s
2024-08-28T16:27:44.367738Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.367757Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 63s
2024-08-28T16:27:44.367778Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.367803Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 112s
2024-08-28T16:27:44.367851Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.367854Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 11s
2024-08-28T16:27:44.367895Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.367911Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 169s
2024-08-28T16:27:44.367931Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 99s
2024-08-28T16:27:44.367940Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 157s
2024-08-28T16:27:44.367981Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 21s
2024-08-28T16:27:44.367988Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 172s
2024-08-28T16:27:44.368013Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 45s
2024-08-28T16:27:44.368024Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 141s
2024-08-28T16:27:44.368032Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.368039Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 26s
2024-08-28T16:27:44.368073Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 46s
2024-08-28T16:27:44.368075Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 14s
2024-08-28T16:27:44.368078Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 158s
2024-08-28T16:27:44.368089Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 25s
2024-08-28T16:27:44.368098Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 15s
2024-08-28T16:27:44.368133Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 149s
2024-08-28T16:27:44.368159Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 87s
2024-08-28T16:27:44.368166Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 9s
2024-08-28T16:27:44.368188Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.368260Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 83s
2024-08-28T16:27:44.368285Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 123s
2024-08-28T16:27:44.368412Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 122s
2024-08-28T16:27:44.368429Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 164s
2024-08-28T16:27:44.368459Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 4s
2024-08-28T16:27:44.368487Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 42s
2024-08-28T16:27:44.368489Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 24s
2024-08-28T16:27:44.368496Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 120s
2024-08-28T16:27:44.368544Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 102s
2024-08-28T16:27:44.368555Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 152s
2024-08-28T16:27:44.368557Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 23s
2024-08-28T16:27:44.368557Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 11s
2024-08-28T16:27:44.368563Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 35s
2024-08-28T16:27:44.368593Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 53s
2024-08-28T16:27:44.368609Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 55s
2024-08-28T16:27:44.368630Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 57s
2024-08-28T16:27:44.368631Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 55s
2024-08-28T16:27:44.368660Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 169s
2024-08-28T16:27:44.368685Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 10s
2024-08-28T16:27:44.368693Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 130s
2024-08-28T16:27:44.368869Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 52s
2024-08-28T16:27:44.368899Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 32s
2024-08-28T16:27:44.368999Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 86s
2024-08-28T16:27:44.369007Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 82s
2024-08-28T16:27:44.369044Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 117s
2024-08-28T16:27:44.369086Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 174s
2024-08-28T16:27:44.369087Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 21s
2024-08-28T16:27:44.369084Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 64s
2024-08-28T16:27:44.369155Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 93s
2024-08-28T16:27:44.369176Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 65s
2024-08-28T16:27:44.369269Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 68s
2024-08-28T16:27:44.369271Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.369288Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 132s
2024-08-28T16:27:44.369319Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.369318Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.369320Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 152s
2024-08-28T16:27:44.369356Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 20s
2024-08-28T16:27:44.369374Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.369376Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.369426Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.369426Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.369510Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.369513Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.369600Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:44.369612Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:44.369631Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.369625Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:44.369668Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.369902Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 40s
2024-08-28T16:27:44.369933Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
2024-08-28T16:27:44.370027Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 124s
2024-08-28T16:27:44.370120Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 9s
2024-08-28T16:27:44.370180Z  INFO servers::grpc: Shutdown grpc server
2024-08-28T16:27:44.370251Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 41s
2024-08-28T16:27:44.370342Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 81s
2024-08-28T16:27:44.370371Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 172s
2024-08-28T16:27:44.370455Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 24s
2024-08-28T16:27:44.370503Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 163s
2024-08-28T16:27:44.370538Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 160s
2024-08-28T16:27:44.370587Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 45s
2024-08-28T16:27:44.370619Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.371033Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 53s
2024-08-28T16:27:44.371119Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 157s
2024-08-28T16:27:44.371137Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 25s
2024-08-28T16:27:44.371144Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 121s
2024-08-28T16:27:44.371166Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 171s
2024-08-28T16:27:44.371172Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.371185Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 88s
2024-08-28T16:27:44.371179Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.371181Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.371222Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 150s
2024-08-28T16:27:44.371228Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 10s
2024-08-28T16:27:44.371240Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 45s
2024-08-28T16:27:44.371239Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 6s
2024-08-28T16:27:44.371239Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 134s
2024-08-28T16:27:44.371266Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 128s
2024-08-28T16:27:44.371283Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.371293Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 25s
2024-08-28T16:27:44.371309Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 76s
2024-08-28T16:27:44.371309Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 12s
2024-08-28T16:27:44.371308Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 63s
2024-08-28T16:27:44.371335Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.371328Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 4s
2024-08-28T16:27:44.371347Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 58s
2024-08-28T16:27:44.371353Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 12s
2024-08-28T16:27:44.371365Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.371363Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 94s
2024-08-28T16:27:44.371414Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 45s
2024-08-28T16:27:44.371465Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.371480Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 128s
2024-08-28T16:27:44.371501Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 103s
2024-08-28T16:27:44.371525Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.371465Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 152s
2024-08-28T16:27:44.371630Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.371753Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 161s
2024-08-28T16:27:44.371778Z DEBUG common_runtime::repeated_task: Repeated task RaftEngineLogStore-gc-task started with interval: 600s
test integration_grpc_file_test::test_grpc_timezone ... ok
2024-08-28T16:27:44.372610Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 175s
2024-08-28T16:27:44.372708Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 13s
2024-08-28T16:27:44.373238Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 15s
2024-08-28T16:27:44.374207Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 79s
2024-08-28T16:27:44.374315Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.374334Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 110s
2024-08-28T16:27:44.374392Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 96s
2024-08-28T16:27:44.374579Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 147s
2024-08-28T16:27:44.374835Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.374849Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 61s
2024-08-28T16:27:44.374957Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:44.375010Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 91s
2024-08-28T16:27:44.375049Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.375071Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.375073Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 16s
2024-08-28T16:27:44.374946Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.375158Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 46s
2024-08-28T16:27:44.375217Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
test integration_grpc_file_test::test_invalid_dbname ... ok
2024-08-28T16:27:44.375259Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 143s
2024-08-28T16:27:44.375343Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 99s
2024-08-28T16:27:44.375391Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 1s
2024-08-28T16:27:44.375396Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 31s
2024-08-28T16:27:44.375427Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 56s
2024-08-28T16:27:44.375456Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 24s
2024-08-28T16:27:44.375465Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 68s
2024-08-28T16:27:44.375466Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 72s
2024-08-28T16:27:44.375493Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.375501Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 159s
2024-08-28T16:27:44.375497Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.375495Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 164s
2024-08-28T16:27:44.375516Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 2s
2024-08-28T16:27:44.375514Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 124s
2024-08-28T16:27:44.375530Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.375530Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 79s
2024-08-28T16:27:44.375545Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.375554Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 36s
2024-08-28T16:27:44.375618Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.375676Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 28s
2024-08-28T16:27:44.375681Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 137s
2024-08-28T16:27:44.375695Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 160s
2024-08-28T16:27:44.375700Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 157s
2024-08-28T16:27:44.375725Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 54s
2024-08-28T16:27:44.375741Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 51s
2024-08-28T16:27:44.375771Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 167s
2024-08-28T16:27:44.375780Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 154s
2024-08-28T16:27:44.375787Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.375814Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 56s
2024-08-28T16:27:44.375818Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 24s
2024-08-28T16:27:44.375823Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 164s
2024-08-28T16:27:44.375831Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 130s
2024-08-28T16:27:44.375851Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 10s
2024-08-28T16:27:44.375848Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 41s
2024-08-28T16:27:44.375841Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 124s
2024-08-28T16:27:44.375850Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 51s
2024-08-28T16:27:44.375889Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 39s
2024-08-28T16:27:44.375898Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 102s
2024-08-28T16:27:44.375908Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 121s
2024-08-28T16:27:44.375917Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 36s
2024-08-28T16:27:44.375965Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 132s
2024-08-28T16:27:44.375982Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 172s
2024-08-28T16:27:44.376008Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 133s
2024-08-28T16:27:44.376018Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 63s
2024-08-28T16:27:44.376018Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 126s
2024-08-28T16:27:44.376071Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 149s
2024-08-28T16:27:44.376064Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 101s
2024-08-28T16:27:44.376078Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 93s
2024-08-28T16:27:44.376146Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 62s
2024-08-28T16:27:44.376165Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 129s
2024-08-28T16:27:44.376169Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 165s
2024-08-28T16:27:44.376171Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 135s
2024-08-28T16:27:44.376170Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 173s
2024-08-28T16:27:44.376226Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 130s
2024-08-28T16:27:44.376235Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 59s
2024-08-28T16:27:44.376240Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 56s
2024-08-28T16:27:44.376253Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 107s
2024-08-28T16:27:44.376267Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 39s
2024-08-28T16:27:44.376287Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 92s
2024-08-28T16:27:44.376301Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 1s
2024-08-28T16:27:44.376322Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 27s
2024-08-28T16:27:44.376343Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 179s
2024-08-28T16:27:44.376345Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 91s
2024-08-28T16:27:44.376346Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 68s
2024-08-28T16:27:44.376367Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 116s
2024-08-28T16:27:44.376387Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 103s
2024-08-28T16:27:44.376408Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 12s
2024-08-28T16:27:44.376420Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 144s
2024-08-28T16:27:44.376424Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 35s
2024-08-28T16:27:44.376427Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 37s
2024-08-28T16:27:44.376429Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 76s
2024-08-28T16:27:44.376445Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 50s
2024-08-28T16:27:44.376480Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 160s
2024-08-28T16:27:44.376485Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 18s
2024-08-28T16:27:44.376490Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 93s
2024-08-28T16:27:44.376494Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 137s
2024-08-28T16:27:44.376502Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 114s
2024-08-28T16:27:44.376503Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 147s
2024-08-28T16:27:44.376507Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 46s
2024-08-28T16:27:44.376515Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 136s
2024-08-28T16:27:44.376548Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 104s
2024-08-28T16:27:44.376546Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 175s
2024-08-28T16:27:44.376561Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 55s
2024-08-28T16:27:44.376563Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 38s
2024-08-28T16:27:44.376578Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 100s
2024-08-28T16:27:44.376584Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 10s
2024-08-28T16:27:44.376612Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 66s
2024-08-28T16:27:44.376622Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 71s
2024-08-28T16:27:44.376626Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.376649Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 80s
2024-08-28T16:27:44.376662Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.376663Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 128s
2024-08-28T16:27:44.376662Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 58s
2024-08-28T16:27:44.376673Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 172s
2024-08-28T16:27:44.376681Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.376702Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 54s
2024-08-28T16:27:44.376712Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 158s
2024-08-28T16:27:44.376722Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 39s
2024-08-28T16:27:44.376730Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 99s
2024-08-28T16:27:44.376738Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 107s
2024-08-28T16:27:44.376741Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 35s
2024-08-28T16:27:44.376753Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 162s
2024-08-28T16:27:44.376777Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 120s
2024-08-28T16:27:44.376780Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 133s
2024-08-28T16:27:44.376785Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:44.376796Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 151s
2024-08-28T16:27:44.376802Z DEBUG mito2::cache::index: Building InvertedIndexCache with metadata size: 67108864, content size: 134217728
2024-08-28T16:27:44.376817Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 74s
2024-08-28T16:27:44.376834Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 3s
2024-08-28T16:27:44.376834Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 86s
2024-08-28T16:27:44.376840Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 31s
2024-08-28T16:27:44.376842Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.376861Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 143s
2024-08-28T16:27:44.376859Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 61s
2024-08-28T16:27:44.376881Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 57s
2024-08-28T16:27:44.376877Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.376894Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.376904Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 117s
2024-08-28T16:27:44.376918Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.376918Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.376917Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.376937Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.376937Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 101s
2024-08-28T16:27:44.376961Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.376966Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 29s
2024-08-28T16:27:44.377006Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.377006Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.377012Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.377027Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 52s
2024-08-28T16:27:44.377098Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.377095Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 146s
2024-08-28T16:27:44.377111Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.377115Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 171s
2024-08-28T16:27:44.377183Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 120s
2024-08-28T16:27:44.377184Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.377196Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.377229Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.377251Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.377293Z  INFO mito2::worker: Start region worker thread 0, init_check_delay: 1s
2024-08-28T16:27:44.377304Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.377341Z  INFO mito2::worker: Start region worker thread 1, init_check_delay: 63s
2024-08-28T16:27:44.377390Z  INFO mito2::worker: Start region worker thread 2, init_check_delay: 50s
2024-08-28T16:27:44.377404Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.377426Z  INFO mito2::worker: Start region worker thread 3, init_check_delay: 136s
2024-08-28T16:27:44.377467Z  INFO mito2::worker: Start region worker thread 4, init_check_delay: 75s
2024-08-28T16:27:44.377524Z  INFO mito2::worker: Start region worker thread 5, init_check_delay: 38s
2024-08-28T16:27:44.377546Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.377613Z  INFO mito2::worker: Start region worker thread 7, init_check_delay: 32s
2024-08-28T16:27:44.377631Z  INFO mito2::worker: Start region worker thread 6, init_check_delay: 123s
2024-08-28T16:27:44.377663Z  INFO mito2::worker: Start region worker thread 8, init_check_delay: 63s
2024-08-28T16:27:44.377686Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:44.377778Z  INFO mito2::worker: Start region worker thread 9, init_check_delay: 113s
2024-08-28T16:27:44.378067Z  INFO mito2::worker: Start region worker thread 10, init_check_delay: 69s
2024-08-28T16:27:44.378105Z  INFO mito2::worker: Start region worker thread 11, init_check_delay: 53s
2024-08-28T16:27:44.378146Z  INFO mito2::worker: Start region worker thread 12, init_check_delay: 6s
2024-08-28T16:27:44.378189Z  INFO mito2::worker: Start region worker thread 14, init_check_delay: 39s
2024-08-28T16:27:44.378188Z  INFO mito2::worker: Start region worker thread 13, init_check_delay: 141s
2024-08-28T16:27:44.378221Z  INFO mito2::worker: Start region worker thread 15, init_check_delay: 44s
2024-08-28T16:27:44.378270Z  INFO mito2::worker: Start region worker thread 17, init_check_delay: 63s
2024-08-28T16:27:44.378272Z  INFO mito2::worker: Start region worker thread 16, init_check_delay: 19s
2024-08-28T16:27:44.378270Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:44.377666Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.378336Z  INFO mito2::worker: Start region worker thread 18, init_check_delay: 48s
2024-08-28T16:27:44.378407Z  INFO mito2::worker: Start region worker thread 19, init_check_delay: 60s
2024-08-28T16:27:44.378473Z  INFO mito2::worker: Start region worker thread 20, init_check_delay: 6s
2024-08-28T16:27:44.378548Z  INFO mito2::worker: Start region worker thread 21, init_check_delay: 107s
2024-08-28T16:27:44.378587Z  INFO mito2::worker: Start region worker thread 22, init_check_delay: 140s
2024-08-28T16:27:44.378610Z  INFO mito2::worker: Start region worker thread 23, init_check_delay: 177s
2024-08-28T16:27:44.378677Z  INFO mito2::worker: Start region worker thread 24, init_check_delay: 177s
2024-08-28T16:27:44.378722Z  INFO mito2::worker: Start region worker thread 25, init_check_delay: 1s
2024-08-28T16:27:44.378730Z  INFO datanode::region_server: Region Engine mito is registered
2024-08-28T16:27:44.378793Z  INFO datanode::region_server: Region Engine metric is registered
2024-08-28T16:27:44.378828Z  INFO datanode::region_server: Region Engine file is registered
2024-08-28T16:27:44.378920Z  INFO datanode::datanode: going to open 0 region(s)
2024-08-28T16:27:44.379075Z  INFO datanode::datanode: all regions are opened
2024-08-28T16:27:44.379543Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:44.379588Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.379676Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.379533Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.379709Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.379742Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:44.379830Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:44.380785Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.380832Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.380846Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.380687Z  INFO servers::server: MySQL server started at 127.0.0.1:3112
2024-08-28T16:27:44.380969Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:44.381037Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:44.381019Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.381213Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:44.381755Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:44.381743Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.381890Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:44.382496Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.382555Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.382577Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.382673Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
test integration_grpc_file_test::test_health_check ... ok
2024-08-28T16:27:44.382802Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.382853Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.382870Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.382944Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
test integration_region_migration_file_test::test_region_migration_by_sql ... ok
2024-08-28T16:27:44.383232Z  INFO flow::server: Flow Node Manager started
test integration_grpc_file_test::test_auto_create_table ... ok
test integration_region_migration_file_test::test_region_migration_incorrect_from_peer ... ok
2024-08-28T16:27:44.383222Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.383382Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
test integration_grpc_file_test::test_grpc_zstd_compression ... ok
test integration_grpc_file_test::test_dbname ... ok
2024-08-28T16:27:44.383672Z  INFO servers::server: MySQL server started at 127.0.0.1:3114
test integration_grpc_file_test::test_grpc_message_size_limit_send ... ok
test integration_grpc_file_test::test_grpc_message_size_ok ... ok
2024-08-28T16:27:44.383737Z  INFO servers::server: MySQL server started at 127.0.0.1:3116
2024-08-28T16:27:44.383973Z  INFO servers::server: Postgres server started at 127.0.0.1:3113
2024-08-28T16:27:44.384603Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:44.384614Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:44.384522Z  INFO servers::server: Postgres server started at 127.0.0.1:3115
2024-08-28T16:27:44.384586Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.384682Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:44.384653Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.384736Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:44.384593Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.384710Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.384818Z  INFO flow::server: Flow Node Manager started
2024-08-28T16:27:44.384821Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:44.384815Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:44.384810Z  INFO flow::server: Flow Worker started in new thread
2024-08-28T16:27:44.384896Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:44.384896Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:44.384951Z DEBUG common_meta::key::flow::flow_name: flow_names: start_key: [95, 95, 102, 108, 111, 119, 47, 110, 97, 109, 101, 47, 103, 114, 101, 112, 116, 105, 109, 101, 47]
2024-08-28T16:27:44.385054Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.385092Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.385109Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.385179Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:44.385786Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.385794Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.385839Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.385842Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.385865Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.385862Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.385951Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:44.385951Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:44.385904Z  INFO servers::server: MySQL server started at 127.0.0.1:3117
2024-08-28T16:27:44.386059Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.386068Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.386122Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.386130Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.386153Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.386153Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.386145Z DEBUG common_runtime::repeated_task: Repeated task ProcedureManager-remove-outdated-meta-task started with interval: 600s
2024-08-28T16:27:44.386197Z  INFO common_procedure::local: LocalManager is start.
2024-08-28T16:27:44.386246Z  INFO common_procedure::local: LocalManager start to recover
2024-08-28T16:27:44.386253Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:44.386264Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:44.386386Z  INFO common_procedure::local: LocalManager finish recovery, cost: 0ms
2024-08-28T16:27:44.387120Z  INFO servers::server: Postgres server started at 127.0.0.1:3118
2024-08-28T16:27:44.387215Z  INFO servers::server: Postgres server started at 127.0.0.1:3119
2024-08-28T16:27:44.387327Z  INFO servers::server: Postgres server started at 127.0.0.1:3120
2024-08-28T16:27:44.387407Z  INFO servers::server: Postgres server started at 127.0.0.1:3121
2024-08-28T16:27:44.387952Z  INFO servers::server: MySQL server started at 127.0.0.1:3122
2024-08-28T16:27:44.388720Z  INFO servers::grpc: Shutdown grpc server
test integration_grpc_file_test::test_grpc_auth ... ok
2024-08-28T16:27:44.566110Z  INFO common_grpc::channel_manager: ChannelManager: 22, channel recycle is started, running in the background!
2024-08-28T16:27:44.574783Z DEBUG GreptimeRequestHandler::handle_request_runtime:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "test", desc: "", column_defs: [ColumnDef { name: "i", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "j", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "k", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }], time_index: "j", primary_keys: ["k"], create_if_not_exists: false, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "test", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [i Float64 null, j TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, k String null], timestamp_index: Some(1), version: 0 }, primary_key_indices: [2], value_indices: [], engine: "mito", next_column_id: 3, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:44.574609718Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:44.575115Z  INFO common_grpc::channel_manager: ChannelManager: 24, channel recycle is started, running in the background!
2024-08-28T16:27:44.575610Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-f9efb850-f60f-44c8-856c-9083e23a1bce starts
2024-08-28T16:27:44.576217Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:44.576321Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-f9efb850-f60f-44c8-856c-9083e23a1bce once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.578558Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.578660Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:44.578634Z DEBUG log: No cached session for IpAddress(V4(Ipv4Addr([127, 0, 0, 1])))    
2024-08-28T16:27:44.579075Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:44.579142Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:44.579233Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[i Float64 null Field 0], [j TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1], [k String null Tag 2]], time_index: 1, primary_key: [2], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:44.579315Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[i Float64 null Field 0], [j TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1], [k String null Tag 2]], time_index: 1, primary_key: [2], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:44.579519Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:44.580001Z DEBUG log: Not resuming any session    
2024-08-28T16:27:44.580840Z DEBUG log: decided upon suite TLS13_AES_256_GCM_SHA384    
2024-08-28T16:27:44.582289Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:44.582374Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:44.582500Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[i Float64 null Field 0], [j TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1], [k String null Tag 2]], time_index: 1, primary_key: [2], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:44.582862Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:44.583139Z DEBUG log: Chosen ALPN protocol [104, 50]    
2024-08-28T16:27:44.583224Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-f9efb850-f60f-44c8-856c-9083e23a1bce once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.585038Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:44.585178Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-f9efb850-f60f-44c8-856c-9083e23a1bce once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:44.585373Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-f9efb850-f60f-44c8-856c-9083e23a1bce done
2024-08-28T16:27:44.585701Z  INFO GreptimeRequestHandler::handle_request_runtime:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(f9efb850-f60f-44c8-856c-9083e23a1bce)
2024-08-28T16:27:44.585856Z  INFO GreptimeRequestHandler::handle_request_runtime:do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.test' with table id 1024
2024-08-28T16:27:44.585837Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure f9efb850-f60f-44c8-856c-9083e23a1bce, step_keys: ["procedure/f9efb850-f60f-44c8-856c-9083e23a1bce/0000000000.step", "procedure/f9efb850-f60f-44c8-856c-9083e23a1bce/0000000001.step"], finish_keys: ["procedure/f9efb850-f60f-44c8-856c-9083e23a1bce/0000000002.commit"]
2024-08-28T16:27:44.586259Z DEBUG log: Using ciphersuite TLS13_AES_256_GCM_SHA384    
2024-08-28T16:27:44.586364Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-f9efb850-f60f-44c8-856c-9083e23a1bce exits
2024-08-28T16:27:44.586410Z DEBUG log: Not resuming    
2024-08-28T16:27:44.587437Z DEBUG log: TLS1.3 encrypted extensions: [Protocols([ProtocolName(6832)])]    
2024-08-28T16:27:44.587509Z DEBUG log: ALPN protocol is Some(b"h2")    
2024-08-28T16:27:44.605805Z  INFO common_grpc::channel_manager: ChannelManager: 26, channel recycle is started, running in the background!
2024-08-28T16:27:44.612820Z DEBUG GreptimeRequestHandler::handle_request_runtime:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "blabla little magic fairy", column_defs: [ColumnDef { name: "host", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "cpu", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "memory", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["host"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: Some("blabla little magic fairy"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:44.612577154Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:44.613889Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-7666e5f0-d34d-4cf4-a276-12570da99f86 starts
2024-08-28T16:27:44.614600Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:44.614751Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-7666e5f0-d34d-4cf4-a276-12570da99f86 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.617714Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:44.617846Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:44.618348Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:44.618444Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:44.618546Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:44.618607Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:44.618761Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:44.620988Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:44.621076Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:44.621176Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[host String not null Tag 0], [cpu Float64 null Field 1], [memory Float64 null Field 2], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 3]], time_index: 3, primary_key: [0], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:44.621475Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:44.621772Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-7666e5f0-d34d-4cf4-a276-12570da99f86 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.623157Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:44.623259Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-7666e5f0-d34d-4cf4-a276-12570da99f86 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:44.623417Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-7666e5f0-d34d-4cf4-a276-12570da99f86 done
2024-08-28T16:27:44.623734Z  INFO GreptimeRequestHandler::handle_request_runtime:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(7666e5f0-d34d-4cf4-a276-12570da99f86)
2024-08-28T16:27:44.623787Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 7666e5f0-d34d-4cf4-a276-12570da99f86, step_keys: ["procedure/7666e5f0-d34d-4cf4-a276-12570da99f86/0000000000.step", "procedure/7666e5f0-d34d-4cf4-a276-12570da99f86/0000000001.step"], finish_keys: ["procedure/7666e5f0-d34d-4cf4-a276-12570da99f86/0000000002.commit"]
2024-08-28T16:27:44.623911Z  INFO GreptimeRequestHandler::handle_request_runtime:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:44.624055Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-7666e5f0-d34d-4cf4-a276-12570da99f86 exits
2024-08-28T16:27:44.625067Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2]), filters: [], output_ordering: Some([OrderOption { name: "k", options: SortOptions { descending: true, nulls_first: false } }, OrderOption { name: "j", options: SortOptions { descending: true, nulls_first: false } }]), limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:44.625224Z  INFO common_grpc::channel_manager: ChannelManager: 28, channel recycle is started, running in the background!
2024-08-28T16:27:44.625277Z  WARN flight_data_stream: servers::grpc::flight::stream: stop sending Flight data err=SendError { kind: Disconnected }
2024-08-28T16:27:44.625722Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.627034Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.629842Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:44.631875Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 2, num_pruned_series: 0, num_rows: 3, num_batches: 2, scan_cost: 763.257µs }
2024-08-28T16:27:44.632148Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 1.498663ms
2024-08-28T16:27:44.632692Z  INFO GreptimeRequestHandler::handle_request_runtime:alter_table_inner: operator::statement::ddl: Table info before alter is TableInfo { ident: TableIdent { table_id: 1024, version: 0 }, name: "demo", desc: Some("blabla little magic fairy"), catalog_name: "greptime", schema_name: "public", meta: TableMeta { schema: Schema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], name_to_index: {"memory": 2, "ts": 3, "cpu": 1, "host": 0}, timestamp_index: Some(3), version: 0 }, primary_key_indices: [0], value_indices: [], engine: "mito", region_numbers: [0], next_column_id: 4, options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:44.612577154Z, partition_key_indices: [] }, table_type: Base }, expr: AlterExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", kind: Some(AddColumns(AddColumns { add_columns: [AddColumn { column_def: Some(ColumnDef { name: "test_column", data_type: Int64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }), location: None }] })) }
2024-08-28T16:27:44.633594Z DEBUG GreptimeRequestHandler::handle_request_runtime:alter_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: AlterTable(AlterTableTask { alter_table: AlterExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", kind: Some(AddColumns(AddColumns { add_columns: [AddColumn { column_def: Some(ColumnDef { name: "test_column", data_type: Int64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }), location: None }] })) } })
2024-08-28T16:27:44.634230Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::AlterTable-3923199e-1cf0-4dc5-ac66-38e88e097249 starts
2024-08-28T16:27:44.634839Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::AlterTable-3923199e-1cf0-4dc5-ac66-38e88e097249 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.635810Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::alter_table: Submitting RegionRequest { header: Some(RegionRequestHeader { tracing_context: {}, dbname: "", query_context: None }), body: Some(Alter(AlterRequest { region_id: 4398046511104, schema_version: 0, kind: Some(AddColumns(AddColumns { add_columns: [AddColumn { column_def: Some(RegionColumnDef { column_def: Some(ColumnDef { name: "test_column", data_type: Int64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }), column_id: 4 }), location: None }] })) })) } to peer-0()
2024-08-28T16:27:44.635974Z  INFO servers::grpc: Shutdown grpc server
2024-08-28T16:27:44.636136Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 4.7359ms, build_parts_cost: 334.373µs, build_reader_cost: 1.498663ms, scan_cost: 393.147µs, convert_cost: 771.97µs, yield_cost: 2.662683ms, total_cost: 11.129103ms, num_batches: 2, num_rows: 3, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 4.82878ms
2024-08-28T16:27:44.636361Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:44.636477Z  INFO mito2::worker::handle_alter: Try to alter region: 4398046511104(1024, 0), request: RegionAlterRequest { schema_version: 0, kind: AddColumns { columns: [AddColumn { column_metadata: [test_column Int64 null Field 4], location: None }] } }
2024-08-28T16:27:44.636591Z  INFO mito2::worker::handle_alter: Try to alter region 4398046511104(1024, 0) from version 0 to 0
2024-08-28T16:27:44.636537Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 1.284435ms, num_fetch_by_batches: 2, num_fetch_by_rows: 0, num_input_rows: 3, num_output_rows: 3, fetch_cost: 1.217086ms }
2024-08-28T16:27:44.637083Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 1
2024-08-28T16:27:44.637669Z DEBUG log: Sending warning alert CloseNotify    
2024-08-28T16:27:44.637340Z DEBUG log: Sending warning alert CloseNotify    
2024-08-28T16:27:44.639031Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 1
2024-08-28T16:27:44.639241Z  INFO mito2::worker::handle_manifest: Region 4398046511104(1024, 0) is altered, schema version is 1
2024-08-28T16:27:44.639545Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::AlterTable-3923199e-1cf0-4dc5-ac66-38e88e097249 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.640455Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::alter_table: Starting update table: greptime.public.demo metadata, new table info TableInfo { ident: TableIdent { table_id: 1024, version: 1 }, name: "demo", desc: Some("blabla little magic fairy"), catalog_name: "greptime", schema_name: "public", meta: TableMeta { schema: Schema { column_schemas: [host String not null, cpu Float64 null, memory Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, test_column Int64 null], name_to_index: {"cpu": 1, "ts": 3, "test_column": 4, "memory": 2, "host": 0}, timestamp_index: Some(3), version: 1 }, primary_key_indices: [0], value_indices: [1, 2, 3, 4], engine: "mito", region_numbers: [0], next_column_id: 5, options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:44.612577154Z, partition_key_indices: [] }, table_type: Base }
2024-08-28T16:27:44.640999Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::alter_table: Updated table metadata for table greptime.public.demo, table_id: 1024
2024-08-28T16:27:44.641062Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::AlterTable-3923199e-1cf0-4dc5-ac66-38e88e097249 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:44.641866Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::AlterTable-3923199e-1cf0-4dc5-ac66-38e88e097249 once, status: Done { output: None }, need_persist: false
2024-08-28T16:27:44.642010Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::AlterTable-3923199e-1cf0-4dc5-ac66-38e88e097249 done
2024-08-28T16:27:44.642313Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 3923199e-1cf0-4dc5-ac66-38e88e097249, step_keys: ["procedure/3923199e-1cf0-4dc5-ac66-38e88e097249/0000000000.step", "procedure/3923199e-1cf0-4dc5-ac66-38e88e097249/0000000001.step", "procedure/3923199e-1cf0-4dc5-ac66-38e88e097249/0000000002.step"], finish_keys: ["procedure/3923199e-1cf0-4dc5-ac66-38e88e097249/0000000003.commit"]
2024-08-28T16:27:44.642284Z  INFO GreptimeRequestHandler::handle_request_runtime:alter_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is altered via procedure_id ProcedureId(3923199e-1cf0-4dc5-ac66-38e88e097249)
2024-08-28T16:27:44.642529Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.553473ms, first_consume: 19.558822ms, do_get_cost: 16.946561ms
2024-08-28T16:27:44.642540Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::AlterTable-3923199e-1cf0-4dc5-ac66-38e88e097249 exits
test integration_grpc_file_test::test_grpc_tls_config ... ok
2024-08-28T16:27:44.646859Z DEBUG servers::grpc::database: GreptimeDatabase::Handle: request from Some(127.0.0.1:36126) with hints: []
2024-08-28T16:27:44.670261Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2]), filters: [], output_ordering: Some([OrderOption { name: "k", options: SortOptions { descending: true, nulls_first: false } }, OrderOption { name: "j", options: SortOptions { descending: true, nulls_first: false } }]), limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:44.671075Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.672665Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.674889Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:44.676015Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 2, num_pruned_series: 0, num_rows: 3, num_batches: 2, scan_cost: 512.34µs }
2024-08-28T16:27:44.676259Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 1.010217ms
2024-08-28T16:27:44.677328Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 4.686988ms, build_parts_cost: 155.251µs, build_reader_cost: 1.010217ms, scan_cost: 234.625µs, convert_cost: 457.508µs, yield_cost: 259.814µs, total_cost: 7.161207ms, num_batches: 2, num_rows: 3, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 4.722223ms
2024-08-28T16:27:44.677413Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:44.677496Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 896.773µs, num_fetch_by_batches: 2, num_fetch_by_rows: 0, num_input_rows: 3, num_output_rows: 3, fetch_cost: 856.728µs }
2024-08-28T16:27:44.678338Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:44.678871Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.679677Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.680542Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:44.681496Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 682.258µs
2024-08-28T16:27:44.682328Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 6, num_pruned_series: 0, num_rows: 6, num_batches: 6, scan_cost: 1.233894ms }
2024-08-28T16:27:44.682737Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.532702ms, build_parts_cost: 122.321µs, build_reader_cost: 682.258µs, scan_cost: 346.087µs, convert_cost: 655.028µs, yield_cost: 156.812µs, total_cost: 4.464785ms, num_batches: 6, num_rows: 6, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.550349ms
2024-08-28T16:27:44.682818Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:44.682858Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 629.938µs, num_fetch_by_batches: 6, num_fetch_by_rows: 0, num_input_rows: 6, num_output_rows: 6, fetch_cost: 584.412µs }
2024-08-28T16:27:44.683381Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.232676ms, first_consume: 9.633609ms, do_get_cost: 7.430893ms
2024-08-28T16:27:44.683790Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.968883ms, first_consume: 17.109135ms, do_get_cost: 14.094666ms
2024-08-28T16:27:44.692958Z  INFO servers::grpc: Shutdown grpc server
test integration_grpc_file_test::test_insert_and_select ... ok
2024-08-28T16:27:44.714365Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2]), filters: [], output_ordering: Some([OrderOption { name: "k", options: SortOptions { descending: true, nulls_first: false } }, OrderOption { name: "j", options: SortOptions { descending: true, nulls_first: false } }]), limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:44.715034Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.716373Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:44.718621Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:44.728087Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 0ns, first_consume: 0ns, do_get_cost: 11.851664ms
2024-08-28T16:27:44.732982Z  INFO servers::grpc: Shutdown grpc server
test integration_grpc_file_test::test_prom_gateway_query ... ok
2024-08-28T16:27:45.032344Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:36841
2024-08-28T16:27:45.066953Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:42765
2024-08-28T16:27:45.069985Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:42465
2024-08-28T16:27:45.077242Z  WARN servers::http::authorize: extract username and password failed err=0: Not found http or grpc authorization header
2024-08-28T16:27:45.077449Z DEBUG servers::http::error_result: Failed to handle HTTP request, err: 0: Not found http or grpc authorization header
2024-08-28T16:27:45.082621Z  WARN servers::http::authorize: authenticate failed err=0: Username and password does not match, username: greptime_user
2024-08-28T16:27:45.082739Z DEBUG servers::http::error_result: Failed to handle HTTP request, err: 0: Username and password does not match, username: greptime_user
2024-08-28T16:27:45.091467Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:46653
2024-08-28T16:27:45.094349Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:40083
2024-08-28T16:27:45.096246Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:44465
2024-08-28T16:27:45.098697Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:35037
2024-08-28T16:27:45.108587Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:35619
2024-08-28T16:27:45.120017Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:35739
2024-08-28T16:27:45.120693Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:39693
2024-08-28T16:27:45.135477Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts: operator::insert: Physical metric table `greptime.public.greptime_physical_table` does not exist, try creating table
2024-08-28T16:27:45.136254Z DEBUG remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "greptime_physical_table", desc: "Created on insertion", column_defs: [ColumnDef { name: "greptime_timestamp", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "greptime_value", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }], time_index: "greptime_timestamp", primary_keys: [], create_if_not_exists: true, table_options: {"physical_metric_table": "true"}, table_id: None, engine: "metric" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "greptime_physical_table", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, greptime_value Float64 null], timestamp_index: Some(0), version: 0 }, primary_key_indices: [], value_indices: [], engine: "metric", next_column_id: 2, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"physical_metric_table": "true"} }, created_on: 2024-08-28T16:27:45.136114142Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.137433Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-c9cb979d-6c10-4f71-b508-2e02443574fb starts
2024-08-28T16:27:45.137807Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1025
2024-08-28T16:27:45.137910Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-c9cb979d-6c10-4f71-b508-2e02443574fb once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.138857Z DEBUG create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "greptime_private", table_name: "pipelines", desc: "GreptimeDB pipeline table for Log", column_defs: [ColumnDef { name: "name", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "schema", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "content_type", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "pipeline", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "created_at", data_type: TimestampNanosecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "created_at", primary_keys: ["schema", "name", "content_type"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "pipelines", desc: Some("GreptimeDB pipeline table for Log"), catalog_name: "greptime", schema_name: "greptime_private", meta: RawTableMeta { schema: RawSchema { column_schemas: [name String not null, schema String not null, content_type String not null, pipeline String not null, created_at TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(4), version: 0 }, primary_key_indices: [1, 0, 2], value_indices: [], engine: "mito", next_column_id: 5, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.138758438Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.139407Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced starts
2024-08-28T16:27:45.139757Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1025
2024-08-28T16:27:45.139892Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.139956Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.140061Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1025/1025_0000000000/metadata/manifest/, build manifest from scratch
2024-08-28T16:27:45.140443Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1025/1025_0000000000/metadata/manifest/
2024-08-28T16:27:45.140506Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1025/1025_0000000000/metadata/, region_id: 4402358255616(1025, 16777216)
2024-08-28T16:27:45.140582Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1025/1025_0000000000/metadata/manifest/ with metadata RegionMetadata { column_metadatas: [[ts TimestampMillisecond not null default=Value(Timestamp(0::Millisecond)) Timestamp 0], [k String not null Tag 1], [v String null Field 2]], time_index: 0, primary_key: [1], region_id: 4402358255616(1025, 16777216), schema_version: 0 }
2024-08-28T16:27:45.140666Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1025/1025_0000000000/metadata/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[ts TimestampMillisecond not null default=Value(Timestamp(0::Millisecond)) Timestamp 0], [k String not null Tag 1], [v String null Field 2]], time_index: 0, primary_key: [1], region_id: 4402358255616(1025, 16777216), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.140857Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.142399Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.142502Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/greptime_private/1025/1025_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.143046Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/greptime_private/1025/1025_0000000000/manifest/
2024-08-28T16:27:45.143130Z DEBUG mito2::region::opener: No data under directory data/greptime/greptime_private/1025/1025_0000000000/, region_id: 4402341478400(1025, 0)
2024-08-28T16:27:45.143213Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402358255616(1025, 16777216), memtable_id: 0
2024-08-28T16:27:45.143262Z DEBUG mito2::region::opener: Create region 4402358255616(1025, 16777216) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.143234Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/greptime_private/1025/1025_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[name String not null Tag 0], [schema String not null Tag 1], [content_type String not null Tag 2], [pipeline String not null Field 3], [created_at TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 4]], time_index: 4, primary_key: [1, 0, 2], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.143344Z  INFO mito2::worker::handle_create: A new region created, worker: 25, region: RegionMetadata { column_metadatas: [[ts TimestampMillisecond not null default=Value(Timestamp(0::Millisecond)) Timestamp 0], [k String not null Tag 1], [v String null Field 2]], time_index: 0, primary_key: [1], region_id: 4402358255616(1025, 16777216), schema_version: 0 }
2024-08-28T16:27:45.143347Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/greptime_private/1025/1025_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[name String not null Tag 0], [schema String not null Tag 1], [content_type String not null Tag 2], [pipeline String not null Field 3], [created_at TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 4]], time_index: 4, primary_key: [1, 0, 2], region_id: 4402341478400(1025, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
test integration_http_file_test::test_config_api ... ok
2024-08-28T16:27:45.143670Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.144739Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.144794Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1025/1025_0000000000/data/manifest/, build manifest from scratch
2024-08-28T16:27:45.145048Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1025/1025_0000000000/data/manifest/
2024-08-28T16:27:45.145089Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1025/1025_0000000000/data/, region_id: 4402341478400(1025, 0)
2024-08-28T16:27:45.145139Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1025/1025_0000000000/data/manifest/ with metadata RegionMetadata { column_metadatas: [[greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 0], [greptime_value Float64 null Field 1], [__table_id UInt32 not null Tag 2147483652], [__tsid UInt64 not null Tag 2147483651]], time_index: 0, primary_key: [2147483652, 2147483651], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.145189Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1025/1025_0000000000/data/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 0], [greptime_value Float64 null Field 1], [__table_id UInt32 not null Tag 2147483652], [__tsid UInt64 not null Tag 2147483651]], time_index: 0, primary_key: [2147483652, 2147483651], region_id: 4402341478400(1025, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.145310Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.145575Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 0
2024-08-28T16:27:45.145613Z DEBUG mito2::region::opener: Create region 4402341478400(1025, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.145667Z  INFO mito2::worker::handle_create: A new region created, worker: 11, region: RegionMetadata { column_metadatas: [[name String not null Tag 0], [schema String not null Tag 1], [content_type String not null Tag 2], [pipeline String not null Field 3], [created_at TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 4]], time_index: 4, primary_key: [1, 0, 2], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.145819Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4402341478400(1025, 0) is registered to engine mito
2024-08-28T16:27:45.146010Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.146906Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1025
2024-08-28T16:27:45.146980Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.147080Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced done
2024-08-28T16:27:45.147127Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 0
2024-08-28T16:27:45.147197Z DEBUG mito2::region::opener: Create region 4402341478400(1025, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [2147483651], segment_row_count: 256 } }, memtable: Some(PartitionTree(PartitionTreeOptions { index_max_keys_per_shard: 8192, data_freeze_threshold: 131072, fork_dictionary_bytes: 512.0MiB })), merge_mode: None }
2024-08-28T16:27:45.147263Z  INFO create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1025 is created via procedure_id ProcedureId(b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced)
2024-08-28T16:27:45.147286Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts: operator::insert: Physical metric table `greptime.public.greptime_physical_table` does not exist, try creating table
2024-08-28T16:27:45.147296Z  INFO mito2::worker::handle_create: A new region created, worker: 11, region: RegionMetadata { column_metadatas: [[greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 0], [greptime_value Float64 null Field 1], [__table_id UInt32 not null Tag 2147483652], [__tsid UInt64 not null Tag 2147483651]], time_index: 0, primary_key: [2147483652, 2147483651], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.147335Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced, step_keys: ["procedure/b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced/0000000000.step", "procedure/b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced/0000000001.step"], finish_keys: ["procedure/b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced/0000000002.commit"]
2024-08-28T16:27:45.147363Z  INFO create_table_inner: operator::statement::ddl: Successfully created table 'greptime.greptime_private.pipelines' with table id 1025
2024-08-28T16:27:45.147521Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-b05eee3f-96dd-4c88-ad9d-73fc4a4c6ced exits
2024-08-28T16:27:45.147546Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Created physical metric region 4402341478400(1025, 0)
2024-08-28T16:27:45.147730Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4402341478400(1025, 0) is registered to engine metric
2024-08-28T16:27:45.147895Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([1, 2]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.148887Z DEBUG remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "greptime_physical_table", desc: "Created on insertion", column_defs: [ColumnDef { name: "greptime_timestamp", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "greptime_value", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }], time_index: "greptime_timestamp", primary_keys: [], create_if_not_exists: true, table_options: {"physical_metric_table": "true"}, table_id: None, engine: "metric" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "greptime_physical_table", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, greptime_value Float64 null], timestamp_index: Some(0), version: 0 }, primary_key_indices: [], value_indices: [], engine: "metric", next_column_id: 2, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"physical_metric_table": "true"} }, created_on: 2024-08-28T16:27:45.147879226Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.149338Z  INFO pipeline::manager::pipeline_operator: Created pipelines table greptime.greptime_private.pipelines with table id 1025.
2024-08-28T16:27:45.149328Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.149435Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-02d81ef8-f0ba-499e-888f-02d2ad1bc9f4 starts
2024-08-28T16:27:45.149632Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1025
2024-08-28T16:27:45.149690Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-02d81ef8-f0ba-499e-888f-02d2ad1bc9f4 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.149997Z DEBUG create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "greptime_private", table_name: "pipelines", desc: "GreptimeDB pipeline table for Log", column_defs: [ColumnDef { name: "name", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "schema", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "content_type", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "pipeline", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "created_at", data_type: TimestampNanosecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "created_at", primary_keys: ["schema", "name", "content_type"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "pipelines", desc: Some("GreptimeDB pipeline table for Log"), catalog_name: "greptime", schema_name: "greptime_private", meta: RawTableMeta { schema: RawSchema { column_schemas: [name String not null, schema String not null, content_type String not null, pipeline String not null, created_at TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(4), version: 0 }, primary_key_indices: [1, 0, 2], value_indices: [], engine: "mito", next_column_id: 5, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.149912742Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.150195Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-c9cb979d-6c10-4f71-b508-2e02443574fb once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.150213Z DEBUG pipeline::etl: processors_required_original_keys: ["time"]
2024-08-28T16:27:45.150272Z DEBUG pipeline::etl: processors_required_keys: ["time"]
2024-08-28T16:27:45.150300Z DEBUG pipeline::etl: processors_output_keys: ["time"]
2024-08-28T16:27:45.150342Z DEBUG pipeline::etl: required_keys: ["id1", "id2", "log", "logger", "time", "type"]
2024-08-28T16:27:45.150471Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-b73727f0-0673-4b7e-9c5c-0dc823bfe1dc starts
2024-08-28T16:27:45.150683Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1025
2024-08-28T16:27:45.150780Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-b73727f0-0673-4b7e-9c5c-0dc823bfe1dc once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.151068Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.151119Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1025/1025_0000000000/metadata/manifest/, build manifest from scratch
2024-08-28T16:27:45.151279Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1025
2024-08-28T16:27:45.151363Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-c9cb979d-6c10-4f71-b508-2e02443574fb once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.151425Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1025/1025_0000000000/metadata/manifest/
2024-08-28T16:27:45.151465Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1025/1025_0000000000/metadata/, region_id: 4402358255616(1025, 16777216)
2024-08-28T16:27:45.151500Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-c9cb979d-6c10-4f71-b508-2e02443574fb done
2024-08-28T16:27:45.151523Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1025/1025_0000000000/metadata/manifest/ with metadata RegionMetadata { column_metadatas: [[ts TimestampMillisecond not null default=Value(Timestamp(0::Millisecond)) Timestamp 0], [k String not null Tag 1], [v String null Field 2]], time_index: 0, primary_key: [1], region_id: 4402358255616(1025, 16777216), schema_version: 0 }
2024-08-28T16:27:45.151570Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1025/1025_0000000000/metadata/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[ts TimestampMillisecond not null default=Value(Timestamp(0::Millisecond)) Timestamp 0], [k String not null Tag 1], [v String null Field 2]], time_index: 0, primary_key: [1], region_id: 4402358255616(1025, 16777216), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.151698Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.151808Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure c9cb979d-6c10-4f71-b508-2e02443574fb, step_keys: ["procedure/c9cb979d-6c10-4f71-b508-2e02443574fb/0000000000.step", "procedure/c9cb979d-6c10-4f71-b508-2e02443574fb/0000000001.step"], finish_keys: ["procedure/c9cb979d-6c10-4f71-b508-2e02443574fb/0000000002.commit"]
2024-08-28T16:27:45.151875Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1025 is created via procedure_id ProcedureId(c9cb979d-6c10-4f71-b508-2e02443574fb)
2024-08-28T16:27:45.151949Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:46811
2024-08-28T16:27:45.152051Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-c9cb979d-6c10-4f71-b508-2e02443574fb exits
2024-08-28T16:27:45.152051Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.greptime_physical_table' with table id 1025
2024-08-28T16:27:45.152239Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts: operator::insert: Successfully created table greptime.public.greptime_physical_table
2024-08-28T16:27:45.152379Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.152441Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/greptime_private/1025/1025_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.152571Z DEBUG create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "scripts", desc: "GreptimeDB scripts table for Python", column_defs: [ColumnDef { name: "schema", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "name", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "engine", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "script", data_type: String, is_nullable: false, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "greptime_timestamp", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "gmt_modified", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }], time_index: "greptime_timestamp", primary_keys: ["schema", "name", "engine"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "scripts", desc: Some("GreptimeDB scripts table for Python"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [schema String not null, name String not null, engine String not null, script String not null, greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, gmt_modified TimestampMillisecond not null], timestamp_index: Some(4), version: 0 }, primary_key_indices: [0, 1, 2], value_indices: [], engine: "mito", next_column_id: 6, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.152500802Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.152772Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/greptime_private/1025/1025_0000000000/manifest/
2024-08-28T16:27:45.152821Z DEBUG mito2::region::opener: No data under directory data/greptime/greptime_private/1025/1025_0000000000/, region_id: 4402341478400(1025, 0)
2024-08-28T16:27:45.152893Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/greptime_private/1025/1025_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[name String not null Tag 0], [schema String not null Tag 1], [content_type String not null Tag 2], [pipeline String not null Field 3], [created_at TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 4]], time_index: 4, primary_key: [1, 0, 2], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.152945Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-6900ed87-1bac-4dd2-897b-7fe1c99fa1bb starts
2024-08-28T16:27:45.152966Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/greptime_private/1025/1025_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[name String not null Tag 0], [schema String not null Tag 1], [content_type String not null Tag 2], [pipeline String not null Field 3], [created_at TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 4]], time_index: 4, primary_key: [1, 0, 2], region_id: 4402341478400(1025, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.152998Z  INFO pipeline::manager::table: Insert pipeline success, name: "test", table: "greptime.greptime_private.pipelines", output: Output { data: OutputData::AffectedRows(1), meta: OutputMeta { plan: None, cost: 0 } }
2024-08-28T16:27:45.153097Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1025
2024-08-28T16:27:45.153146Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.153152Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-6900ed87-1bac-4dd2-897b-7fe1c99fa1bb once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.153437Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402358255616(1025, 16777216), memtable_id: 0
2024-08-28T16:27:45.153517Z DEBUG mito2::region::opener: Create region 4402358255616(1025, 16777216) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.153648Z  INFO mito2::worker::handle_create: A new region created, worker: 25, region: RegionMetadata { column_metadatas: [[ts TimestampMillisecond not null default=Value(Timestamp(0::Millisecond)) Timestamp 0], [k String not null Tag 1], [v String null Field 2]], time_index: 0, primary_key: [1], region_id: 4402358255616(1025, 16777216), schema_version: 0 }
2024-08-28T16:27:45.153970Z DEBUG remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_logical_tables:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateLogicalTables([CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "metric2", desc: "Created on insertion", column_defs: [ColumnDef { name: "greptime_timestamp", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "greptime_value", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "instance", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "idc", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }], time_index: "greptime_timestamp", primary_keys: ["instance", "idc"], create_if_not_exists: true, table_options: {"on_physical_table": "greptime_physical_table"}, table_id: None, engine: "metric" }, partitions: [], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "metric2", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, greptime_value Float64 null, instance String null, idc String null], timestamp_index: Some(0), version: 0 }, primary_key_indices: [2, 3], value_indices: [], engine: "metric", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"on_physical_table": "greptime_physical_table"} }, created_on: 2024-08-28T16:27:45.153711002Z, partition_key_indices: [] }, table_type: Base } }, CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "metric3", desc: "Created on insertion", column_defs: [ColumnDef { name: "greptime_timestamp", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "greptime_value", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "idc", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "app", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }], time_index: "greptime_timestamp", primary_keys: ["idc", "app"], create_if_not_exists: true, table_options: {"on_physical_table": "greptime_physical_table"}, table_id: None, engine: "metric" }, partitions: [], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "metric3", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, greptime_value Float64 null, idc String null, app String null], timestamp_index: Some(0), version: 0 }, primary_key_indices: [2, 3], value_indices: [], engine: "metric", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"on_physical_table": "greptime_physical_table"} }, created_on: 2024-08-28T16:27:45.153776586Z, partition_key_indices: [] }, table_type: Base } }, CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "metric1", desc: "Created on insertion", column_defs: [ColumnDef { name: "greptime_timestamp", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "greptime_value", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "job", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }], time_index: "greptime_timestamp", primary_keys: ["job"], create_if_not_exists: true, table_options: {"on_physical_table": "greptime_physical_table"}, table_id: None, engine: "metric" }, partitions: [], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "metric1", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, greptime_value Float64 null, job String null], timestamp_index: Some(0), version: 0 }, primary_key_indices: [2], value_indices: [], engine: "metric", next_column_id: 3, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"on_physical_table": "greptime_physical_table"} }, created_on: 2024-08-28T16:27:45.153815013Z, partition_key_indices: [] }, table_type: Base } }])
2024-08-28T16:27:45.154255Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.154307Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1025/1025_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.154522Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1025/1025_0000000000/manifest/
2024-08-28T16:27:45.154562Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1025/1025_0000000000/, region_id: 4402341478400(1025, 0)
2024-08-28T16:27:45.154615Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1025/1025_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[schema String not null Tag 0], [name String not null Tag 1], [engine String not null Tag 2], [script String not null Field 3], [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 4], [gmt_modified TimestampMillisecond not null Field 5]], time_index: 4, primary_key: [0, 1, 2], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.154678Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1025/1025_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[schema String not null Tag 0], [name String not null Tag 1], [engine String not null Tag 2], [script String not null Field 3], [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 4], [gmt_modified TimestampMillisecond not null Field 5]], time_index: 4, primary_key: [0, 1, 2], region_id: 4402341478400(1025, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.154760Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateLogicalTables-4af55ee6-0b45-40f9-a5d8-7e28b43d34bc starts
2024-08-28T16:27:45.154806Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 0
2024-08-28T16:27:45.154834Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.154843Z DEBUG mito2::region::opener: Create region 4402341478400(1025, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.154892Z  INFO mito2::worker::handle_create: A new region created, worker: 11, region: RegionMetadata { column_metadatas: [[name String not null Tag 0], [schema String not null Tag 1], [content_type String not null Tag 2], [pipeline String not null Field 3], [created_at TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 4]], time_index: 4, primary_key: [1, 0, 2], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.155034Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4402341478400(1025, 0) is registered to engine mito
2024-08-28T16:27:45.155187Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-b73727f0-0673-4b7e-9c5c-0dc823bfe1dc once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.155217Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateLogicalTables-4af55ee6-0b45-40f9-a5d8-7e28b43d34bc once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.155414Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.155541Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1025/1025_0000000000/data/manifest/, build manifest from scratch
2024-08-28T16:27:45.156052Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1025/1025_0000000000/data/manifest/
2024-08-28T16:27:45.156095Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1025
2024-08-28T16:27:45.156124Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1025/1025_0000000000/data/, region_id: 4402341478400(1025, 0)
2024-08-28T16:27:45.156162Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-b73727f0-0673-4b7e-9c5c-0dc823bfe1dc once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.156202Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1025/1025_0000000000/data/manifest/ with metadata RegionMetadata { column_metadatas: [[greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 0], [greptime_value Float64 null Field 1], [__table_id UInt32 not null Tag 2147483652], [__tsid UInt64 not null Tag 2147483651]], time_index: 0, primary_key: [2147483652, 2147483651], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.156257Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-b73727f0-0673-4b7e-9c5c-0dc823bfe1dc done
2024-08-28T16:27:45.156290Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1025/1025_0000000000/data/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 0], [greptime_value Float64 null Field 1], [__table_id UInt32 not null Tag 2147483652], [__tsid UInt64 not null Tag 2147483651]], time_index: 0, primary_key: [2147483652, 2147483651], region_id: 4402341478400(1025, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.156331Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 0
2024-08-28T16:27:45.156425Z DEBUG mito2::region::opener: Create region 4402341478400(1025, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.156473Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure b73727f0-0673-4b7e-9c5c-0dc823bfe1dc, step_keys: ["procedure/b73727f0-0673-4b7e-9c5c-0dc823bfe1dc/0000000000.step", "procedure/b73727f0-0673-4b7e-9c5c-0dc823bfe1dc/0000000001.step"], finish_keys: ["procedure/b73727f0-0673-4b7e-9c5c-0dc823bfe1dc/0000000002.commit"]
2024-08-28T16:27:45.156509Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.156555Z  INFO mito2::worker::handle_create: A new region created, worker: 11, region: RegionMetadata { column_metadatas: [[schema String not null Tag 0], [name String not null Tag 1], [engine String not null Tag 2], [script String not null Field 3], [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 4], [gmt_modified TimestampMillisecond not null Field 5]], time_index: 4, primary_key: [0, 1, 2], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.156648Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-b73727f0-0673-4b7e-9c5c-0dc823bfe1dc exits
2024-08-28T16:27:45.156724Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4406636445696")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.156781Z  INFO operator::insert: Table `greptime.public.logs1` does not exist, try creating table
2024-08-28T16:27:45.156757Z  INFO create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1025 is created via procedure_id ProcedureId(b73727f0-0673-4b7e-9c5c-0dc823bfe1dc)
2024-08-28T16:27:45.156895Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4402341478400(1025, 0) is registered to engine mito
2024-08-28T16:27:45.157090Z  INFO create_table_inner: operator::statement::ddl: Successfully created table 'greptime.greptime_private.pipelines' with table id 1025
2024-08-28T16:27:45.157244Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-6900ed87-1bac-4dd2-897b-7fe1c99fa1bb once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.157274Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.157279Z DEBUG create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "logs1", desc: "Created on insertion", column_defs: [ColumnDef { name: "id1", data_type: Int32, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "id2", data_type: Int32, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "type", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "log", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "logger", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "time", data_type: TimestampNanosecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "time", primary_keys: [], create_if_not_exists: true, table_options: {"append_mode": "true"}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "logs1", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [id1 Int32 null, id2 Int32 null, type String null, log String null, logger String null, time TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(5), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 6, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"append_mode": "true"} }, created_on: 2024-08-28T16:27:45.157199955Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.157738Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-c9f6f453-9f1f-488b-a24f-733a098366c7 starts
2024-08-28T16:27:45.157771Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Found new columns [[idc String null Tag 2], [instance String null Tag 3]] to add to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.157878Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 0
2024-08-28T16:27:45.157931Z DEBUG mito2::region::opener: Create region 4402341478400(1025, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [2147483651], segment_row_count: 256 } }, memtable: Some(PartitionTree(PartitionTreeOptions { index_max_keys_per_shard: 8192, data_freeze_threshold: 131072, fork_dictionary_bytes: 512.0MiB })), merge_mode: None }
2024-08-28T16:27:45.157984Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1026
2024-08-28T16:27:45.158025Z  INFO mito2::worker::handle_alter: Try to alter region: 4402341478400(1025, 0), request: RegionAlterRequest { schema_version: 0, kind: AddColumns { columns: [AddColumn { column_metadata: [idc String null Tag 2], location: None }, AddColumn { column_metadata: [instance String null Tag 3], location: None }] } }
2024-08-28T16:27:45.158020Z  INFO mito2::worker::handle_create: A new region created, worker: 11, region: RegionMetadata { column_metadatas: [[greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 0], [greptime_value Float64 null Field 1], [__table_id UInt32 not null Tag 2147483652], [__tsid UInt64 not null Tag 2147483651]], time_index: 0, primary_key: [2147483652, 2147483651], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.158086Z  INFO mito2::worker::handle_alter: Try to alter region 4402341478400(1025, 0) from version 0 to 0
2024-08-28T16:27:45.158077Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-c9f6f453-9f1f-488b-a24f-733a098366c7 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.158201Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Created physical metric region 4402341478400(1025, 0)
2024-08-28T16:27:45.158301Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4402341478400(1025, 0) is registered to engine metric
2024-08-28T16:27:45.158367Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 1
2024-08-28T16:27:45.158443Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([1, 2]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.158752Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.158818Z  INFO pipeline::manager::pipeline_operator: Created pipelines table greptime.greptime_private.pipelines with table id 1025.
2024-08-28T16:27:45.159054Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1025
2024-08-28T16:27:45.159176Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-6900ed87-1bac-4dd2-897b-7fe1c99fa1bb once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.159381Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-02d81ef8-f0ba-499e-888f-02d2ad1bc9f4 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.159391Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-6900ed87-1bac-4dd2-897b-7fe1c99fa1bb done
2024-08-28T16:27:45.159506Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 1
2024-08-28T16:27:45.159655Z  INFO mito2::worker::handle_manifest: Region 4402341478400(1025, 0) is altered, schema version is 1
2024-08-28T16:27:45.159829Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 6900ed87-1bac-4dd2-897b-7fe1c99fa1bb, step_keys: ["procedure/6900ed87-1bac-4dd2-897b-7fe1c99fa1bb/0000000000.step", "procedure/6900ed87-1bac-4dd2-897b-7fe1c99fa1bb/0000000001.step"], finish_keys: ["procedure/6900ed87-1bac-4dd2-897b-7fe1c99fa1bb/0000000002.commit"]
2024-08-28T16:27:45.159887Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.159963Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1026/1026_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.159936Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4406636445696_aWRj")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.159941Z  INFO create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1025 is created via procedure_id ProcedureId(6900ed87-1bac-4dd2-897b-7fe1c99fa1bb)
2024-08-28T16:27:45.160120Z  INFO create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.scripts' with table id 1025
2024-08-28T16:27:45.160205Z DEBUG pipeline::etl: processors_required_original_keys: ["line"]
2024-08-28T16:27:45.160245Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.160251Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-6900ed87-1bac-4dd2-897b-7fe1c99fa1bb exits
2024-08-28T16:27:45.160280Z DEBUG pipeline::etl: processors_required_keys: ["line", "ts"]
2024-08-28T16:27:45.160321Z DEBUG pipeline::etl: processors_output_keys: ["content", "ts"]
2024-08-28T16:27:45.160322Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1026/1026_0000000000/manifest/
2024-08-28T16:27:45.160358Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1025
2024-08-28T16:27:45.160395Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1026/1026_0000000000/, region_id: 4406636445696(1026, 0)
2024-08-28T16:27:45.160410Z DEBUG pipeline::etl: required_keys: ["line"]
2024-08-28T16:27:45.160438Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-02d81ef8-f0ba-499e-888f-02d2ad1bc9f4 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.160484Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1026/1026_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[id1 Int32 null Field 0], [id2 Int32 null Field 1], [type String null Field 2], [log String null Field 3], [logger String null Field 4], [time TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 5]], time_index: 5, primary_key: [], region_id: 4406636445696(1026, 0), schema_version: 0 }
2024-08-28T16:27:45.160592Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-02d81ef8-f0ba-499e-888f-02d2ad1bc9f4 done
2024-08-28T16:27:45.160581Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1026/1026_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[id1 Int32 null Field 0], [id2 Int32 null Field 1], [type String null Field 2], [log String null Field 3], [logger String null Field 4], [time TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 5]], time_index: 5, primary_key: [], region_id: 4406636445696(1026, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.160817Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.160882Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 02d81ef8-f0ba-499e-888f-02d2ad1bc9f4, step_keys: ["procedure/02d81ef8-f0ba-499e-888f-02d2ad1bc9f4/0000000000.step", "procedure/02d81ef8-f0ba-499e-888f-02d2ad1bc9f4/0000000001.step"], finish_keys: ["procedure/02d81ef8-f0ba-499e-888f-02d2ad1bc9f4/0000000002.commit"]
2024-08-28T16:27:45.161152Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-02d81ef8-f0ba-499e-888f-02d2ad1bc9f4 exits
2024-08-28T16:27:45.161139Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1025 is created via procedure_id ProcedureId(02d81ef8-f0ba-499e-888f-02d2ad1bc9f4)
2024-08-28T16:27:45.161408Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4406636445696_aW5zdGFuY2U")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.161471Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.greptime_physical_table' with table id 1025
test integration_http_file_test::test_http_auth ... ok
2024-08-28T16:27:45.161689Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.161747Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts: operator::insert: Successfully created table greptime.public.greptime_physical_table
2024-08-28T16:27:45.162009Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 1, num_rows: 0, num_batches: 0, scan_cost: 73.438µs }
2024-08-28T16:27:45.162136Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 335.095µs
2024-08-28T16:27:45.162217Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 253.552µs, build_parts_cost: 87.459µs, build_reader_cost: 335.095µs, scan_cost: 7.243µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 833.214µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 307.888µs
2024-08-28T16:27:45.162280Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.162286Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4406636445696(1026, 0), memtable_id: 0
2024-08-28T16:27:45.162332Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 248.645µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 234.176µs }
2024-08-28T16:27:45.162339Z DEBUG mito2::region::opener: Create region 4406636445696(1026, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: true, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.162415Z  INFO mito2::worker::handle_create: A new region created, worker: 12, region: RegionMetadata { column_metadatas: [[id1 Int32 null Field 0], [id2 Int32 null Field 1], [type String null Field 2], [log String null Field 3], [logger String null Field 4], [time TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 5]], time_index: 5, primary_key: [], region_id: 4406636445696(1026, 0), schema_version: 0 }
2024-08-28T16:27:45.162644Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4406636445696(1026, 0) is registered to engine mito
2024-08-28T16:27:45.162870Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-c9f6f453-9f1f-488b-a24f-733a098366c7 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.163083Z  INFO pipeline::manager::table: Insert pipeline success, name: "test", table: "greptime.greptime_private.pipelines", output: Output { data: OutputData::AffectedRows(1), meta: OutputMeta { plan: None, cost: 0 } }
2024-08-28T16:27:45.163226Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Create region 4406636445696(1026, 0) leads to adding columns [[idc String null Tag 2], [instance String null Tag 3]] to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.163431Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4406636445696")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.163707Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.163552Z DEBUG remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_logical_tables:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateLogicalTables([CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "metric2", desc: "Created on insertion", column_defs: [ColumnDef { name: "greptime_timestamp", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "greptime_value", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "instance", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "idc", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }], time_index: "greptime_timestamp", primary_keys: ["instance", "idc"], create_if_not_exists: true, table_options: {"on_physical_table": "greptime_physical_table"}, table_id: None, engine: "metric" }, partitions: [], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "metric2", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, greptime_value Float64 null, instance String null, idc String null], timestamp_index: Some(0), version: 0 }, primary_key_indices: [2, 3], value_indices: [], engine: "metric", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"on_physical_table": "greptime_physical_table"} }, created_on: 2024-08-28T16:27:45.163242761Z, partition_key_indices: [] }, table_type: Base } }, CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "metric3", desc: "Created on insertion", column_defs: [ColumnDef { name: "greptime_timestamp", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "greptime_value", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "idc", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "app", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }], time_index: "greptime_timestamp", primary_keys: ["idc", "app"], create_if_not_exists: true, table_options: {"on_physical_table": "greptime_physical_table"}, table_id: None, engine: "metric" }, partitions: [], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "metric3", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, greptime_value Float64 null, idc String null, app String null], timestamp_index: Some(0), version: 0 }, primary_key_indices: [2, 3], value_indices: [], engine: "metric", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"on_physical_table": "greptime_physical_table"} }, created_on: 2024-08-28T16:27:45.163313126Z, partition_key_indices: [] }, table_type: Base } }, CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "metric1", desc: "Created on insertion", column_defs: [ColumnDef { name: "greptime_timestamp", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "greptime_value", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "job", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }], time_index: "greptime_timestamp", primary_keys: ["job"], create_if_not_exists: true, table_options: {"on_physical_table": "greptime_physical_table"}, table_id: None, engine: "metric" }, partitions: [], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "metric1", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [greptime_timestamp TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, greptime_value Float64 null, job String null], timestamp_index: Some(0), version: 0 }, primary_key_indices: [2], value_indices: [], engine: "metric", next_column_id: 3, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"on_physical_table": "greptime_physical_table"} }, created_on: 2024-08-28T16:27:45.163361119Z, partition_key_indices: [] }, table_type: Base } }])
2024-08-28T16:27:45.164027Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 2, num_pruned_series: 2, num_rows: 0, num_batches: 0, scan_cost: 69.351µs }
2024-08-28T16:27:45.164122Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1026
2024-08-28T16:27:45.164164Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 341.92µs
2024-08-28T16:27:45.164226Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-c9f6f453-9f1f-488b-a24f-733a098366c7 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.164259Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 219.972µs, build_parts_cost: 87.472µs, build_reader_cost: 341.92µs, scan_cost: 17.913µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 840.132µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 293.502µs
2024-08-28T16:27:45.164367Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.164396Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateLogicalTables-85c90059-4936-4694-bf14-ab71203f07c5 starts
2024-08-28T16:27:45.164426Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 255.903µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 238.281µs }
2024-08-28T16:27:45.164447Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-c9f6f453-9f1f-488b-a24f-733a098366c7 done
2024-08-28T16:27:45.164698Z  INFO create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1026 is created via procedure_id ProcedureId(c9f6f453-9f1f-488b-a24f-733a098366c7)
2024-08-28T16:27:45.164760Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure c9f6f453-9f1f-488b-a24f-733a098366c7, step_keys: ["procedure/c9f6f453-9f1f-488b-a24f-733a098366c7/0000000000.step", "procedure/c9f6f453-9f1f-488b-a24f-733a098366c7/0000000001.step"], finish_keys: ["procedure/c9f6f453-9f1f-488b-a24f-733a098366c7/0000000002.commit"]
2024-08-28T16:27:45.164769Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:42983
2024-08-28T16:27:45.164823Z  INFO create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.logs1' with table id 1026
2024-08-28T16:27:45.164844Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateLogicalTables-85c90059-4936-4694-bf14-ab71203f07c5 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.164987Z  INFO operator::insert: Successfully created table greptime.public.logs1 with options: [("append_mode", "true")]
2024-08-28T16:27:45.165041Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-c9f6f453-9f1f-488b-a24f-733a098366c7 exits
2024-08-28T16:27:45.165738Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4406636445696_Z3JlcHRpbWVfdGltZXN0YW1w")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.166175Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.166175Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0, 1, 2, 3, 4, 5]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.166251Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4406636445696")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.166516Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.166532Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.166620Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 3, num_pruned_series: 3, num_rows: 0, num_batches: 0, scan_cost: 97.286µs }
2024-08-28T16:27:45.166799Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 451.361µs
2024-08-28T16:27:45.166907Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.166925Z  INFO operator::insert: Table `greptime.public.logs1` does not exist, try creating table
2024-08-28T16:27:45.166924Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 314.024µs, build_parts_cost: 130.107µs, build_reader_cost: 451.361µs, scan_cost: 6.822µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.202593ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 462.315µs
2024-08-28T16:27:45.167026Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.167103Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Found new columns [[idc String null Tag 2], [instance String null Tag 3]] to add to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.167107Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 336.275µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 312.325µs }
2024-08-28T16:27:45.167279Z  INFO mito2::worker::handle_alter: Try to alter region: 4402341478400(1025, 0), request: RegionAlterRequest { schema_version: 0, kind: AddColumns { columns: [AddColumn { column_metadata: [idc String null Tag 2], location: None }, AddColumn { column_metadata: [instance String null Tag 3], location: None }] } }
2024-08-28T16:27:45.167341Z  INFO mito2::worker::handle_alter: Try to alter region 4402341478400(1025, 0) from version 0 to 0
2024-08-28T16:27:45.167661Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 1
2024-08-28T16:27:45.167436Z DEBUG servers::http::error_result: Failed to handle HTTP request, err: 0: Execute gRPC request error, at src/frontend/src/instance/log_handler.rs:94:14
1: Failed to insert data, at src/operator/src/insert.rs:334:26
2: External error, at src/frontend/src/instance/standalone.rs:87:14
3: Operation to region server failed, at src/frontend/src/instance/standalone.rs:69:14
4: Execute gRPC request error, at src/datanode/src/region_server.rs:346:18
5: Failed to handle request for region 4406636445696(1026, 0), at src/datanode/src/region_server.rs:703:14
6: Invalid request to region 4406636445696(1026, 0), reason: column time is not null but input has null, at src/mito2/src/request.rs:195:17
2024-08-28T16:27:45.167713Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.167802Z DEBUG create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "logs1", desc: "Created on insertion", column_defs: [ColumnDef { name: "content", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampNanosecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: [], create_if_not_exists: true, table_options: {"append_mode": "true"}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "logs1", desc: Some("Created on insertion"), catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [content String null, ts TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(1), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 2, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {"append_mode": "true"} }, created_on: 2024-08-28T16:27:45.167615081Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.168429Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-3212d9c5-6b11-47ea-97f1-f4287a6672ec starts
2024-08-28T16:27:45.168725Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1026
2024-08-28T16:27:45.168735Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4406636445696_Z3JlcHRpbWVfdmFsdWU")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.168827Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-3212d9c5-6b11-47ea-97f1-f4287a6672ec once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.168998Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.169190Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 1
2024-08-28T16:27:45.169288Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 4, num_pruned_series: 4, num_rows: 0, num_batches: 0, scan_cost: 69.61µs }
2024-08-28T16:27:45.169365Z  INFO mito2::worker::handle_manifest: Region 4402341478400(1025, 0) is altered, schema version is 1
2024-08-28T16:27:45.169429Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 313.962µs
2024-08-28T16:27:45.169541Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 223.224µs, build_parts_cost: 87.123µs, build_reader_cost: 313.962µs, scan_cost: 7.441µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 817.8µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 282.68µs
2024-08-28T16:27:45.169611Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.169657Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 249.389µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 231.99µs }
2024-08-28T16:27:45.169693Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4406636445696_aWRj")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.170069Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.170770Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.170800Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Created new logical region 4406636445696(1026, 0) on physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.170847Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1026/1026_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.171203Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1026/1026_0000000000/manifest/
2024-08-28T16:27:45.171213Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4406636445696(1026, 0) is registered to engine metric
2024-08-28T16:27:45.171278Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1026/1026_0000000000/, region_id: 4406636445696(1026, 0)
2024-08-28T16:27:45.171258Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 0ns, first_consume: 0ns, do_get_cost: 3.513822ms
2024-08-28T16:27:45.171362Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1026/1026_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[content String null Field 0], [ts TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4406636445696(1026, 0), schema_version: 0 }
2024-08-28T16:27:45.171461Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1026/1026_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[content String null Field 0], [ts TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4406636445696(1026, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.171708Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.171843Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4406636445696_aW5zdGFuY2U")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.172165Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.172122Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4410931412992")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.172479Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 1, num_rows: 0, num_batches: 0, scan_cost: 55.544µs }
2024-08-28T16:27:45.172627Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 341.21µs
2024-08-28T16:27:45.172715Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 259.581µs, build_parts_cost: 99.821µs, build_reader_cost: 341.21µs, scan_cost: 7.08µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 890.161µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 333.115µs
2024-08-28T16:27:45.172780Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.172831Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 259.672µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 248.944µs }
2024-08-28T16:27:45.173082Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.173616Z  INFO script::table: Found 0 scripts in greptime.public.scripts
2024-08-28T16:27:45.173680Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4406636445696(1026, 0), memtable_id: 0
2024-08-28T16:27:45.173712Z  INFO frontend::script::python: Created scripts table greptime.public.scripts.
2024-08-28T16:27:45.173710Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 5, num_pruned_series: 5, num_rows: 0, num_batches: 0, scan_cost: 158.766µs }
2024-08-28T16:27:45.173723Z DEBUG mito2::region::opener: Create region 4406636445696(1026, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: true, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.173788Z  INFO mito2::worker::handle_create: A new region created, worker: 12, region: RegionMetadata { column_metadatas: [[content String null Field 0], [ts TimestampNanosecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4406636445696(1026, 0), schema_version: 0 }
2024-08-28T16:27:45.173924Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 599.01µs
2024-08-28T16:27:45.173967Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4406636445696(1026, 0) is registered to engine mito
2024-08-28T16:27:45.174009Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Create region 4406636445696(1026, 0) leads to adding columns [[idc String null Tag 2], [instance String null Tag 3]] to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.174073Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 737.196µs, build_parts_cost: 194.702µs, build_reader_cost: 599.01µs, scan_cost: 11.004µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 2.027205ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.032114ms
2024-08-28T16:27:45.174162Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-3212d9c5-6b11-47ea-97f1-f4287a6672ec once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.174196Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.174291Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 455.6µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 433.606µs }
2024-08-28T16:27:45.174326Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4406636445696")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.174785Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.175117Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1026
2024-08-28T16:27:45.175200Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-3212d9c5-6b11-47ea-97f1-f4287a6672ec once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.175264Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 2, num_pruned_series: 2, num_rows: 0, num_batches: 0, scan_cost: 86.873µs }
2024-08-28T16:27:45.175310Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-3212d9c5-6b11-47ea-97f1-f4287a6672ec done
2024-08-28T16:27:45.175467Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 466.371µs
2024-08-28T16:27:45.175463Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Found new columns [[app String null Tag 0]] to add to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.175537Z  INFO create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1026 is created via procedure_id ProcedureId(3212d9c5-6b11-47ea-97f1-f4287a6672ec)
2024-08-28T16:27:45.175573Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 3212d9c5-6b11-47ea-97f1-f4287a6672ec, step_keys: ["procedure/3212d9c5-6b11-47ea-97f1-f4287a6672ec/0000000000.step", "procedure/3212d9c5-6b11-47ea-97f1-f4287a6672ec/0000000001.step"], finish_keys: ["procedure/3212d9c5-6b11-47ea-97f1-f4287a6672ec/0000000002.commit"]
2024-08-28T16:27:45.175627Z  INFO create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.logs1' with table id 1026
2024-08-28T16:27:45.175655Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 386.886µs, build_parts_cost: 163.151µs, build_reader_cost: 466.371µs, scan_cost: 7.244µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.327978ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 485.994µs
2024-08-28T16:27:45.175766Z  INFO operator::insert: Successfully created table greptime.public.logs1 with options: [("append_mode", "true")]
2024-08-28T16:27:45.175792Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.175804Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-3212d9c5-6b11-47ea-97f1-f4287a6672ec exits
2024-08-28T16:27:45.175840Z  INFO mito2::worker::handle_alter: Try to alter region: 4402341478400(1025, 0), request: RegionAlterRequest { schema_version: 1, kind: AddColumns { columns: [AddColumn { column_metadata: [app String null Tag 4], location: None }] } }
2024-08-28T16:27:45.175866Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 360.35µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 344.669µs }
2024-08-28T16:27:45.175952Z  INFO mito2::worker::handle_alter: Try to alter region 4402341478400(1025, 0) from version 1 to 1
2024-08-28T16:27:45.176422Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 2
2024-08-28T16:27:45.177558Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4406636445696_Z3JlcHRpbWVfdGltZXN0YW1w")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.177907Z  INFO script::manager: Compiled and cached script: test
2024-08-28T16:27:45.177990Z  INFO script::manager: Script register as UDF: test
2024-08-28T16:27:45.178031Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.178387Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 2
2024-08-28T16:27:45.178447Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 3, num_pruned_series: 3, num_rows: 0, num_batches: 0, scan_cost: 85.557µs }
2024-08-28T16:27:45.178622Z  INFO mito2::worker::handle_manifest: Region 4402341478400(1025, 0) is altered, schema version is 2
2024-08-28T16:27:45.178620Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 411.425µs
2024-08-28T16:27:45.178734Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 340.871µs, build_parts_cost: 134.933µs, build_reader_cost: 411.425µs, scan_cost: 6.593µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.197828ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 495.96µs
2024-08-28T16:27:45.178838Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.178913Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 322.463µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 308.54µs }
2024-08-28T16:27:45.179089Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4410931412992_YXBw")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.179653Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.180066Z  INFO script::table: Inserted script: test into scripts table: greptime.public.scripts, output: Output { data: OutputData::AffectedRows(1), meta: OutputMeta { plan: None, cost: 0 } }.
2024-08-28T16:27:45.180184Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 5, num_pruned_series: 5, num_rows: 0, num_batches: 0, scan_cost: 122.469µs }
2024-08-28T16:27:45.180377Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 512.871µs
2024-08-28T16:27:45.180468Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 479.312µs, build_parts_cost: 176.236µs, build_reader_cost: 512.871µs, scan_cost: 5.179µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.433098ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 588.797µs
2024-08-28T16:27:45.180555Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.180609Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 394.24µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 381.085µs }
2024-08-28T16:27:45.180706Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4406636445696_Z3JlcHRpbWVfdmFsdWU")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.180928Z  INFO servers::http::test_helpers: Listening on 127.0.0.1:32791
2024-08-28T16:27:45.181060Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.181436Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 4, num_pruned_series: 4, num_rows: 0, num_batches: 0, scan_cost: 87.058µs }
2024-08-28T16:27:45.181587Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 359.855µs
2024-08-28T16:27:45.181700Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 300.872µs, build_parts_cost: 127.524µs, build_reader_cost: 359.855µs, scan_cost: 5.595µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.012167ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 375.502µs
2024-08-28T16:27:45.181712Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Create region 4410931412992(1027, 0) leads to adding columns [[app String null Tag 4]] to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.181826Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.181873Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4410931412992")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.181921Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 289.424µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 277.663µs }
2024-08-28T16:27:45.182155Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.182444Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 6, num_pruned_series: 6, num_rows: 0, num_batches: 0, scan_cost: 76.784µs }
2024-08-28T16:27:45.182575Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 303.169µs
2024-08-28T16:27:45.182672Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 219.059µs, build_parts_cost: 89.986µs, build_reader_cost: 303.169µs, scan_cost: 4.782µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 813.98µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 297.363µs
2024-08-28T16:27:45.182737Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.182786Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 247.021µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 234.213µs }
2024-08-28T16:27:45.183462Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Created new logical region 4406636445696(1026, 0) on physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.183820Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4406636445696(1026, 0) is registered to engine metric
2024-08-28T16:27:45.184012Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4410931412992_Z3JlcHRpbWVfdGltZXN0YW1w")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.184227Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4410931412992")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.184294Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.184576Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.184596Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 7, num_pruned_series: 7, num_rows: 0, num_batches: 0, scan_cost: 86.492µs }
2024-08-28T16:27:45.184740Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 330.856µs
2024-08-28T16:27:45.184823Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 236.796µs, build_parts_cost: 87.409µs, build_reader_cost: 330.856µs, scan_cost: 4.306µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 825.267µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 297.663µs
2024-08-28T16:27:45.184889Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.184937Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 5, num_pruned_series: 5, num_rows: 0, num_batches: 0, scan_cost: 90.286µs }
2024-08-28T16:27:45.184940Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 271.441µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 261.813µs }
2024-08-28T16:27:45.185091Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 368.282µs
2024-08-28T16:27:45.185196Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 292.929µs, build_parts_cost: 113.463µs, build_reader_cost: 368.282µs, scan_cost: 5.213µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 985.706µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 369.485µs
2024-08-28T16:27:45.185286Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.185364Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 297.701µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 281.166µs }
2024-08-28T16:27:45.186233Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Found new columns [[app String null Tag 0]] to add to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.186254Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4410931412992_Z3JlcHRpbWVfdmFsdWU")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.186519Z  INFO mito2::worker::handle_alter: Try to alter region: 4402341478400(1025, 0), request: RegionAlterRequest { schema_version: 1, kind: AddColumns { columns: [AddColumn { column_metadata: [app String null Tag 4], location: None }] } }
2024-08-28T16:27:45.186566Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.186614Z  INFO mito2::worker::handle_alter: Try to alter region 4402341478400(1025, 0) from version 1 to 1
2024-08-28T16:27:45.186898Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 8, num_pruned_series: 8, num_rows: 0, num_batches: 0, scan_cost: 95.237µs }
2024-08-28T16:27:45.187035Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 330.355µs
2024-08-28T16:27:45.187072Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 2
2024-08-28T16:27:45.187141Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 256.325µs, build_parts_cost: 111.13µs, build_reader_cost: 330.355µs, scan_cost: 26.062µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 906.288µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 331.89µs
2024-08-28T16:27:45.187213Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.187291Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 269.827µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 259.285µs }
2024-08-28T16:27:45.188622Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4410931412992_aWRj")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.188924Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.189039Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 2
2024-08-28T16:27:45.189213Z  INFO mito2::worker::handle_manifest: Region 4402341478400(1025, 0) is altered, schema version is 2
2024-08-28T16:27:45.189244Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 9, num_pruned_series: 9, num_rows: 0, num_batches: 0, scan_cost: 100.605µs }
2024-08-28T16:27:45.189371Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 325.701µs
2024-08-28T16:27:45.189469Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 252.156µs, build_parts_cost: 94.138µs, build_reader_cost: 325.701µs, scan_cost: 5.46µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 861.588µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 319.033µs
2024-08-28T16:27:45.189537Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.189522Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4410931412992_YXBw")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.189588Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 268.342µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 255.431µs }
2024-08-28T16:27:45.189866Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.190215Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 5, num_pruned_series: 5, num_rows: 0, num_batches: 0, scan_cost: 76.968µs }
2024-08-28T16:27:45.190373Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 354.74µs
2024-08-28T16:27:45.190475Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 295.483µs, build_parts_cost: 117.941µs, build_reader_cost: 354.74µs, scan_cost: 5.382µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 972.3µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 364.948µs
2024-08-28T16:27:45.190562Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.190627Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 287.638µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 276.179µs }
2024-08-28T16:27:45.190686Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Created new logical region 4410931412992(1027, 0) on physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.190908Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4410931412992(1027, 0) is registered to engine metric
2024-08-28T16:27:45.191228Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4415226380288")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.191520Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.191862Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 10, num_pruned_series: 10, num_rows: 0, num_batches: 0, scan_cost: 101.82µs }
2024-08-28T16:27:45.191994Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 357.695µs
2024-08-28T16:27:45.192084Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 254.326µs, build_parts_cost: 90.234µs, build_reader_cost: 357.695µs, scan_cost: 4.011µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 870.133µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 306.932µs
2024-08-28T16:27:45.192150Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.192115Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Create region 4410931412992(1027, 0) leads to adding columns [[app String null Tag 4]] to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.192207Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 288.707µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 266.774µs }
2024-08-28T16:27:45.192339Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4410931412992")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.192693Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.192871Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Found new columns [[job String null Tag 2]] to add to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.193065Z  INFO mito2::worker::handle_alter: Try to alter region: 4402341478400(1025, 0), request: RegionAlterRequest { schema_version: 2, kind: AddColumns { columns: [AddColumn { column_metadata: [job String null Tag 5], location: None }] } }
2024-08-28T16:27:45.193082Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 6, num_pruned_series: 6, num_rows: 0, num_batches: 0, scan_cost: 104.864µs }
2024-08-28T16:27:45.193129Z  INFO mito2::worker::handle_alter: Try to alter region 4402341478400(1025, 0) from version 2 to 2
2024-08-28T16:27:45.193259Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 408.312µs
2024-08-28T16:27:45.193399Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 300.624µs, build_parts_cost: 122.049µs, build_reader_cost: 408.312µs, scan_cost: 29.373µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.079857ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 377.761µs
2024-08-28T16:27:45.193483Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 3
2024-08-28T16:27:45.193501Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.193574Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 336.596µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 318.158µs }
2024-08-28T16:27:45.195299Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4410931412992_Z3JlcHRpbWVfdGltZXN0YW1w")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.195405Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 3
2024-08-28T16:27:45.195667Z  INFO mito2::worker::handle_manifest: Region 4402341478400(1025, 0) is altered, schema version is 3
2024-08-28T16:27:45.195694Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.196149Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 7, num_pruned_series: 7, num_rows: 0, num_batches: 0, scan_cost: 123.612µs }
2024-08-28T16:27:45.196122Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4415226380288_am9i")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
test integration_http_file_test::test_pipeline_api ... FAILED
2024-08-28T16:27:45.196334Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 442.572µs
2024-08-28T16:27:45.196460Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 326.7µs, build_parts_cost: 159.824µs, build_reader_cost: 442.572µs, scan_cost: 11.061µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.177855ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 415.796µs
2024-08-28T16:27:45.196570Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.196656Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 368.094µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 353.902µs }
2024-08-28T16:27:45.196685Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.197373Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 10, num_pruned_series: 10, num_rows: 0, num_batches: 0, scan_cost: 208.639µs }
2024-08-28T16:27:45.197628Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 690.438µs
2024-08-28T16:27:45.197783Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 471.908µs, build_parts_cost: 199.585µs, build_reader_cost: 690.438µs, scan_cost: 8.025µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.693359ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 591.239µs
2024-08-28T16:27:45.197916Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.198013Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 556.807µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 529.188µs }
2024-08-28T16:27:45.198873Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4410931412992_Z3JlcHRpbWVfdmFsdWU")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.199262Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.199509Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0, 1]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: true
2024-08-28T16:27:45.199692Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 8, num_pruned_series: 8, num_rows: 0, num_batches: 0, scan_cost: 143.8µs }
2024-08-28T16:27:45.199858Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.199869Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 446.577µs
2024-08-28T16:27:45.199999Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 315.385µs, build_parts_cost: 123.879µs, build_reader_cost: 446.577µs, scan_cost: 35.008µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.145074ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 411.387µs
2024-08-28T16:27:45.200126Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.200211Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 375.335µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 362.578µs }
2024-08-28T16:27:45.200289Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.200401Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Create region 4415226380288(1028, 0) leads to adding columns [[job String null Tag 5]] to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.200620Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4415226380288")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.200965Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.201062Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.201405Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 11, num_pruned_series: 11, num_rows: 0, num_batches: 0, scan_cost: 164.747µs }
2024-08-28T16:27:45.201251Z DEBUG read_from_region: mito2::read::unordered_scan: Parallel scan is enabled, parallelism: 13, 1 mem_ranges, 0 file_ranges, mems_per_part: 1, ranges_per_part: 1
2024-08-28T16:27:45.201576Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 456.806µs
2024-08-28T16:27:45.201677Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 291.613µs, build_parts_cost: 120.912µs, build_reader_cost: 456.806µs, scan_cost: 5.615µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.074764ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 364.594µs
2024-08-28T16:27:45.201766Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.202155Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 389.687µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 375.468µs }
2024-08-28T16:27:45.202511Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4410931412992_aWRj")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.202950Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.203426Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 9, num_pruned_series: 9, num_rows: 0, num_batches: 0, scan_cost: 150.241µs }
2024-08-28T16:27:45.203398Z DEBUG read_from_region: mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 2, num_batches: 1, scan_cost: 470.231µs }
2024-08-28T16:27:45.203624Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 487.268µs
2024-08-28T16:27:45.203773Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 385.855µs, build_parts_cost: 145.341µs, build_reader_cost: 487.268µs, scan_cost: 7.027µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.296377ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 469.471µs
2024-08-28T16:27:45.203692Z DEBUG read_from_region: mito2::read::unordered_scan: Unordered scan partition 0 finished, region_id: 4406636445696(1026, 0), metrics: ScannerMetrics { prepare_scan_cost: 1.581536ms, build_parts_cost: 580.548µs, build_reader_cost: 117.035µs, scan_cost: 478.676µs, convert_cost: 31.615µs, yield_cost: 82.164µs, total_cost: 4.192866ms, num_batches: 1, num_rows: 2, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, reader_metrics: ReaderMetrics { filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 }, build_cost: 0ns, scan_cost: 0ns, num_record_batches: 0, num_batches: 0, num_rows: 0 }, first_poll: 1.656389ms
2024-08-28T16:27:45.203838Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.203886Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 407.777µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 384.448µs }
2024-08-28T16:27:45.204024Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4415226380288_Z3JlcHRpbWVfdGltZXN0YW1w")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.204358Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.204772Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 12, num_pruned_series: 12, num_rows: 0, num_batches: 0, scan_cost: 150.401µs }
2024-08-28T16:27:45.204933Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 428.957µs
2024-08-28T16:27:45.204948Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 3.072687ms, first_consume: 7.655256ms, do_get_cost: 4.54488ms
2024-08-28T16:27:45.205088Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Created new logical region 4410931412992(1027, 0) on physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.205076Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 286.953µs, build_parts_cost: 111.834µs, build_reader_cost: 428.957µs, scan_cost: 28.465µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.065535ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 352.923µs
2024-08-28T16:27:45.205172Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.205237Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 361.378µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 349.69µs }
2024-08-28T16:27:45.205307Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4410931412992(1027, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4410931412992(1027, 0) is registered to engine metric
2024-08-28T16:27:45.205606Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4415226380288")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.205862Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.206172Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 10, num_pruned_series: 10, num_rows: 0, num_batches: 0, scan_cost: 114.04µs }
2024-08-28T16:27:45.206293Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 324.879µs
2024-08-28T16:27:45.206367Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 215.22µs, build_parts_cost: 81.231µs, build_reader_cost: 324.879µs, scan_cost: 3.595µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 774.271µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 270.889µs
2024-08-28T16:27:45.206432Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.206479Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 271.69µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 263.138µs }
2024-08-28T16:27:45.206979Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4415226380288_Z3JlcHRpbWVfdmFsdWU")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.207187Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Found new columns [[job String null Tag 2]] to add to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.207329Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.207361Z  INFO mito2::worker::handle_alter: Try to alter region: 4402341478400(1025, 0), request: RegionAlterRequest { schema_version: 2, kind: AddColumns { columns: [AddColumn { column_metadata: [job String null Tag 5], location: None }] } }
2024-08-28T16:27:45.207418Z  INFO mito2::worker::handle_alter: Try to alter region 4402341478400(1025, 0) from version 2 to 2
2024-08-28T16:27:45.207758Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 13, num_pruned_series: 13, num_rows: 0, num_batches: 0, scan_cost: 172.146µs }
2024-08-28T16:27:45.207782Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 3
2024-08-28T16:27:45.207937Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 466.285µs
2024-08-28T16:27:45.208049Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 292.32µs, build_parts_cost: 107.514µs, build_reader_cost: 466.285µs, scan_cost: 5.363µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.08735ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 369.748µs
2024-08-28T16:27:45.208138Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.208203Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 395.555µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 384.229µs }
2024-08-28T16:27:45.209829Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Created new logical region 4415226380288(1028, 0) on physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.209904Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 3
2024-08-28T16:27:45.210099Z  INFO mito2::worker::handle_manifest: Region 4402341478400(1025, 0) is altered, schema version is 3
2024-08-28T16:27:45.210106Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4415226380288(1028, 0) is registered to engine metric
2024-08-28T16:27:45.210459Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4415226380288_am9i")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.210553Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateLogicalTables-4af55ee6-0b45-40f9-a5d8-7e28b43d34bc once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.210865Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.211325Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 10, num_pruned_series: 10, num_rows: 0, num_batches: 0, scan_cost: 151.447µs }
2024-08-28T16:27:45.211509Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 476.783µs
2024-08-28T16:27:45.211655Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 345.528µs, build_parts_cost: 126.072µs, build_reader_cost: 476.783µs, scan_cost: 7.041µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.20019ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 431.803µs
2024-08-28T16:27:45.211794Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.211910Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 396.968µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 382.879µs }
2024-08-28T16:27:45.213429Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_logical_tables::update_metadata: Created 3 tables [1026, 1027, 1028] metadata for physical table 1025
2024-08-28T16:27:45.213510Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateLogicalTables-4af55ee6-0b45-40f9-a5d8-7e28b43d34bc once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.213627Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateLogicalTables-4af55ee6-0b45-40f9-a5d8-7e28b43d34bc done
2024-08-28T16:27:45.213961Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 4af55ee6-0b45-40f9-a5d8-7e28b43d34bc, step_keys: ["procedure/4af55ee6-0b45-40f9-a5d8-7e28b43d34bc/0000000000.step", "procedure/4af55ee6-0b45-40f9-a5d8-7e28b43d34bc/0000000001.step"], finish_keys: ["procedure/4af55ee6-0b45-40f9-a5d8-7e28b43d34bc/0000000002.commit"]
2024-08-28T16:27:45.214044Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_logical_tables:DdlManager::submit_ddl_task: common_meta::ddl_manager: 3 logical tables on physical table: 1025 is created via procedure_id ProcedureId(4af55ee6-0b45-40f9-a5d8-7e28b43d34bc)
2024-08-28T16:27:45.214165Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateLogicalTables-4af55ee6-0b45-40f9-a5d8-7e28b43d34bc exits
2024-08-28T16:27:45.214289Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_logical_tables: operator::statement::ddl: Successfully created logical tables: [1026, 1027, 1028]
2024-08-28T16:27:45.214525Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Create region 4415226380288(1028, 0) leads to adding columns [[job String null Tag 5]] to physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.214635Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts: operator::insert: Successfully created logical tables
2024-08-28T16:27:45.214834Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__region_4415226380288")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.215304Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.215873Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 11, num_pruned_series: 11, num_rows: 0, num_batches: 0, scan_cost: 187.122µs }
2024-08-28T16:27:45.216084Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 583.646µs
2024-08-28T16:27:45.216171Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 403.622µs, build_parts_cost: 155.409µs, build_reader_cost: 583.646µs, scan_cost: 6.689µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 1.374646ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 500.997µs
2024-08-28T16:27:45.216236Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.216282Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 484.082µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 470.021µs }
2024-08-28T16:27:45.217804Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4415226380288_Z3JlcHRpbWVfdGltZXN0YW1w")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.218139Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.218501Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 12, num_pruned_series: 12, num_rows: 0, num_batches: 0, scan_cost: 125.663µs }
2024-08-28T16:27:45.218633Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 371.605µs
2024-08-28T16:27:45.218711Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 272.037µs, build_parts_cost: 94.759µs, build_reader_cost: 371.605µs, scan_cost: 5.476µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 926.87µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 354.709µs
2024-08-28T16:27:45.218789Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.218838Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 298.963µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 288.119µs }
2024-08-28T16:27:45.220274Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}:scan_to_stream: mito2::read::scan_region: Scan region 4402358255616(1025, 16777216), request: ScanRequest { projection: Some([2]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "k" }), op: Eq, right: Literal(Utf8("__column_4415226380288_Z3JlcHRpbWVfdmFsdWU")) })], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.220587Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::scan_region: Region 4402358255616(1025, 16777216) prune 0 files, cost is 0ns
2024-08-28T16:27:45.220958Z DEBUG mito2::memtable::time_series: Iter 4402358255616(1025, 16777216) time series memtable, metrics: Metrics { total_series: 13, num_pruned_series: 13, num_rows: 0, num_batches: 0, scan_cost: 146.203µs }
2024-08-28T16:27:45.221108Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Build reader region: 4402358255616(1025, 16777216), range_id: 0, from sources, build_reader_cost: 404.256µs
2024-08-28T16:27:45.221193Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::seq_scan: Seq scan finished, region_id: 4402358255616(1025, 16777216), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 263.438µs, build_parts_cost: 89.144µs, build_reader_cost: 404.256µs, scan_cost: 5.8µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 941.497µs, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 336.517µs
2024-08-28T16:27:45.221255Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.221295Z DEBUG LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 339.519µs, num_fetch_by_batches: 0, num_fetch_by_rows: 0, num_input_rows: 0, num_output_rows: 0, fetch_cost: 312.041µs }
2024-08-28T16:27:45.222732Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: metric_engine::engine::create: Created new logical region 4415226380288(1028, 0) on physical region 4402341478400(1025, 0)
2024-08-28T16:27:45.222952Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4415226380288(1028, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4415226380288(1028, 0) is registered to engine metric
2024-08-28T16:27:45.223290Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateLogicalTables-85c90059-4936-4694-bf14-ab71203f07c5 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.225578Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_logical_tables::update_metadata: Created 3 tables [1026, 1027, 1028] metadata for physical table 1025
2024-08-28T16:27:45.225647Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateLogicalTables-85c90059-4936-4694-bf14-ab71203f07c5 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.225742Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateLogicalTables-85c90059-4936-4694-bf14-ab71203f07c5 done
2024-08-28T16:27:45.225959Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_logical_tables:DdlManager::submit_ddl_task: common_meta::ddl_manager: 3 logical tables on physical table: 1025 is created via procedure_id ProcedureId(85c90059-4936-4694-bf14-ab71203f07c5)
2024-08-28T16:27:45.226007Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 85c90059-4936-4694-bf14-ab71203f07c5, step_keys: ["procedure/85c90059-4936-4694-bf14-ab71203f07c5/0000000000.step", "procedure/85c90059-4936-4694-bf14-ab71203f07c5/0000000001.step"], finish_keys: ["procedure/85c90059-4936-4694-bf14-ab71203f07c5/0000000002.commit"]
2024-08-28T16:27:45.226072Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts:create_logical_tables: operator::statement::ddl: Successfully created logical tables: [1026, 1027, 1028]
2024-08-28T16:27:45.226218Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateLogicalTables-85c90059-4936-4694-bf14-ab71203f07c5 exits
2024-08-28T16:27:45.226266Z  INFO remote_write{protocol="prometheus" request_type="remote_write"}:handle_metric_row_inserts: operator::insert: Successfully created logical tables
2024-08-28T16:27:45.230491Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: Some([OrderOption { name: "host", options: SortOptions { descending: true, nulls_first: false } }, OrderOption { name: "ts", options: SortOptions { descending: true, nulls_first: false } }]), limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
test integration_http_file_test::test_status_api ... ok
2024-08-28T16:27:45.231199Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.232596Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.235273Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
test integration_http_file_test::test_plain_text_ingestion ... ok
2024-08-28T16:27:45.248090Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 0ns, first_consume: 0ns, do_get_cost: 16.672258ms
test integration_http_file_test::test_prometheus_remote_write ... ok
2024-08-28T16:27:45.255861Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: None, limit: Some(10), series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.256285Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.257039Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.258131Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
test integration_http_file_test::test_health_api ... ok
2024-08-28T16:27:45.261864Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 458.632µs }
2024-08-28T16:27:45.261904Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 952.324µs
2024-08-28T16:27:45.262670Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.338155ms, build_parts_cost: 324.559µs, build_reader_cost: 952.324µs, scan_cost: 180.352µs, convert_cost: 342.403µs, yield_cost: 54.083µs, total_cost: 6.884332ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.422373ms
2024-08-28T16:27:45.262809Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.262866Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 715.903µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 677.307µs }
2024-08-28T16:27:45.263816Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 5.149607ms, first_consume: 12.503359ms, do_get_cost: 7.319935ms
test integration_http_file_test::test_vm_proto_remote_write ... ok
2024-08-28T16:27:45.280782Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: Some([OrderOption { name: "host", options: SortOptions { descending: true, nulls_first: false } }, OrderOption { name: "ts", options: SortOptions { descending: true, nulls_first: false } }]), limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.281359Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.282576Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.284811Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.286199Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 830.794µs
2024-08-28T16:27:45.286444Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 2, num_pruned_series: 0, num_rows: 2, num_batches: 2, scan_cost: 657.744µs }
2024-08-28T16:27:45.288299Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 4.04636ms, build_parts_cost: 216.7µs, build_reader_cost: 830.794µs, scan_cost: 413.606µs, convert_cost: 583.742µs, yield_cost: 934.518µs, total_cost: 7.578601ms, num_batches: 2, num_rows: 2, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 4.093155ms
2024-08-28T16:27:45.288470Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.288550Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 674.974µs, num_fetch_by_batches: 2, num_fetch_by_rows: 0, num_input_rows: 2, num_output_rows: 2, fetch_cost: 626.244µs }
2024-08-28T16:27:45.288937Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [BinaryExpr(BinaryExpr { left: Column(Column { relation: None, name: "host" }), op: Eq, right: Literal(Utf8("Hangzhou")) })], output_ordering: Some([OrderOption { name: "host", options: SortOptions { descending: true, nulls_first: false } }, OrderOption { name: "ts", options: SortOptions { descending: true, nulls_first: false } }]), limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.289743Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.289823Z  INFO script::python::rspython::copr_impl: Initialized RustPython interpreter 3.11.0alpha (heads/master:9ed513741, Apr 17 2023, 14:03:55) 
[rustc 1.80.0-nightly]
2024-08-28T16:27:45.291401Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.293613Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 3.327064ms, first_consume: 15.941429ms, do_get_cost: 12.576749ms
2024-08-28T16:27:45.294331Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.294616Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([1, 3]), filters: [], output_ordering: None, limit: Some(10), series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.295113Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.295955Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.297655Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.299451Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 195.834µs }
2024-08-28T16:27:45.299514Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 582.876µs
2024-08-28T16:27:45.299967Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 4.33206ms, build_parts_cost: 169.99µs, build_reader_cost: 582.876µs, scan_cost: 171.254µs, convert_cost: 38.03µs, yield_cost: 61.08µs, total_cost: 5.367626ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 4.364488ms
2024-08-28T16:27:45.300129Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.300216Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 372.227µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 321.496µs }
2024-08-28T16:27:45.301538Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.926595ms, first_consume: 9.719711ms, do_get_cost: 6.75435ms
test integration_http_file_test::test_metrics_api ... ok
2024-08-28T16:27:45.306217Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 0ns, first_consume: 0ns, do_get_cost: 16.39931ms
test integration_http_file_test::test_scripts_api ... ok
2024-08-28T16:27:45.337609Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.338255Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.338981Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.340155Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.344620Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 367.847µs }
2024-08-28T16:27:45.344678Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 927.611µs
test integration_http_file_test::test_prometheus_promql_api ... ok
2024-08-28T16:27:45.345415Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.007138ms, build_parts_cost: 266.033µs, build_reader_cost: 927.611µs, scan_cost: 219.611µs, convert_cost: 243.614µs, yield_cost: 71.684µs, total_cost: 7.895566ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.501386ms
2024-08-28T16:27:45.345625Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.345714Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 611.113µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 566.903µs }
2024-08-28T16:27:45.345658Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: Some([OrderOption { name: "host", options: SortOptions { descending: true, nulls_first: false } }, OrderOption { name: "ts", options: SortOptions { descending: true, nulls_first: false } }]), limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.346341Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.346770Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 5.985571ms, first_consume: 11.767943ms, do_get_cost: 5.739814ms
2024-08-28T16:27:45.348260Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.350308Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.351175Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 2, num_pruned_series: 0, num_rows: 2, num_batches: 2, scan_cost: 379.307µs }
2024-08-28T16:27:45.351188Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 671.64µs
2024-08-28T16:27:45.353281Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 4.684503ms, build_parts_cost: 149.85µs, build_reader_cost: 671.64µs, scan_cost: 337.906µs, convert_cost: 350.669µs, yield_cost: 1.202558ms, total_cost: 7.678366ms, num_batches: 2, num_rows: 2, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 4.724369ms
2024-08-28T16:27:45.353438Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.353501Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 613.74µs, num_fetch_by_batches: 2, num_fetch_by_rows: 0, num_input_rows: 2, num_output_rows: 2, fetch_cost: 560.773µs }
2024-08-28T16:27:45.357970Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 3.282044ms, first_consume: 17.309418ms, do_get_cost: 13.993808ms
2024-08-28T16:27:45.381153Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([1, 3]), filters: [], output_ordering: None, limit: Some(1), series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.381811Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.382739Z DEBUG servers::mysql::server: MySQL connection coming from: 127.0.0.1:38222
2024-08-28T16:27:45.383173Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.384570Z DEBUG servers::postgres::server: PostgreSQL client coming from 127.0.0.1:36112
2024-08-28T16:27:45.384651Z DEBUG servers::postgres::server: PostgreSQL client coming from 127.0.0.1:49486
2024-08-28T16:27:45.385021Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.385736Z DEBUG log: executing simple query: SET DATESTYLE='ISO,MDY'    
2024-08-28T16:27:45.385842Z DEBUG log: executing simple query: CREATE TABLE test(b BLOB, ts TIMESTAMP TIME INDEX)    
2024-08-28T16:27:45.386193Z DEBUG servers::mysql::server: MySQL connection coming from: 127.0.0.1:36988
2024-08-28T16:27:45.386333Z DEBUG servers::mysql::server: MySQL connection coming from: 127.0.0.1:60930
2024-08-28T16:27:45.387189Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([1, 3]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 0, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.387627Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.387727Z DEBUG log: executing simple query: SET DATESTYLE='ISO',MDY    
2024-08-28T16:27:45.387626Z DEBUG servers::mysql::server: MySQL connection coming from: 127.0.0.1:47114
2024-08-28T16:27:45.388264Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.388725Z  WARN servers::mysql::handler: Failed to auth err=0: User not found, username: root
2024-08-28T16:27:45.388629Z DEBUG servers::mysql::server: MySQL connection coming from: 127.0.0.1:60160
2024-08-28T16:27:45.388923Z DEBUG servers::postgres::server: PostgreSQL client coming from 127.0.0.1:34690
2024-08-28T16:27:45.388993Z DEBUG servers::postgres::server: PostgreSQL client coming from 127.0.0.1:47452
2024-08-28T16:27:45.389015Z DEBUG servers::postgres::server: PostgreSQL client coming from 127.0.0.1:60212
2024-08-28T16:27:45.388979Z DEBUG do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "test", desc: "", column_defs: [ColumnDef { name: "b", data_type: Binary, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: [], create_if_not_exists: false, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "test", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [b Binary null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(1), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 2, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.388817430Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.389476Z DEBUG log: executing simple query: SET DATESTYLE='ISO,MDY','ISO,MDY'    
2024-08-28T16:27:45.389549Z DEBUG servers::postgres::server: PostgreSQL client coming from 127.0.0.1:42770
2024-08-28T16:27:45.389420Z  WARN servers::mysql::server: Internal error occurred during query exec, server actively close the channel to let client try next time err=0: Internal IO error
1: Custom { kind: PermissionDenied, error: "Authenticate failed, user: \"root\", auth_plugin: \"mysql_native_password\"" }
2024-08-28T16:27:45.389643Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-88ebc1d7-2cc9-4aad-a745-5f8a6e096772 starts
2024-08-28T16:27:45.389599Z DEBUG servers::mysql::server: MySQL connection coming from: 127.0.0.1:47118
2024-08-28T16:27:45.389751Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 420.184µs }
2024-08-28T16:27:45.389778Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 839.274µs
2024-08-28T16:27:45.390101Z DEBUG mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.390142Z DEBUG mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 580.541µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 543.377µs }
2024-08-28T16:27:45.390300Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:45.390359Z  WARN servers::mysql::handler: Failed to auth err=0: Username and password does not match, username: greptime_user
2024-08-28T16:27:45.390448Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-88ebc1d7-2cc9-4aad-a745-5f8a6e096772 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.390532Z DEBUG log: executing simple query: SET time_zone = 'UTC'    
2024-08-28T16:27:45.390499Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.390563Z DEBUG log: executing simple query: create table demo(i bigint, ts timestamp time index, d date, dt datetime)    
2024-08-28T16:27:45.390724Z  WARN servers::mysql::server: Internal error occurred during query exec, server actively close the channel to let client try next time err=0: Internal IO error
1: Custom { kind: PermissionDenied, error: "Authenticate failed, user: \"greptime_user\", auth_plugin: \"mysql_native_password\"" }
2024-08-28T16:27:45.390835Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 5.170457ms, first_consume: 14.827004ms, do_get_cost: 9.634114ms
2024-08-28T16:27:45.390989Z DEBUG log: executing simple query: SET DATESTYLE='ISO,German'    
2024-08-28T16:27:45.391134Z DEBUG servers::postgres::server: PostgreSQL client coming from 127.0.0.1:60216
2024-08-28T16:27:45.391150Z DEBUG servers::mysql::server: MySQL connection coming from: 127.0.0.1:47126
2024-08-28T16:27:45.391784Z DEBUG do_query{protocol="postgres"}:do_query: frontend::instance: Failed to execute query: SET DATESTYLE = 'ISO,German', Table operation error
2024-08-28T16:27:45.392140Z DEBUG do_query{protocol="postgres"}: servers::postgres::handler: Failed to handle postgres query, code: InvalidArguments, db: public, error: 0: Failed to execute query, at /root/work/repo/greptimedb/src/servers/src/query_handler/sql.rs:87:49
1: Table operation error, at src/frontend/src/instance.rs:232:14
2: Invalid SQL, error: Conflicting "datestyle" specifications., at src/operator/src/statement/set.rs:117:10
2024-08-28T16:27:45.392439Z DEBUG servers::postgres::server: PostgreSQL client coming from 127.0.0.1:60228
2024-08-28T16:27:45.392454Z DEBUG log: executing simple query: SHOW VARIABLES time_zone    
2024-08-28T16:27:45.392719Z DEBUG do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "i", data_type: Int64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "d", data_type: Date, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "dt", data_type: Datetime, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: [], create_if_not_exists: false, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [i Int64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, d Date null, dt DateTime null], timestamp_index: Some(1), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.392608734Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.392843Z DEBUG log: executing simple query: SET DATESTYLE='ISO,DMY','ISO,MDY'    
2024-08-28T16:27:45.392993Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.393051Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: Some([OrderOption { name: "host", options: SortOptions { descending: true, nulls_first: false } }, OrderOption { name: "ts", options: SortOptions { descending: true, nulls_first: false } }]), limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.393118Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.393153Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c starts
2024-08-28T16:27:45.393538Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.393576Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:45.393620Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:45.393661Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.393707Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:45.393491Z DEBUG do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "i", data_type: Int64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "d", data_type: Date, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "dt", data_type: Datetime, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: [], create_if_not_exists: false, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [i Int64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}, d Date null, dt DateTime null], timestamp_index: Some(1), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 4, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.393317253Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.393768Z  INFO servers::server: Postgres server is shutdown.
2024-08-28T16:27:45.393772Z DEBUG do_query{protocol="postgres"}:do_query: frontend::instance: Failed to execute query: SET DATESTYLE = 'ISO,DMY', 'ISO,MDY', Table operation error
2024-08-28T16:27:45.393819Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[b Binary null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.393927Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[b Binary null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.394053Z DEBUG do_query{protocol="postgres"}: servers::postgres::handler: Failed to handle postgres query, code: InvalidArguments, db: public, error: 0: Failed to execute query, at /root/work/repo/greptimedb/src/servers/src/query_handler/sql.rs:87:49
1: Table operation error, at src/frontend/src/instance.rs:232:14
2: Invalid SQL, error: Conflicting "datestyle" specifications., at src/operator/src/statement/set.rs:117:10
2024-08-28T16:27:45.394209Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.394298Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-60b642f2-9c67-4f38-bbfc-40a578906ce0 starts
2024-08-28T16:27:45.394423Z DEBUG log: executing simple query: SHOW VARIABLES system_time_zone    
2024-08-28T16:27:45.394574Z DEBUG log: executing simple query: SET DATESTYLE=ISO,ISO,ISO,ISO,ISO,MDY,MDY,MDY,MDY    
2024-08-28T16:27:45.394830Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.394821Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:45.394942Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-60b642f2-9c67-4f38-bbfc-40a578906ce0 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.396273Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.396398Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.396429Z DEBUG log: executing simple query: SET time_zone = 'Asia/Shanghai'    
2024-08-28T16:27:45.396583Z DEBUG log: executing simple query: CREATE TABLE ts_test(ts TIMESTAMP TIME INDEX)    
2024-08-28T16:27:45.396937Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:45.397105Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:45.397132Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:45.397258Z DEBUG log: executing simple query: SHOW VARIABLES time_zone    
2024-08-28T16:27:45.397261Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.397259Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1], [d Date null Field 2], [dt DateTime null Field 3]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.397405Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[b Binary null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.397408Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1], [d Date null Field 2], [dt DateTime null Field 3]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.397747Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.397774Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.397806Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:45.397888Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.398033Z DEBUG log: executing simple query: SHOW VARIABLES system_time_zone    
2024-08-28T16:27:45.398098Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.398246Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-88ebc1d7-2cc9-4aad-a745-5f8a6e096772 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.398237Z DEBUG do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "ts_test", desc: "", column_defs: [ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: [], create_if_not_exists: false, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "ts_test", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(0), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 1, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.398139081Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.398339Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
test integration_sql_file_test::test_postgres_auth ... ok
2024-08-28T16:27:45.398440Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:45.398558Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1], [d Date null Field 2], [dt DateTime null Field 3]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.398663Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-ba4ba173-673c-4c87-b610-1edc0fbe3e37 starts
2024-08-28T16:27:45.398686Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1], [d Date null Field 2], [dt DateTime null Field 3]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.398988Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.399244Z  INFO servers::server: Postgres server is shutdown.
2024-08-28T16:27:45.399229Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:45.399376Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-ba4ba173-673c-4c87-b610-1edc0fbe3e37 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.399552Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 682.563µs
2024-08-28T16:27:45.399757Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 2, num_pruned_series: 0, num_rows: 2, num_batches: 2, scan_cost: 579.151µs }
2024-08-28T16:27:45.399961Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:45.400096Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-88ebc1d7-2cc9-4aad-a745-5f8a6e096772 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.400201Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:45.400284Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.400324Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-88ebc1d7-2cc9-4aad-a745-5f8a6e096772 done
2024-08-28T16:27:45.400433Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1], [d Date null Field 2], [dt DateTime null Field 3]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.400626Z  INFO do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(88ebc1d7-2cc9-4aad-a745-5f8a6e096772)
2024-08-28T16:27:45.400734Z  INFO do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.test' with table id 1024
2024-08-28T16:27:45.400809Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 88ebc1d7-2cc9-4aad-a745-5f8a6e096772, step_keys: ["procedure/88ebc1d7-2cc9-4aad-a745-5f8a6e096772/0000000000.step", "procedure/88ebc1d7-2cc9-4aad-a745-5f8a6e096772/0000000001.step"], finish_keys: ["procedure/88ebc1d7-2cc9-4aad-a745-5f8a6e096772/0000000002.commit"]
2024-08-28T16:27:45.400810Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:45.400873Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:45.400973Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.401158Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1], [d Date null Field 2], [dt DateTime null Field 3]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.401201Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-88ebc1d7-2cc9-4aad-a745-5f8a6e096772 exits
2024-08-28T16:27:45.401197Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.401481Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.401575Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.401571Z DEBUG log: executing simple query: INSERT INTO test VALUES(X'6162636b6c6d2aa954', 0)    
2024-08-28T16:27:45.401686Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:45.401916Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-60b642f2-9c67-4f38-bbfc-40a578906ce0 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.401962Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:45.402014Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:45.402086Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 0]], time_index: 0, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.402139Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 0]], time_index: 0, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.402213Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 0ns, first_consume: 0ns, do_get_cost: 8.892542ms
2024-08-28T16:27:45.402257Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.402548Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:45.402663Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.402847Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c done
2024-08-28T16:27:45.403007Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:45.403077Z  INFO do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c)
2024-08-28T16:27:45.403094Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-60b642f2-9c67-4f38-bbfc-40a578906ce0 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.403183Z  INFO do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:45.403188Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c, step_keys: ["procedure/fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c/0000000000.step", "procedure/fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c/0000000001.step"], finish_keys: ["procedure/fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c/0000000002.commit"]
2024-08-28T16:27:45.403224Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-60b642f2-9c67-4f38-bbfc-40a578906ce0 done
2024-08-28T16:27:45.403427Z  INFO do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(60b642f2-9c67-4f38-bbfc-40a578906ce0)
2024-08-28T16:27:45.403453Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 60b642f2-9c67-4f38-bbfc-40a578906ce0, step_keys: ["procedure/60b642f2-9c67-4f38-bbfc-40a578906ce0/0000000000.step", "procedure/60b642f2-9c67-4f38-bbfc-40a578906ce0/0000000001.step"], finish_keys: ["procedure/60b642f2-9c67-4f38-bbfc-40a578906ce0/0000000002.commit"]
2024-08-28T16:27:45.403483Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-fbe02a1e-a65c-49ca-9ddc-23ec75c05e2c exits
test integration_sql_file_test::test_postgres_timezone ... ok2024-08-28T16:27:45.403542Z  INFO do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024

2024-08-28T16:27:45.403680Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-60b642f2-9c67-4f38-bbfc-40a578906ce0 exits
2024-08-28T16:27:45.403721Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:45.403757Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.403850Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 0]], time_index: 0, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.404053Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:45.404150Z DEBUG log: preparing query s0: INSERT INTO demo VALUES($1, $2, $3, $4)    
2024-08-28T16:27:45.404277Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-ba4ba173-673c-4c87-b610-1edc0fbe3e37 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.404511Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 4.985724ms, build_parts_cost: 312.246µs, build_reader_cost: 682.563µs, scan_cost: 383.401µs, convert_cost: 344.051µs, yield_cost: 4.054808ms, total_cost: 11.497502ms, num_batches: 2, num_rows: 2, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 5.060001ms
2024-08-28T16:27:45.404661Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.404726Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 531.033µs, num_fetch_by_batches: 2, num_fetch_by_rows: 0, num_input_rows: 2, num_output_rows: 2, fetch_cost: 479.792µs }
2024-08-28T16:27:45.405024Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:45.405109Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-ba4ba173-673c-4c87-b610-1edc0fbe3e37 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.405259Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-ba4ba173-673c-4c87-b610-1edc0fbe3e37 done
2024-08-28T16:27:45.405398Z DEBUG log: executing simple query: SELECT b FROM test    
2024-08-28T16:27:45.405460Z  INFO do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(ba4ba173-673c-4c87-b610-1edc0fbe3e37)
2024-08-28T16:27:45.405470Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure ba4ba173-673c-4c87-b610-1edc0fbe3e37, step_keys: ["procedure/ba4ba173-673c-4c87-b610-1edc0fbe3e37/0000000000.step", "procedure/ba4ba173-673c-4c87-b610-1edc0fbe3e37/0000000001.step"], finish_keys: ["procedure/ba4ba173-673c-4c87-b610-1edc0fbe3e37/0000000002.commit"]
2024-08-28T16:27:45.405596Z  INFO do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.ts_test' with table id 1024
2024-08-28T16:27:45.405672Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-ba4ba173-673c-4c87-b610-1edc0fbe3e37 exits
2024-08-28T16:27:45.405896Z  INFO log: create table demo(i bigint, …; rows affected: 0, rows returned: 0, elapsed: 13.137ms

create table demo(
  i bigint,
  ts timestamp time index,
  d date,
  dt datetime
)
  
2024-08-28T16:27:45.406071Z DEBUG log: executing simple query: CREATE TABLE date_test(d date, ts TIMESTAMP TIME INDEX)    
2024-08-28T16:27:45.406277Z DEBUG servers::postgres::server: PostgreSQL client coming from 127.0.0.1:34692
2024-08-28T16:27:45.407376Z DEBUG do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "date_test", desc: "", column_defs: [ColumnDef { name: "d", data_type: Date, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: [], create_if_not_exists: false, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "date_test", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [d Date null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(1), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 2, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.407279204Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.407795Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-7350b6fe-d4fd-4c92-943f-6c374b024455 starts
2024-08-28T16:27:45.407992Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1025
2024-08-28T16:27:45.408059Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-7350b6fe-d4fd-4c92-943f-6c374b024455 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.409425Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.409492Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1025/1025_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.409766Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1025/1025_0000000000/manifest/
2024-08-28T16:27:45.409817Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1025/1025_0000000000/, region_id: 4402341478400(1025, 0)
2024-08-28T16:27:45.409909Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1025/1025_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[d Date null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.409989Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 7.058583ms, first_consume: 20.780516ms, do_get_cost: 13.68456ms
2024-08-28T16:27:45.409997Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1025/1025_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[d Date null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4402341478400(1025, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.410194Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.411800Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4402341478400(1025, 0), memtable_id: 0
2024-08-28T16:27:45.411848Z DEBUG mito2::region::opener: Create region 4402341478400(1025, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.411921Z  INFO mito2::worker::handle_create: A new region created, worker: 11, region: RegionMetadata { column_metadatas: [[d Date null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4402341478400(1025, 0), schema_version: 0 }
2024-08-28T16:27:45.412092Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4402341478400(1025, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4402341478400(1025, 0) is registered to engine mito
2024-08-28T16:27:45.412286Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-7350b6fe-d4fd-4c92-943f-6c374b024455 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.413111Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1025
2024-08-28T16:27:45.413188Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-7350b6fe-d4fd-4c92-943f-6c374b024455 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.413301Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-7350b6fe-d4fd-4c92-943f-6c374b024455 done
2024-08-28T16:27:45.413487Z  INFO do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1025 is created via procedure_id ProcedureId(7350b6fe-d4fd-4c92-943f-6c374b024455)
2024-08-28T16:27:45.413557Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 7350b6fe-d4fd-4c92-943f-6c374b024455, step_keys: ["procedure/7350b6fe-d4fd-4c92-943f-6c374b024455/0000000000.step", "procedure/7350b6fe-d4fd-4c92-943f-6c374b024455/0000000001.step"], finish_keys: ["procedure/7350b6fe-d4fd-4c92-943f-6c374b024455/0000000002.commit"]
2024-08-28T16:27:45.413597Z  INFO do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.date_test' with table id 1025
2024-08-28T16:27:45.413766Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-7350b6fe-d4fd-4c92-943f-6c374b024455 exits
2024-08-28T16:27:45.414055Z DEBUG log: executing statement s0 with parameters: [0, 2015-04-10T00:00:00, 2015-04-10, 2015-04-10T00:00:00]    
2024-08-28T16:27:45.414194Z DEBUG log: executing simple query: CREATE TABLE dt_test(dt datetime, ts TIMESTAMP TIME INDEX)    
2024-08-28T16:27:45.415694Z DEBUG do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "dt_test", desc: "", column_defs: [ColumnDef { name: "dt", data_type: Datetime, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: [], create_if_not_exists: false, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "dt_test", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [dt DateTime null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(1), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 2, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.415596191Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.416049Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-6c87e61d-0977-4b7f-9b27-2834f730efb6 starts
2024-08-28T16:27:45.416190Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.416281Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1026
2024-08-28T16:27:45.416346Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-6c87e61d-0977-4b7f-9b27-2834f730efb6 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.416683Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.417383Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.417927Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.417993Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1026/1026_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.418317Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.418344Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1026/1026_0000000000/manifest/
2024-08-28T16:27:45.418398Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1026/1026_0000000000/, region_id: 4406636445696(1026, 0)
2024-08-28T16:27:45.418463Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1026/1026_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[dt DateTime null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4406636445696(1026, 0), schema_version: 0 }
2024-08-28T16:27:45.418579Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1026/1026_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[dt DateTime null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4406636445696(1026, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.418731Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.419724Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 409.981µs }
2024-08-28T16:27:45.419755Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 613.2µs
2024-08-28T16:27:45.420191Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.022617ms, build_parts_cost: 116.883µs, build_reader_cost: 613.2µs, scan_cost: 295.234µs, convert_cost: 39.54µs, yield_cost: 27.355µs, total_cost: 4.079633ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.038447ms
2024-08-28T16:27:45.420271Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.420331Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 742.651µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 716.167µs }
2024-08-28T16:27:45.420644Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4406636445696(1026, 0), memtable_id: 0
2024-08-28T16:27:45.420728Z DEBUG mito2::region::opener: Create region 4406636445696(1026, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.420853Z  INFO mito2::worker::handle_create: A new region created, worker: 12, region: RegionMetadata { column_metadatas: [[dt DateTime null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4406636445696(1026, 0), schema_version: 0 }
2024-08-28T16:27:45.420924Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.047024ms, first_consume: 7.936359ms, do_get_cost: 5.863905ms
2024-08-28T16:27:45.421192Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4406636445696(1026, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4406636445696(1026, 0) is registered to engine mito
2024-08-28T16:27:45.421519Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-6c87e61d-0977-4b7f-9b27-2834f730efb6 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.422076Z DEBUG log: executing simple query: SET bytea_output='hex'    
2024-08-28T16:27:45.423029Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1026
2024-08-28T16:27:45.423162Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-6c87e61d-0977-4b7f-9b27-2834f730efb6 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.423416Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-6c87e61d-0977-4b7f-9b27-2834f730efb6 done
2024-08-28T16:27:45.423709Z DEBUG log: executing simple query: SELECT b FROM test    
2024-08-28T16:27:45.423781Z  INFO do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1026 is created via procedure_id ProcedureId(6c87e61d-0977-4b7f-9b27-2834f730efb6)
2024-08-28T16:27:45.423971Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 6c87e61d-0977-4b7f-9b27-2834f730efb6, step_keys: ["procedure/6c87e61d-0977-4b7f-9b27-2834f730efb6/0000000000.step", "procedure/6c87e61d-0977-4b7f-9b27-2834f730efb6/0000000001.step"], finish_keys: ["procedure/6c87e61d-0977-4b7f-9b27-2834f730efb6/0000000002.commit"]
2024-08-28T16:27:45.423986Z  INFO do_query{protocol="postgres"}:do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.dt_test' with table id 1026
2024-08-28T16:27:45.424545Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-6c87e61d-0977-4b7f-9b27-2834f730efb6 exits
2024-08-28T16:27:45.424735Z DEBUG log: executing simple query: INSERT INTO ts_test VALUES('1997-12-17 07:37:16.123')    
2024-08-28T16:27:45.424979Z  INFO log: insert into demo values($1, …; rows affected: 1, rows returned: 0, elapsed: 16.425ms

insert into
  demo
values
($1, $2, $3, $4)
  
2024-08-28T16:27:45.425278Z DEBUG log: preparing query s1: SELECT * FROM demo WHERE i = $1    
2024-08-28T16:27:45.425734Z DEBUG sql{protocol="http" request_type="sql"}:do_query: frontend::instance: Failed to execute query: SELECT cpu, ts FROM demo2 WHERE ts > 0, Table operation error
2024-08-28T16:27:45.426609Z  INFO log: SET sql_mode=(SELECT CONCAT(@@sql_mode, ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION')),time_zone='+00:00',NAMES …; rows affected: 0, rows returned: 0, elapsed: 37.426ms

SET
  sql_mode =(
    SELECT
      CONCAT(
        @ @sql_mode,
        ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION'
      )
  ),
  time_zone = '+00:00',
  NAMES utf8mb4 COLLATE utf8mb4_unicode_ci;
  
2024-08-28T16:27:45.427093Z  INFO log: SET sql_mode=(SELECT CONCAT(@@sql_mode, ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION')),time_zone='+00:00',NAMES …; rows affected: 0, rows returned: 0, elapsed: 35.004ms

SET
  sql_mode =(
    SELECT
      CONCAT(
        @ @sql_mode,
        ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION'
      )
  ),
  time_zone = '+00:00',
  NAMES utf8mb4 COLLATE utf8mb4_unicode_ci;
  
2024-08-28T16:27:45.427125Z  INFO log: SET sql_mode=(SELECT CONCAT(@@sql_mode, ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION')),time_zone='+00:00',NAMES …; rows affected: 0, rows returned: 0, elapsed: 37.476ms

SET
  sql_mode =(
    SELECT
      CONCAT(
        @ @sql_mode,
        ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION'
      )
  ),
  time_zone = '+00:00',
  NAMES utf8mb4 COLLATE utf8mb4_unicode_ci;
  
2024-08-28T16:27:45.427691Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([1, 3]), filters: [], output_ordering: None, limit: Some(1), series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.427630Z DEBUG on_query{protocol="mysql"}:mysql::do_query:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "cpu_metrics", desc: "", column_defs: [ColumnDef { name: "hostname", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "environment", data_type: String, is_nullable: true, default_constraint: [], semantic_type: Tag, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "usage_user", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "usage_system", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "usage_idle", data_type: Float64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: ["hostname", "environment"], create_if_not_exists: true, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "cpu_metrics", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [hostname String null, environment String null, usage_user Float64 null, usage_system Float64 null, usage_idle Float64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(5), version: 0 }, primary_key_indices: [0, 1], value_indices: [], engine: "mito", next_column_id: 6, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.427534647Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.427920Z DEBUG servers::mysql::handler: Mysql execute replaced query: create table demo(i bigint, ts timestamp time index default current_timestamp, d date default null, dt datetime default null, b blob default null)
2024-08-28T16:27:45.428084Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-f331452e-a26a-4c32-9983-e896e1200701 starts
2024-08-28T16:27:45.428177Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.428208Z DEBUG servers::mysql::handler: Mysql execute replaced query: create table demo(i bigint, ts timestamp time index)
2024-08-28T16:27:45.428385Z  INFO log: SET time_zone = 'Asia/Shanghai'; rows affected: 0, rows returned: 0, elapsed: 1.162ms  
2024-08-28T16:27:45.428468Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:45.428544Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-f331452e-a26a-4c32-9983-e896e1200701 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.428939Z  INFO log: SET sql_mode=(SELECT CONCAT(@@sql_mode, ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION')),time_zone='+00:00',NAMES …; rows affected: 0, rows returned: 0, elapsed: 33.394ms

SET
  sql_mode =(
    SELECT
      CONCAT(
        @ @sql_mode,
        ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION'
      )
  ),
  time_zone = '+00:00',
  NAMES utf8mb4 COLLATE utf8mb4_unicode_ci;
  
2024-08-28T16:27:45.429151Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.429214Z DEBUG log: executing simple query: INSERT INTO date_test VALUES('1997-12-17', '1997-12-17 07:37:16.123')    
2024-08-28T16:27:45.429244Z  INFO servers::server: MySQL server is shutdown.
2024-08-28T16:27:45.429295Z  INFO log: SELECT @@time_zone; rows affected: 0, rows returned: 1, elapsed: 767.279µs  
2024-08-28T16:27:45.429721Z DEBUG mysql::do_query:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "i", data_type: Int64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [123, 34, 70, 117, 110, 99, 116, 105, 111, 110, 34, 58, 34, 99, 117, 114, 114, 101, 110, 116, 95, 116, 105, 109, 101, 115, 116, 97, 109, 112, 40, 41, 34, 125], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "d", data_type: Date, is_nullable: true, default_constraint: [123, 34, 86, 97, 108, 117, 101, 34, 58, 34, 78, 117, 108, 108, 34, 125], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "dt", data_type: Datetime, is_nullable: true, default_constraint: [123, 34, 86, 97, 108, 117, 101, 34, 58, 34, 78, 117, 108, 108, 34, 125], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "b", data_type: Binary, is_nullable: true, default_constraint: [123, 34, 86, 97, 108, 117, 101, 34, 58, 34, 78, 117, 108, 108, 34, 125], semantic_type: Field, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: [], create_if_not_exists: false, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [i Int64 null, ts TimestampMillisecond not null time_index default=Function("current_timestamp()") metadata={"greptime:time_index": "true"}, d Date null default=Value(Null), dt DateTime null default=Value(Null), b Binary null default=Value(Null)], timestamp_index: Some(1), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 5, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.429635571Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.430237Z  INFO log: SELECT @@system_time_zone; rows affected: 0, rows returned: 1, elapsed: 771.561µs  
2024-08-28T16:27:45.430252Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-96e54da8-b323-4932-8986-1e5df52b868e starts
2024-08-28T16:27:45.430524Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.430557Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.430638Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.430646Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:45.430740Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-96e54da8-b323-4932-8986-1e5df52b868e once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.431021Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:45.431078Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:45.431136Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[hostname String null Tag 0], [environment String null Tag 1], [usage_user Float64 null Field 2], [usage_system Float64 null Field 3], [usage_idle Float64 null Field 4], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 5]], time_index: 5, primary_key: [0, 1], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.431208Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[hostname String null Tag 0], [environment String null Tag 1], [usage_user Float64 null Field 2], [usage_system Float64 null Field 3], [usage_idle Float64 null Field 4], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 5]], time_index: 5, primary_key: [0, 1], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.431223Z  INFO log: SET time_zone = 'UTC'; rows affected: 0, rows returned: 0, elapsed: 776.726µs  
2024-08-28T16:27:45.431447Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.432152Z  INFO log: SELECT @@time_zone; rows affected: 0, rows returned: 1, elapsed: 754.788µs  
2024-08-28T16:27:45.432824Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.432900Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.433151Z  INFO log: SELECT @@system_time_zone; rows affected: 0, rows returned: 1, elapsed: 815.066µs  
2024-08-28T16:27:45.433298Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:45.433373Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:45.433502Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index default=Function("current_timestamp()") metadata={"greptime:time_index": "true"} Timestamp 1], [d Date null default=Value(Null) Field 2], [dt DateTime null default=Value(Null) Field 3], [b Binary null default=Value(Null) Field 4]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.433537Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:45.433606Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.433609Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index default=Function("current_timestamp()") metadata={"greptime:time_index": "true"} Timestamp 1], [d Date null default=Value(Null) Field 2], [dt DateTime null default=Value(Null) Field 3], [b Binary null default=Value(Null) Field 4]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.433750Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[hostname String null Tag 0], [environment String null Tag 1], [usage_user Float64 null Field 2], [usage_system Float64 null Field 3], [usage_idle Float64 null Field 4], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 5]], time_index: 5, primary_key: [0, 1], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.433899Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.434114Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:45.434498Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-f331452e-a26a-4c32-9983-e896e1200701 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.434563Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 321.192µs }
2024-08-28T16:27:45.434489Z DEBUG mysql::do_query:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "i", data_type: Int64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: [], create_if_not_exists: false, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [i Int64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(1), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 2, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.434296221Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.434636Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 728.718µs
2024-08-28T16:27:45.434772Z DEBUG log: executing statement s1 with parameters: [0]    
test integration_sql_file_test::test_mysql_auth ... ok
2024-08-28T16:27:45.434993Z DEBUG mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.435052Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-356ac95d-a186-4d5c-bad5-545e6af24bd0 starts
2024-08-28T16:27:45.435084Z DEBUG mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 486.919µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 443.339µs }
2024-08-28T16:27:45.435362Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:45.435393Z DEBUG log: executing simple query: INSERT INTO dt_test VALUES('1997-12-17 07:37:16.123', '1997-12-17 07:37:16.123')    
2024-08-28T16:27:45.435429Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-356ac95d-a186-4d5c-bad5-545e6af24bd0 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.435558Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:45.435601Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.435681Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index default=Function("current_timestamp()") metadata={"greptime:time_index": "true"} Timestamp 1], [d Date null default=Value(Null) Field 2], [dt DateTime null default=Value(Null) Field 3], [b Binary null default=Value(Null) Field 4]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.435849Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:45.435731Z DEBUG on_query{protocol="mysql"}:mysql::do_query:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Submitting Ddl task: CreateTable(CreateTableTask { create_table: CreateTableExpr { catalog_name: "greptime", schema_name: "public", table_name: "demo", desc: "", column_defs: [ColumnDef { name: "i", data_type: Int64, is_nullable: true, default_constraint: [], semantic_type: Field, comment: "", datatype_extension: None, options: None }, ColumnDef { name: "ts", data_type: TimestampMillisecond, is_nullable: false, default_constraint: [], semantic_type: Timestamp, comment: "", datatype_extension: None, options: None }], time_index: "ts", primary_keys: [], create_if_not_exists: false, table_options: {}, table_id: None, engine: "mito" }, partitions: [Partition { column_list: [], value_list: [[34, 77, 97, 120, 86, 97, 108, 117, 101, 34]] }], table_info: RawTableInfo { ident: TableIdent { table_id: 0, version: 0 }, name: "demo", desc: None, catalog_name: "greptime", schema_name: "public", meta: RawTableMeta { schema: RawSchema { column_schemas: [i Int64 null, ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"}], timestamp_index: Some(1), version: 0 }, primary_key_indices: [], value_indices: [], engine: "mito", next_column_id: 2, region_numbers: [], options: TableOptions { write_buffer_size: None, ttl: None, extra_options: {} }, created_on: 2024-08-28T16:27:45.435555713Z, partition_key_indices: [] }, table_type: Base } })
2024-08-28T16:27:45.436003Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-96e54da8-b323-4932-8986-1e5df52b868e once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.436074Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 4.692511ms, first_consume: 11.741125ms, do_get_cost: 7.021029ms
2024-08-28T16:27:45.436198Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:45.436275Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-f331452e-a26a-4c32-9983-e896e1200701 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.436299Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-dc13611f-6670-4179-8704-e7168ff573db starts
2024-08-28T16:27:45.436409Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-f331452e-a26a-4c32-9983-e896e1200701 done
2024-08-28T16:27:45.436554Z DEBUG LocalManager::submit_root_procedure: common_meta::ddl::table_meta: Allocated region wal options {0: "{\"wal.provider\":\"raft_engine\"}"} for table 1024
2024-08-28T16:27:45.436626Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-dc13611f-6670-4179-8704-e7168ff573db once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.436654Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure f331452e-a26a-4c32-9983-e896e1200701, step_keys: ["procedure/f331452e-a26a-4c32-9983-e896e1200701/0000000000.step", "procedure/f331452e-a26a-4c32-9983-e896e1200701/0000000001.step"], finish_keys: ["procedure/f331452e-a26a-4c32-9983-e896e1200701/0000000002.commit"]
2024-08-28T16:27:45.436632Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.436724Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.436791Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.436783Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:45.436828Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-f331452e-a26a-4c32-9983-e896e1200701 exits
2024-08-28T16:27:45.436841Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-96e54da8-b323-4932-8986-1e5df52b868e once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.436925Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-96e54da8-b323-4932-8986-1e5df52b868e done
2024-08-28T16:27:45.437113Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 96e54da8-b323-4932-8986-1e5df52b868e, step_keys: ["procedure/96e54da8-b323-4932-8986-1e5df52b868e/0000000000.step", "procedure/96e54da8-b323-4932-8986-1e5df52b868e/0000000001.step"], finish_keys: ["procedure/96e54da8-b323-4932-8986-1e5df52b868e/0000000002.commit"]
2024-08-28T16:27:45.437114Z  INFO mysql::do_query:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(96e54da8-b323-4932-8986-1e5df52b868e)
2024-08-28T16:27:45.437119Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.437153Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:45.437194Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:45.437210Z  INFO mysql::do_query:do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:45.437262Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.437290Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-96e54da8-b323-4932-8986-1e5df52b868e exits
2024-08-28T16:27:45.437341Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.437308Z DEBUG sql{protocol="http" request_type="sql"}: servers::http::error_result: Failed to handle HTTP request, err: 0: Failed to execute query, at /root/work/repo/greptimedb/src/servers/src/query_handler/sql.rs:87:49
1: Table operation error, at src/frontend/src/instance.rs:232:14
2: Failed to plan statement, at /root/work/repo/greptimedb/src/operator/src/statement.rs:330:14
3: Failed to plan SQL, at src/query/src/planner.rs:100:14
4: External(0: Table not found: greptime.public.demo2, at src/query/src/datafusion/planner.rs:124:31)
2024-08-28T16:27:45.437490Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.437570Z  INFO on_query{protocol="mysql"}:mysql::do_query:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(f331452e-a26a-4c32-9983-e896e1200701)
2024-08-28T16:27:45.437759Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.437802Z DEBUG object_store::layers::prometheus: Prometheus statistics metrics error, operation stat error NotFound
2024-08-28T16:27:45.437850Z  INFO mito2::manifest::manager: Checkpoint not found in data/greptime/public/1024/1024_0000000000/manifest/, build manifest from scratch
2024-08-28T16:27:45.437900Z  INFO on_query{protocol="mysql"}:mysql::do_query:do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.cpu_metrics' with table id 1024
2024-08-28T16:27:45.438099Z DEBUG mito2::manifest::manager: No region manifest in data/greptime/public/1024/1024_0000000000/manifest/
2024-08-28T16:27:45.438141Z DEBUG mito2::region::opener: No data under directory data/greptime/public/1024/1024_0000000000/, region_id: 4398046511104(1024, 0)
2024-08-28T16:27:45.438195Z  INFO mito2::manifest::manager: Creating region manifest in data/greptime/public/1024/1024_0000000000/manifest/ with metadata RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.438247Z DEBUG mito2::manifest::manager: Build region manifest in data/greptime/public/1024/1024_0000000000/manifest/, manifest: RegionManifest { metadata: RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }, files: {}, flushed_entry_id: 0, flushed_sequence: 0, manifest_version: 0, truncated_entry_id: None, compaction_time_window: None }
2024-08-28T16:27:45.438360Z DEBUG mito2::manifest::storage: Save log to manifest storage, version: 0
2024-08-28T16:27:45.439027Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.439133Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:45.439141Z DEBUG log: executing simple query: SET DATESTYLE='ISO', 'MDY'    
2024-08-28T16:27:45.439198Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.439292Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.439511Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:45.439721Z DEBUG mito2::memtable::time_partition: Creates a time partition for all timestamps, region: 4398046511104(1024, 0), memtable_id: 0
2024-08-28T16:27:45.439766Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-356ac95d-a186-4d5c-bad5-545e6af24bd0 once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.439786Z DEBUG mito2::region::opener: Create region 4398046511104(1024, 0) with options: RegionOptions { ttl: None, compaction: Twcs(TwcsOptions { max_active_window_runs: 4, max_active_window_files: 4, max_inactive_window_runs: 1, max_inactive_window_files: 1, time_window: None, remote_compaction: false, fallback_to_local: true }), storage: None, append_mode: false, wal_options: RaftEngine, index_options: IndexOptions { inverted_index: InvertedIndexOptions { ignore_column_ids: [], segment_row_count: 1024 } }, memtable: None, merge_mode: None }
2024-08-28T16:27:45.439859Z  INFO mito2::worker::handle_create: A new region created, worker: 10, region: RegionMetadata { column_metadatas: [[i Int64 null Field 0], [ts TimestampMillisecond not null time_index metadata={"greptime:time_index": "true"} Timestamp 1]], time_index: 1, primary_key: [], region_id: 4398046511104(1024, 0), schema_version: 0 }
2024-08-28T16:27:45.440095Z  INFO LocalManager::submit_root_procedure:RegionInvoker::handle_region_request:RegionServer::handle_region_request{region_id="4398046511104(1024, 0)"}:handle_request{request_type="Create"}: datanode::region_server: Region 4398046511104(1024, 0) is registered to engine mito
2024-08-28T16:27:45.440246Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.440315Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-dc13611f-6670-4179-8704-e7168ff573db once, status: Executing { persist: true }, need_persist: true
2024-08-28T16:27:45.440860Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 306.727µs }
2024-08-28T16:27:45.440895Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:45.440984Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-356ac95d-a186-4d5c-bad5-545e6af24bd0 once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.441023Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.441094Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 746.339µs
2024-08-28T16:27:45.441138Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-356ac95d-a186-4d5c-bad5-545e6af24bd0 done
2024-08-28T16:27:45.441346Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.441423Z  INFO LocalManager::submit_root_procedure: common_meta::ddl::create_table: Created table metadata for table 1024
2024-08-28T16:27:45.441438Z  INFO mysql::do_query:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(356ac95d-a186-4d5c-bad5-545e6af24bd0)
2024-08-28T16:27:45.441515Z DEBUG LocalManager::submit_root_procedure: common_procedure::local::runner: Execute procedure metasrv-procedure::CreateTable-dc13611f-6670-4179-8704-e7168ff573db once, status: Done { output: Some(Any { .. }) }, need_persist: false
2024-08-28T16:27:45.441540Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure 356ac95d-a186-4d5c-bad5-545e6af24bd0, step_keys: ["procedure/356ac95d-a186-4d5c-bad5-545e6af24bd0/0000000000.step", "procedure/356ac95d-a186-4d5c-bad5-545e6af24bd0/0000000001.step"], finish_keys: ["procedure/356ac95d-a186-4d5c-bad5-545e6af24bd0/0000000002.commit"]
2024-08-28T16:27:45.441663Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Procedure metasrv-procedure::CreateTable-dc13611f-6670-4179-8704-e7168ff573db done
2024-08-28T16:27:45.441639Z  INFO mysql::do_query:do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:45.441613Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.708174ms, build_parts_cost: 163.859µs, build_reader_cost: 746.339µs, scan_cost: 212.084µs, convert_cost: 40.653µs, yield_cost: 70.856µs, total_cost: 5.009562ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.758711ms
2024-08-28T16:27:45.441725Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.441793Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.441879Z  INFO on_query{protocol="mysql"}:mysql::do_query:do_query:execute_stmt:create_table:create_table_inner:DdlManager::submit_ddl_task: common_meta::ddl_manager: Table: 1024 is created via procedure_id ProcedureId(dc13611f-6670-4179-8704-e7168ff573db)
2024-08-28T16:27:45.441935Z DEBUG LocalManager::submit_root_procedure: common_procedure::store: Delete keys for procedure dc13611f-6670-4179-8704-e7168ff573db, step_keys: ["procedure/dc13611f-6670-4179-8704-e7168ff573db/0000000000.step", "procedure/dc13611f-6670-4179-8704-e7168ff573db/0000000001.step"], finish_keys: ["procedure/dc13611f-6670-4179-8704-e7168ff573db/0000000002.commit"]
2024-08-28T16:27:45.441935Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 650.68µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 591.348µs }
2024-08-28T16:27:45.441943Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-356ac95d-a186-4d5c-bad5-545e6af24bd0 exits
2024-08-28T16:27:45.441995Z  INFO on_query{protocol="mysql"}:mysql::do_query:do_query:execute_stmt:create_table:create_table_inner: operator::statement::ddl: Successfully created table 'greptime.public.demo' with table id 1024
2024-08-28T16:27:45.442228Z  INFO LocalManager::submit_root_procedure: common_procedure::local::runner: Runner metasrv-procedure::CreateTable-dc13611f-6670-4179-8704-e7168ff573db exits
2024-08-28T16:27:45.442616Z  INFO log: create table demo(i bigint, …; rows affected: 0, rows returned: 0, elapsed: 11.675ms

create table demo(
  i bigint,
  ts timestamp time index default current_timestamp,
  d date default null,
  dt datetime default null,
  b blob default null
)
  
2024-08-28T16:27:45.442620Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.442970Z  INFO log: insert into demo values($1, …; rows affected: 1, rows returned: 0, elapsed: 14.485ms

insert into
  demo
values
($1, $2, $3, $4)
  
2024-08-28T16:27:45.443092Z DEBUG servers::mysql::server: MySQL connection coming from: 127.0.0.1:60940
2024-08-28T16:27:45.443902Z  INFO log: create table demo(i bigint, …; rows affected: 0, rows returned: 0, elapsed: 14.844ms

create table demo(i bigint, ts timestamp time index)
  
2024-08-28T16:27:45.444040Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 342.947µs }
2024-08-28T16:27:45.444202Z  INFO log: create table demo(i bigint, …; rows affected: 0, rows returned: 0, elapsed: 9.079ms

create table demo(i bigint, ts timestamp time index)
  
2024-08-28T16:27:45.444279Z DEBUG servers::mysql::server: MySQL connection coming from: 127.0.0.1:37002
2024-08-28T16:27:45.445265Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 3.59094ms, first_consume: 9.356231ms, do_get_cost: 5.726071ms
2024-08-28T16:27:45.446289Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 2.746975ms
2024-08-28T16:27:45.446309Z DEBUG log: executing simple query: SET bytea_output='escape'    
2024-08-28T16:27:45.446422Z  INFO log: SET sql_mode=(SELECT CONCAT(@@sql_mode, ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION')),time_zone='+00:00',NAMES …; rows affected: 0, rows returned: 0, elapsed: 385.580µs

SET
  sql_mode =(
    SELECT
      CONCAT(
        @ @sql_mode,
        ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION'
      )
  ),
  time_zone = '+00:00',
  NAMES utf8mb4 COLLATE utf8mb4_unicode_ci;
  
2024-08-28T16:27:45.446585Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.521448ms, build_parts_cost: 99.798µs, build_reader_cost: 2.746975ms, scan_cost: 127.523µs, convert_cost: 30.749µs, yield_cost: 39.477µs, total_cost: 5.586751ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.551896ms
2024-08-28T16:27:45.446666Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.446713Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 2.680674ms, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 2.64963ms }
2024-08-28T16:27:45.447268Z DEBUG log: executing simple query: SELECT b FROM test    
2024-08-28T16:27:45.447288Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 4.43598ms, first_consume: 7.314969ms, do_get_cost: 2.853278ms
2024-08-28T16:27:45.448507Z  INFO log: SET sql_mode=(SELECT CONCAT(@@sql_mode, ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION')),time_zone='+00:00',NAMES …; rows affected: 0, rows returned: 0, elapsed: 925.079µs

SET
  sql_mode =(
    SELECT
      CONCAT(
        @ @sql_mode,
        ',PIPES_AS_CONCAT,NO_ENGINE_SUBSTITUTION'
      )
  ),
  time_zone = '+00:00',
  NAMES utf8mb4 COLLATE utf8mb4_unicode_ci;
  
2024-08-28T16:27:45.449079Z  INFO log: insert into demo values(1, …; rows affected: 1, rows returned: 0, elapsed: 4.190ms

insert into
  demo
values
(1, 1667446797450)
  
2024-08-28T16:27:45.449127Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: Some([OrderOption { name: "host", options: SortOptions { descending: true, nulls_first: false } }, OrderOption { name: "ts", options: SortOptions { descending: true, nulls_first: false } }]), limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.449655Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.450220Z  INFO servers::server: Postgres server is shutdown.
2024-08-28T16:27:45.450915Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.451369Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$5": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$6": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$3": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$1": Some(
        String(
            StringType,
        ),
    ),
    "$4": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$2": Some(
        String(
            StringType,
        ),
    ),
}, params: "(Value(Bytes([104, 111, 115, 116, 48])), MYSQL_TYPE_VAR_STRING), (Value(Bytes([116, 101, 115, 116])), MYSQL_TYPE_VAR_STRING), (Value(Double(32.0)), MYSQL_TYPE_DOUBLE), (Value(Double(3.0)), MYSQL_TYPE_DOUBLE), (Value(Double(4.0)), MYSQL_TYPE_DOUBLE), (Value(Int(1680307200050)), MYSQL_TYPE_LONGLONG)")
2024-08-28T16:27:45.451578Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[cpu_metrics]
  Projection: column1 AS hostname, column2 AS environment, column3 AS usage_user, column4 AS usage_system, column5 AS usage_idle, column6 AS ts
    Values: (Utf8("host0"), Utf8("test"), Float64(32), Float64(3), Float64(4), TimestampMillisecond(1680307200050, None))
2024-08-28T16:27:45.452600Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.453148Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.453635Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.454012Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.455020Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 647.61µs
2024-08-28T16:27:45.455146Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 2, num_pruned_series: 0, num_rows: 2, num_batches: 2, scan_cost: 514.674µs }
2024-08-28T16:27:45.455177Z  INFO log: insert into demo values($1, …; rows affected: 1, rows returned: 0, elapsed: 9.853ms

insert into
  demo
values
($1, $2, $3, $4)
  
2024-08-28T16:27:45.455392Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
test integration_sql_file_test::test_postgres_parameter_inference ... ok
2024-08-28T16:27:45.456457Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 254.205µs }
2024-08-28T16:27:45.456443Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 4.513731ms, build_parts_cost: 214.788µs, build_reader_cost: 647.61µs, scan_cost: 263.823µs, convert_cost: 228.935µs, yield_cost: 776.287µs, total_cost: 7.36976ms, num_batches: 2, num_rows: 2, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 4.564175ms
2024-08-28T16:27:45.456538Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.456481Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.456571Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 543.456µs, num_fetch_by_batches: 2, num_fetch_by_rows: 0, num_input_rows: 2, num_output_rows: 2, fetch_cost: 493.061µs }
2024-08-28T16:27:45.456482Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$3": Some(
        Date(
            DateType,
        ),
    ),
    "$4": Some(
        DateTime(
            DateTimeType,
        ),
    ),
    "$5": Some(
        Binary(
            BinaryType,
        ),
    ),
}, params: "(Value(UInt(0)), MYSQL_TYPE_LONG), (Value(UInt(0)), MYSQL_TYPE_LONG), (Value(Date([223, 7, 4, 10])), MYSQL_TYPE_DATE), (Value(Datetime([178, 7, 1, 1, 0, 1, 0])), MYSQL_TYPE_TIMESTAMP), (Value(Bytes([104, 101, 108, 108, 111, 48])), MYSQL_TYPE_BLOB)")
2024-08-28T16:27:45.456607Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 644.078µs
2024-08-28T16:27:45.456813Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.413596ms, build_parts_cost: 155.989µs, build_reader_cost: 644.078µs, scan_cost: 65.358µs, convert_cost: 14.786µs, yield_cost: 30.964µs, total_cost: 4.297778ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.447197ms
2024-08-28T16:27:45.456899Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.456922Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.456970Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 484.483µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 459.959µs }
2024-08-28T16:27:45.456870Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts, column3 AS d, column4 AS dt, column5 AS b
    Values: (Int64(0), TimestampMillisecond(0, None), Date32("2015-04-10"), Date64("1970-01-01"), Binary("104,101,108,108,111,48"))
2024-08-28T16:27:45.457254Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
}, params: "(Value(Int(0)), MYSQL_TYPE_LONG), (Value(Datetime([231, 7, 12, 19])), MYSQL_TYPE_DATETIME)")
2024-08-28T16:27:45.457414Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.457409Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts
    Values: (Int64(0), TimestampMillisecond(1702944000000, None))
2024-08-28T16:27:45.458276Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.459804Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([1, 3]), filters: [], output_ordering: None, limit: Some(1), series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.460157Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.460242Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.016656ms, first_consume: 7.935053ms, do_get_cost: 5.893723ms
2024-08-28T16:27:45.460254Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 196.637µs }
2024-08-28T16:27:45.460482Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 671.149µs
2024-08-28T16:27:45.460479Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([1]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.460712Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.355803ms, build_parts_cost: 154.262µs, build_reader_cost: 671.149µs, scan_cost: 95.04µs, convert_cost: 21.052µs, yield_cost: 29.803µs, total_cost: 4.289133ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.388782ms
2024-08-28T16:27:45.460734Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.460768Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.460781Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.460843Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 513.374µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 485.173µs }
2024-08-28T16:27:45.461192Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.461302Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.461385Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        String(
            StringType,
        ),
    ),
    "$5": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$4": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$3": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$2": Some(
        String(
            StringType,
        ),
    ),
    "$6": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
}, params: "(Value(Bytes([104, 111, 115, 116, 49])), MYSQL_TYPE_VAR_STRING), (Value(Bytes([116, 101, 115, 116])), MYSQL_TYPE_VAR_STRING), (Value(Double(29.0)), MYSQL_TYPE_DOUBLE), (Value(Double(32.0)), MYSQL_TYPE_DOUBLE), (Value(Double(50.0)), MYSQL_TYPE_DOUBLE), (Value(Int(1680307200050)), MYSQL_TYPE_LONGLONG)")
2024-08-28T16:27:45.461664Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.461667Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[cpu_metrics]
  Projection: column1 AS hostname, column2 AS environment, column3 AS usage_user, column4 AS usage_system, column5 AS usage_idle, column6 AS ts
    Values: (Utf8("host1"), Utf8("test"), Float64(29), Float64(32), Float64(50), TimestampMillisecond(1680307200050, None))
2024-08-28T16:27:45.461787Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 3.500925ms, first_consume: 17.466701ms, do_get_cost: 13.933561ms
2024-08-28T16:27:45.462083Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.462432Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.88351ms, first_consume: 8.064501ms, do_get_cost: 5.158983ms
2024-08-28T16:27:45.463156Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 161.03µs }
2024-08-28T16:27:45.463464Z DEBUG log: executing simple query: SET bytea_output='invalid'    
2024-08-28T16:27:45.464099Z DEBUG do_query{protocol="postgres"}:do_query: frontend::instance: Failed to execute query: SET bytea_output = 'invalid', Table operation error
2024-08-28T16:27:45.464231Z DEBUG do_query{protocol="postgres"}: servers::postgres::handler: Failed to handle postgres query, code: InvalidArguments, db: public, error: 0: Failed to execute query, at /root/work/repo/greptimedb/src/servers/src/query_handler/sql.rs:87:49
1: Table operation error, at src/frontend/src/instance.rs:232:14
2: Invalid configuration value., at src/operator/src/statement/set.rs:65:53
3: Invalid value for parameter "BYTEA_OUTPUT": 'invalid'
Hint: Available values: escape, hex, at src/session/src/session_config.rs:56:22
2024-08-28T16:27:45.464395Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 15.018ms

insert into
  demo
values
(?, ?)
  
2024-08-28T16:27:45.464867Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 149.9µs }
2024-08-28T16:27:45.464917Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 356.801µs
2024-08-28T16:27:45.465059Z DEBUG servers::postgres::server: PostgreSQL client coming from 127.0.0.1:36116
2024-08-28T16:27:45.465231Z DEBUG mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.465296Z DEBUG mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 272.869µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 240.055µs }
2024-08-28T16:27:45.465629Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 2.741347ms
2024-08-28T16:27:45.465858Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.40482ms, build_parts_cost: 104.266µs, build_reader_cost: 2.741347ms, scan_cost: 74.399µs, convert_cost: 17.815µs, yield_cost: 33.543µs, total_cost: 5.393452ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.430614ms
2024-08-28T16:27:45.465951Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.466004Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 2.678528ms, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 2.656188ms }
2024-08-28T16:27:45.466296Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 3.95274ms, first_consume: 8.719101ms, do_get_cost: 4.739436ms
2024-08-28T16:27:45.466519Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 4.270501ms, first_consume: 7.919873ms, do_get_cost: 3.628322ms
2024-08-28T16:27:45.466749Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 18.922ms

insert into
  demo
values
(?, ?, ?, ?, ?)
  
2024-08-28T16:27:45.467158Z  INFO log: insert into demo values($1, …; rows affected: 1, rows returned: 0, elapsed: 9.905ms

insert into
  demo
values
($1, $2, $3, $4)
  
2024-08-28T16:27:45.467881Z  INFO log: select ts from demo; rows affected: 0, rows returned: 1, elapsed: 18.698ms  
2024-08-28T16:27:45.468493Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.468552Z  INFO log: SET time_zone = '+08:00'; rows affected: 0, rows returned: 0, elapsed: 530.508µs  
2024-08-28T16:27:45.468738Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.469086Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.469666Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.469908Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$6": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$2": Some(
        String(
            StringType,
        ),
    ),
    "$1": Some(
        String(
            StringType,
        ),
    ),
    "$5": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$4": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$3": Some(
        Float64(
            Float64Type,
        ),
    ),
}, params: "(Value(Bytes([104, 111, 115, 116, 48])), MYSQL_TYPE_VAR_STRING), (Value(Bytes([116, 101, 115, 116])), MYSQL_TYPE_VAR_STRING), (Value(Double(32.0)), MYSQL_TYPE_DOUBLE), (Value(Double(3.0)), MYSQL_TYPE_DOUBLE), (Value(Double(4.0)), MYSQL_TYPE_DOUBLE), (Value(Int(1680307260050)), MYSQL_TYPE_LONGLONG)")
2024-08-28T16:27:45.470126Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[cpu_metrics]
  Projection: column1 AS hostname, column2 AS environment, column3 AS usage_user, column4 AS usage_system, column5 AS usage_idle, column6 AS ts
    Values: (Utf8("host0"), Utf8("test"), Float64(32), Float64(3), Float64(4), TimestampMillisecond(1680307260050, None))
2024-08-28T16:27:45.470733Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 213.506µs }
2024-08-28T16:27:45.470842Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 421.786µs
2024-08-28T16:27:45.470949Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
}, params: "(Value(Int(1)), MYSQL_TYPE_LONG), (Value(Datetime([231, 7, 12, 19, 13, 19, 1])), MYSQL_TYPE_DATETIME)")
2024-08-28T16:27:45.471101Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.929377ms, build_parts_cost: 82.508µs, build_reader_cost: 421.786µs, scan_cost: 110.568µs, convert_cost: 24.367µs, yield_cost: 32.216µs, total_cost: 2.621855ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.948295ms
2024-08-28T16:27:45.471178Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.471124Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts
    Values: (Int64(1), TimestampMillisecond(1702991941000, None))
2024-08-28T16:27:45.471219Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 377.835µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 343.563µs }
2024-08-28T16:27:45.472510Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 1.497117ms, first_consume: 4.140898ms, do_get_cost: 2.625376ms
2024-08-28T16:27:45.474301Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.475564Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$4": Some(
        DateTime(
            DateTimeType,
        ),
    ),
    "$3": Some(
        Date(
            DateType,
        ),
    ),
    "$5": Some(
        Binary(
            BinaryType,
        ),
    ),
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
}, params: "(Value(UInt(1)), MYSQL_TYPE_LONG), (Value(UInt(1)), MYSQL_TYPE_LONG), (Value(Date([223, 7, 4, 10])), MYSQL_TYPE_DATE), (Value(Datetime([178, 7, 1, 1, 0, 1, 0, 0, 0, 0, 0])), MYSQL_TYPE_TIMESTAMP), (Value(Bytes([104, 101, 108, 108, 111, 49])), MYSQL_TYPE_BLOB)")
2024-08-28T16:27:45.475795Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.475842Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts, column3 AS d, column4 AS dt, column5 AS b
    Values: (Int64(1), TimestampMillisecond(1, None), Date32("2015-04-10"), Date64("1970-01-01"), Binary("104,101,108,108,111,49"))
2024-08-28T16:27:45.476212Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.476339Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([1]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.476612Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.476751Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.477072Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.477361Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        String(
            StringType,
        ),
    ),
    "$6": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$4": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$3": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$5": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$2": Some(
        String(
            StringType,
        ),
    ),
}, params: "(Value(Bytes([104, 111, 115, 116, 49])), MYSQL_TYPE_VAR_STRING), (Value(Bytes([116, 101, 115, 116])), MYSQL_TYPE_VAR_STRING), (Value(Double(29.0)), MYSQL_TYPE_DOUBLE), (Value(Double(32.0)), MYSQL_TYPE_DOUBLE), (Value(Double(50.0)), MYSQL_TYPE_DOUBLE), (Value(Int(1680307260050)), MYSQL_TYPE_LONGLONG)")
2024-08-28T16:27:45.477483Z  INFO log: insert into demo values($1, …; rows affected: 1, rows returned: 0, elapsed: 8.252ms

insert into
  demo
values
($1, $2, $3, $4)
  
2024-08-28T16:27:45.477530Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[cpu_metrics]
  Projection: column1 AS hostname, column2 AS environment, column3 AS usage_user, column4 AS usage_system, column5 AS usage_idle, column6 AS ts
    Values: (Utf8("host1"), Utf8("test"), Float64(29), Float64(32), Float64(50), TimestampMillisecond(1680307260050, None))
2024-08-28T16:27:45.477847Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 11.969ms

insert into
  demo
values
(?, ?)
  
2024-08-28T16:27:45.477876Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.478053Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.478498Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
}, params: "(Value(Int(2)), MYSQL_TYPE_LONG), (Value(Datetime([231, 7, 12, 19, 13, 20, 1, 64, 226, 1, 0])), MYSQL_TYPE_DATETIME)")
2024-08-28T16:27:45.478670Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts
    Values: (Int64(2), TimestampMillisecond(1702992001123, None))
2024-08-28T16:27:45.479155Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 210.11µs }
2024-08-28T16:27:45.479291Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 511.218µs
2024-08-28T16:27:45.479519Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.448385ms, build_parts_cost: 116.517µs, build_reader_cost: 511.218µs, scan_cost: 95.353µs, convert_cost: 23.73µs, yield_cost: 29.091µs, total_cost: 3.199734ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.46759ms
2024-08-28T16:27:45.479593Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.479633Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 445.926µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 418.627µs }
2024-08-28T16:27:45.479668Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 162.169µs }
2024-08-28T16:27:45.479767Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 431.136µs
2024-08-28T16:27:45.480000Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.562479ms, build_parts_cost: 147.014µs, build_reader_cost: 431.136µs, scan_cost: 99.409µs, convert_cost: 19.724µs, yield_cost: 30.573µs, total_cost: 4.262891ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.597028ms
2024-08-28T16:27:45.480070Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.480118Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 339.852µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 313.002µs }
2024-08-28T16:27:45.481622Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.481894Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.482122Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.60021ms, first_consume: 7.199878ms, do_get_cost: 4.579216ms
2024-08-28T16:27:45.482220Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.482272Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 1.917866ms, first_consume: 5.131214ms, do_get_cost: 3.192251ms
2024-08-28T16:27:45.482897Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.483248Z  INFO log: select b from test; rows affected: 0, rows returned: 1, elapsed: 17.307ms  
2024-08-28T16:27:45.483957Z  INFO log: select ts from demo; rows affected: 0, rows returned: 1, elapsed: 15.305ms  
2024-08-28T16:27:45.484154Z  INFO servers::server: Postgres server is shutdown.
2024-08-28T16:27:45.484285Z  INFO servers::server: MySQL server is shutdown.
2024-08-28T16:27:45.484286Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$5": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$4": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$1": Some(
        String(
            StringType,
        ),
    ),
    "$3": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$6": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$2": Some(
        String(
            StringType,
        ),
    ),
}, params: "(Value(Bytes([104, 111, 115, 116, 48])), MYSQL_TYPE_VAR_STRING), (Value(Bytes([116, 101, 115, 116])), MYSQL_TYPE_VAR_STRING), (Value(Double(32.0)), MYSQL_TYPE_DOUBLE), (Value(Double(3.0)), MYSQL_TYPE_DOUBLE), (Value(Double(4.0)), MYSQL_TYPE_DOUBLE), (Value(Int(1680307320050)), MYSQL_TYPE_LONGLONG)")
2024-08-28T16:27:45.484552Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[cpu_metrics]
  Projection: column1 AS hostname, column2 AS environment, column3 AS usage_user, column4 AS usage_system, column5 AS usage_idle, column6 AS ts
    Values: (Utf8("host0"), Utf8("test"), Float64(32), Float64(3), Float64(4), TimestampMillisecond(1680307320050, None))
2024-08-28T16:27:45.485152Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 5.956ms

insert into
  demo
values
(?, ?)
  
2024-08-28T16:27:45.485216Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 309.082µs }
2024-08-28T16:27:45.485463Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 1.153874ms
2024-08-28T16:27:45.485767Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.698403ms, build_parts_cost: 90.659µs, build_reader_cost: 1.153874ms, scan_cost: 124.388µs, convert_cost: 23.106µs, yield_cost: 38.031µs, total_cost: 4.168954ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.724021ms
2024-08-28T16:27:45.485879Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.485943Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 1.083223ms, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 1.04625ms }
2024-08-28T16:27:45.486833Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 16.821ms

insert into
  demo
values
(?, ?, ?, ?, ?)
  
2024-08-28T16:27:45.487705Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 3.397497ms, first_consume: 6.366681ms, do_get_cost: 2.943015ms
2024-08-28T16:27:45.487732Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$3": Some(
        Date(
            DateType,
        ),
    ),
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$4": Some(
        DateTime(
            DateTimeType,
        ),
    ),
    "$5": Some(
        Binary(
            BinaryType,
        ),
    ),
}, params: "(Value(UInt(2)), MYSQL_TYPE_LONG), (Value(UInt(2)), MYSQL_TYPE_LONG), (Value(Date([223, 7, 4, 10])), MYSQL_TYPE_DATE), (Value(Datetime([178, 7, 1, 1, 0, 1, 0, 0, 0, 0, 0])), MYSQL_TYPE_TIMESTAMP), (Value(Bytes([104, 101, 108, 108, 111, 50])), MYSQL_TYPE_BLOB)")
2024-08-28T16:27:45.488044Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts, column3 AS d, column4 AS dt, column5 AS b
    Values: (Int64(2), TimestampMillisecond(2, None), Date32("2015-04-10"), Date64("1970-01-01"), Binary("104,101,108,108,111,50"))
2024-08-28T16:27:45.488721Z DEBUG log: executing simple query: SET DATESTYLE='ISO', 'DMY'    
2024-08-28T16:27:45.489601Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.489754Z  INFO log: insert into demo values($1, …; rows affected: 1, rows returned: 0, elapsed: 9.054ms

insert into
  demo
values
($1, $2, $3, $4)
  
2024-08-28T16:27:45.496490Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.496774Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.497547Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$4": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$1": Some(
        String(
            StringType,
        ),
    ),
    "$5": Some(
        Float64(
            Float64Type,
        ),
    ),
    "$2": Some(
        String(
            StringType,
        ),
    ),
    "$6": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$3": Some(
        Float64(
            Float64Type,
        ),
    ),
}, params: "(Value(Bytes([104, 111, 115, 116, 49])), MYSQL_TYPE_VAR_STRING), (Value(Bytes([116, 101, 115, 116])), MYSQL_TYPE_VAR_STRING), (Value(Double(29.0)), MYSQL_TYPE_DOUBLE), (Value(Double(32.0)), MYSQL_TYPE_DOUBLE), (Value(Double(50.0)), MYSQL_TYPE_DOUBLE), (Value(Int(1680307320050)), MYSQL_TYPE_LONGLONG)")
2024-08-28T16:27:45.497673Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.497783Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {}, params: "")
2024-08-28T16:27:45.497868Z DEBUG servers::mysql::handler: Mysql execute prepared plan: MergeScan [is_placeholder=false]
2024-08-28T16:27:45.497901Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[cpu_metrics]
  Projection: column1 AS hostname, column2 AS environment, column3 AS usage_user, column4 AS usage_system, column5 AS usage_idle, column6 AS ts
    Values: (Utf8("host1"), Utf8("test"), Float64(29), Float64(32), Float64(50), TimestampMillisecond(1680307320050, None))
2024-08-28T16:27:45.498742Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.499254Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 10.337ms

insert into
  demo
values
(?, ?, ?, ?, ?)
  
test integration_sql_file_test::test_postgres_bytea ... ok
2024-08-28T16:27:45.499941Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$4": Some(
        DateTime(
            DateTimeType,
        ),
    ),
    "$5": Some(
        Binary(
            BinaryType,
        ),
    ),
    "$3": Some(
        Date(
            DateType,
        ),
    ),
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
}, params: "(Value(UInt(3)), MYSQL_TYPE_LONG), (Value(UInt(3)), MYSQL_TYPE_LONG), (Value(Date([223, 7, 4, 10])), MYSQL_TYPE_DATE), (Value(Datetime([178, 7, 1, 1, 0, 1, 0, 0, 0, 0, 0])), MYSQL_TYPE_TIMESTAMP), (Value(Bytes([104, 101, 108, 108, 111, 51])), MYSQL_TYPE_BLOB)")
2024-08-28T16:27:45.500161Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 231.585µs }
2024-08-28T16:27:45.500156Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts, column3 AS d, column4 AS dt, column5 AS b
    Values: (Int64(3), TimestampMillisecond(3, None), Date32("2015-04-10"), Date64("1970-01-01"), Binary("104,101,108,108,111,51"))
2024-08-28T16:27:45.500351Z  INFO log: insert into demo values($1, …; rows affected: 1, rows returned: 0, elapsed: 8.625ms

insert into
  demo
values
($1, $2, $3, $4)
  
2024-08-28T16:27:45.500407Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 653.535µs
2024-08-28T16:27:45.500672Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.282389ms, build_parts_cost: 107.972µs, build_reader_cost: 653.535µs, scan_cost: 110.418µs, convert_cost: 25.077µs, yield_cost: 33.315µs, total_cost: 4.212435ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.304325ms
2024-08-28T16:27:45.500762Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.500810Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 555.741µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 518.143µs }
2024-08-28T16:27:45.501729Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.447459ms, first_consume: 6.375045ms, do_get_cost: 3.904884ms
2024-08-28T16:27:45.502567Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.503445Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1]), filters: [], output_ordering: Some([OrderOption { name: "i", options: SortOptions { descending: false, nulls_first: false } }]), limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.503845Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.504805Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.506749Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:execute_stream:read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.507515Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 3, num_batches: 1, scan_cost: 345.155µs }
2024-08-28T16:27:45.507520Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:execute_stream:read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 494.012µs
2024-08-28T16:27:45.507935Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:execute_stream:read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.466836ms, build_parts_cost: 114.478µs, build_reader_cost: 494.012µs, scan_cost: 265.504µs, convert_cost: 20.44µs, yield_cost: 25.127µs, total_cost: 4.523037ms, num_batches: 1, num_rows: 3, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.621144ms
2024-08-28T16:27:45.508021Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:execute_stream:read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.508084Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:execute_stream:read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 625.283µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 3, num_output_rows: 3, fetch_cost: 602.398µs }
2024-08-28T16:27:45.508891Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 7.172ms

insert into
  demo
values
(?, ?, ?, ?, ?)
  
2024-08-28T16:27:45.508969Z  INFO log: insert into demo values($1, …; rows affected: 1, rows returned: 0, elapsed: 6.765ms

insert into
  demo
values
($1, $2, $3, $4)
  
2024-08-28T16:27:45.508995Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.509253Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.509311Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 699.088µs, first_consume: 9.179754ms, do_get_cost: 8.461645ms
2024-08-28T16:27:45.509606Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.509810Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$3": Some(
        Date(
            DateType,
        ),
    ),
    "$5": Some(
        Binary(
            BinaryType,
        ),
    ),
    "$4": Some(
        DateTime(
            DateTimeType,
        ),
    ),
}, params: "(Value(UInt(4)), MYSQL_TYPE_LONG), (Value(UInt(4)), MYSQL_TYPE_LONG), (Value(Date([223, 7, 4, 10])), MYSQL_TYPE_DATE), (Value(Datetime([178, 7, 1, 1, 0, 1, 0, 0, 0, 0, 0])), MYSQL_TYPE_TIMESTAMP), (Value(Bytes([104, 101, 108, 108, 111, 52])), MYSQL_TYPE_BLOB)")
2024-08-28T16:27:45.510096Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts, column3 AS d, column4 AS dt, column5 AS b
    Values: (Int64(4), TimestampMillisecond(4, None), Date32("2015-04-10"), Date64("1970-01-01"), Binary("104,101,108,108,111,52"))
2024-08-28T16:27:45.510362Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
test integration_http_file_test::test_prom_http_api ... ok
test integration_sql_file_test::test_mysql_timezone ... ok
2024-08-28T16:27:45.511745Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 174.788µs }
2024-08-28T16:27:45.511803Z  INFO log: select i, ts from …; rows affected: 0, rows returned: 3, elapsed: 24.301ms

select
  i,
  ts
from
  demo
order by
  i
  
2024-08-28T16:27:45.511999Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 542.952µs
2024-08-28T16:27:45.512161Z  INFO servers::server: MySQL server is shutdown.
2024-08-28T16:27:45.512240Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.462546ms, build_parts_cost: 89.047µs, build_reader_cost: 542.952µs, scan_cost: 100.285µs, convert_cost: 23.087µs, yield_cost: 31.686µs, total_cost: 3.266519ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.485155ms
2024-08-28T16:27:45.512297Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.512330Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 488.415µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 458.924µs }
2024-08-28T16:27:45.513614Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 2.246398ms, first_consume: 5.352376ms, do_get_cost: 3.087403ms
2024-08-28T16:27:45.514547Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.518231Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {}, params: "")
test integration_sql_file_test::test_mysql_prepare_stmt_insert_timestamp ... ok
2024-08-28T16:27:45.518285Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([1, 3]), filters: [], output_ordering: None, limit: Some(1), series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.518357Z DEBUG servers::mysql::handler: Mysql execute prepared plan: MergeScan [is_placeholder=false]
2024-08-28T16:27:45.518642Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.518705Z  INFO log: insert into demo values($1, …; rows affected: 1, rows returned: 0, elapsed: 7.409ms

insert into
  demo
values
($1, $2, $3, $4)
  
2024-08-28T16:27:45.519305Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.520372Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.520513Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.520707Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.520971Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.521510Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.522718Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 180.797µs }
2024-08-28T16:27:45.522840Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 484.774µs
2024-08-28T16:27:45.523069Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.836756ms, build_parts_cost: 67.849µs, build_reader_cost: 484.774µs, scan_cost: 101.381µs, convert_cost: 20.749µs, yield_cost: 27.419µs, total_cost: 2.562985ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.854096ms
2024-08-28T16:27:45.523127Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.523159Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 440.09µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 407.92µs }
2024-08-28T16:27:45.523263Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3, 4, 5]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.523559Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.523776Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 174.54µs }
2024-08-28T16:27:45.523841Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 392.493µs
2024-08-28T16:27:45.523896Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.524172Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 12.342ms

insert into
  demo
values
(?, ?, ?, ?, ?)
  
2024-08-28T16:27:45.524192Z DEBUG mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.524275Z DEBUG mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 318.994µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 282.962µs }
2024-08-28T16:27:45.524568Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.524713Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 1.890083ms, first_consume: 4.175043ms, do_get_cost: 2.267174ms
2024-08-28T16:27:45.525005Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$4": Some(
        DateTime(
            DateTimeType,
        ),
    ),
    "$3": Some(
        Date(
            DateType,
        ),
    ),
    "$5": Some(
        Binary(
            BinaryType,
        ),
    ),
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
}, params: "(Value(UInt(5)), MYSQL_TYPE_LONG), (Value(UInt(5)), MYSQL_TYPE_LONG), (Value(Date([223, 7, 4, 10])), MYSQL_TYPE_DATE), (Value(Datetime([178, 7, 1, 1, 0, 1, 0, 0, 0, 0, 0])), MYSQL_TYPE_TIMESTAMP), (Value(Bytes([104, 101, 108, 108, 111, 53])), MYSQL_TYPE_BLOB)")
2024-08-28T16:27:45.525262Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts, column3 AS d, column4 AS dt, column5 AS b
    Values: (Int64(5), TimestampMillisecond(5, None), Date32("2015-04-10"), Date64("1970-01-01"), Binary("104,101,108,108,111,53"))
2024-08-28T16:27:45.525366Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 2, num_pruned_series: 0, num_rows: 6, num_batches: 2, scan_cost: 294.718µs }
2024-08-28T16:27:45.525416Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 4.278797ms, first_consume: 10.772148ms, do_get_cost: 6.463641ms
2024-08-28T16:27:45.525734Z DEBUG log: executing simple query: SET DATESTYLE='ISO', 'YMD'    
2024-08-28T16:27:45.526197Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 1.281325ms
2024-08-28T16:27:45.526715Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.527650Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.663493ms, build_parts_cost: 93.523µs, build_reader_cost: 1.281325ms, scan_cost: 335.922µs, convert_cost: 869.642µs, yield_cost: 84.503µs, total_cost: 4.393835ms, num_batches: 2, num_rows: 6, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.688181ms
2024-08-28T16:27:45.527763Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.527856Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 1.23054ms, num_fetch_by_batches: 2, num_fetch_by_rows: 0, num_input_rows: 6, num_output_rows: 6, fetch_cost: 1.180615ms }
2024-08-28T16:27:45.528613Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 3.739007ms, first_consume: 7.501756ms, do_get_cost: 3.761659ms
2024-08-28T16:27:45.530260Z  INFO log: insert into demo values($1, …; rows affected: 1, rows returned: 0, elapsed: 9.296ms

insert into
  demo
values
($1, $2, $3, $4)
  
2024-08-28T16:27:45.531192Z  INFO servers::server: MySQL server is shutdown.
2024-08-28T16:27:45.533606Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.533878Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.534256Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.534874Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.536336Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 9.521ms

insert into
  demo
values
(?, ?, ?, ?, ?)
  
2024-08-28T16:27:45.537533Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$3": Some(
        Date(
            DateType,
        ),
    ),
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$4": Some(
        DateTime(
            DateTimeType,
        ),
    ),
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$5": Some(
        Binary(
            BinaryType,
        ),
    ),
}, params: "(Value(UInt(6)), MYSQL_TYPE_LONG), (Value(UInt(6)), MYSQL_TYPE_LONG), (Value(Date([223, 7, 4, 10])), MYSQL_TYPE_DATE), (Value(Datetime([178, 7, 1, 1, 0, 1, 0, 0, 0, 0, 0])), MYSQL_TYPE_TIMESTAMP), (Value(Bytes([104, 101, 108, 108, 111, 54])), MYSQL_TYPE_BLOB)")
2024-08-28T16:27:45.537722Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 247.058µs }
2024-08-28T16:27:45.537806Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 494.764µs
2024-08-28T16:27:45.537842Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts, column3 AS d, column4 AS dt, column5 AS b
    Values: (Int64(6), TimestampMillisecond(6, None), Date32("2015-04-10"), Date64("1970-01-01"), Binary("104,101,108,108,111,54"))
2024-08-28T16:27:45.538018Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.728628ms, build_parts_cost: 80.534µs, build_reader_cost: 494.764µs, scan_cost: 81.526µs, convert_cost: 21.232µs, yield_cost: 26.006µs, total_cost: 4.444149ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.743987ms
2024-08-28T16:27:45.538072Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.538104Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 422.555µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 399.361µs }
2024-08-28T16:27:45.538510Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 3.489748ms, first_consume: 6.428055ms, do_get_cost: 2.917583ms
2024-08-28T16:27:45.539424Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.544668Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 2, 3]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.545154Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.545683Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
test integration_sql_file_test::test_mysql_async_timestamp ... ok
2024-08-28T16:27:45.546170Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.546414Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.546658Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.546760Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.547445Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.548288Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 10, num_batches: 1, scan_cost: 375.521µs }
2024-08-28T16:27:45.548310Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 628.25µs
2024-08-28T16:27:45.548825Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.045833ms, build_parts_cost: 115.096µs, build_reader_cost: 628.25µs, scan_cost: 372.081µs, convert_cost: 24.058µs, yield_cost: 29.924µs, total_cost: 4.225217ms, num_batches: 1, num_rows: 10, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.084575ms
2024-08-28T16:27:45.548902Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.548940Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 763.418µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 10, num_output_rows: 10, fetch_cost: 735.505µs }
2024-08-28T16:27:45.549351Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 170.591µs }
2024-08-28T16:27:45.549374Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 312.018µs
2024-08-28T16:27:45.549426Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 10.519ms

insert into
  demo
values
(?, ?, ?, ?, ?)
  
2024-08-28T16:27:45.549664Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.89827ms, build_parts_cost: 81.743µs, build_reader_cost: 312.018µs, scan_cost: 168.119µs, convert_cost: 17.96µs, yield_cost: 25.209µs, total_cost: 3.517318ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.920135ms
2024-08-28T16:27:45.549737Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.549765Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 361.352µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 328.934µs }
2024-08-28T16:27:45.550228Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$5": Some(
        Binary(
            BinaryType,
        ),
    ),
    "$3": Some(
        Date(
            DateType,
        ),
    ),
    "$4": Some(
        DateTime(
            DateTimeType,
        ),
    ),
}, params: "(Value(UInt(7)), MYSQL_TYPE_LONG), (Value(UInt(7)), MYSQL_TYPE_LONG), (Value(Date([223, 7, 4, 10])), MYSQL_TYPE_DATE), (Value(Datetime([178, 7, 1, 1, 0, 1, 0, 0, 0, 0, 0])), MYSQL_TYPE_TIMESTAMP), (Value(Bytes([104, 101, 108, 108, 111, 55])), MYSQL_TYPE_BLOB)")
2024-08-28T16:27:45.550531Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts, column3 AS d, column4 AS dt, column5 AS b
    Values: (Int64(7), TimestampMillisecond(7, None), Date32("2015-04-10"), Date64("1970-01-01"), Binary("104,101,108,108,111,55"))
2024-08-28T16:27:45.550630Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.576254ms, first_consume: 7.075691ms, do_get_cost: 4.474738ms
2024-08-28T16:27:45.551094Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 2.292205ms, first_consume: 5.348326ms, do_get_cost: 3.03867ms
2024-08-28T16:27:45.551980Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.552030Z  INFO log: select i,d,dt from demo; rows affected: 10, rows returned: 10, elapsed: 21.181ms  
2024-08-28T16:27:45.558567Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.558905Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.559333Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.560095Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.561969Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 10.131ms

insert into
  demo
values
(?, ?, ?, ?, ?)
  
2024-08-28T16:27:45.562086Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 263.236µs }
2024-08-28T16:27:45.562140Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 543.268µs
2024-08-28T16:27:45.562513Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.063322ms, build_parts_cost: 110.876µs, build_reader_cost: 543.268µs, scan_cost: 217.832µs, convert_cost: 24.86µs, yield_cost: 30.744µs, total_cost: 3.983981ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.078032ms
2024-08-28T16:27:45.562610Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.562654Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 588.808µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 558.26µs }
2024-08-28T16:27:45.562907Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$4": Some(
        DateTime(
            DateTimeType,
        ),
    ),
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$3": Some(
        Date(
            DateType,
        ),
    ),
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$5": Some(
        Binary(
            BinaryType,
        ),
    ),
}, params: "(Value(UInt(8)), MYSQL_TYPE_LONG), (Value(UInt(8)), MYSQL_TYPE_LONG), (Value(Date([223, 7, 4, 10])), MYSQL_TYPE_DATE), (Value(Datetime([178, 7, 1, 1, 0, 1, 0, 0, 0, 0, 0])), MYSQL_TYPE_TIMESTAMP), (Value(Bytes([104, 101, 108, 108, 111, 56])), MYSQL_TYPE_BLOB)")
2024-08-28T16:27:45.563170Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 2.904349ms, first_consume: 6.200379ms, do_get_cost: 3.274011ms
2024-08-28T16:27:45.563167Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts, column3 AS d, column4 AS dt, column5 AS b
    Values: (Int64(8), TimestampMillisecond(8, None), Date32("2015-04-10"), Date64("1970-01-01"), Binary("104,101,108,108,111,56"))
2024-08-28T16:27:45.564400Z DEBUG log: executing simple query: SET DATESTYLE='SQL', 'MDY'    
2024-08-28T16:27:45.565540Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.567118Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.567402Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.567738Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.568626Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.571769Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 10, num_batches: 1, scan_cost: 372.302µs }
2024-08-28T16:27:45.571811Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 623.811µs
2024-08-28T16:27:45.572229Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 4.06678ms, build_parts_cost: 116.991µs, build_reader_cost: 623.811µs, scan_cost: 280.455µs, convert_cost: 28.668µs, yield_cost: 25.953µs, total_cost: 5.134898ms, num_batches: 1, num_rows: 10, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 4.093584ms
2024-08-28T16:27:45.572308Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.572347Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 690.72µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 10, num_output_rows: 10, fetch_cost: 662.703µs }
2024-08-28T16:27:45.572874Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.573129Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.573252Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 4.05241ms, first_consume: 6.616269ms, do_get_cost: 2.531691ms
2024-08-28T16:27:45.573424Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 8.967ms

insert into
  demo
values
(?, ?, ?, ?, ?)
  
2024-08-28T16:27:45.573430Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.574081Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.574340Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
    "$2": Some(
        Timestamp(
            Millisecond(
                TimestampMillisecondType,
            ),
        ),
    ),
    "$5": Some(
        Binary(
            BinaryType,
        ),
    ),
    "$3": Some(
        Date(
            DateType,
        ),
    ),
    "$4": Some(
        DateTime(
            DateTimeType,
        ),
    ),
}, params: "(Value(UInt(9)), MYSQL_TYPE_LONG), (Value(UInt(9)), MYSQL_TYPE_LONG), (Value(Date([223, 7, 4, 10])), MYSQL_TYPE_DATE), (Value(Datetime([178, 7, 1, 1, 0, 1, 0, 0, 0, 0, 0])), MYSQL_TYPE_TIMESTAMP), (Value(Bytes([104, 101, 108, 108, 111, 57])), MYSQL_TYPE_BLOB)")
2024-08-28T16:27:45.574621Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, column2 AS ts, column3 AS d, column4 AS dt, column5 AS b
    Values: (Int64(9), TimestampMillisecond(9, None), Date32("2015-04-10"), Date64("1970-01-01"), Binary("104,101,108,108,111,57"))
2024-08-28T16:27:45.576432Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 256.489µs }
2024-08-28T16:27:45.576512Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 542.797µs
2024-08-28T16:27:45.576716Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.115959ms, build_parts_cost: 83.072µs, build_reader_cost: 542.797µs, scan_cost: 99.749µs, convert_cost: 19.702µs, yield_cost: 19.141µs, total_cost: 3.870057ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.130001ms
2024-08-28T16:27:45.576776Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.576808Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 510.407µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 489.562µs }
2024-08-28T16:27:45.576880Z  INFO log: select i from demo …; rows affected: 1, rows returned: 1, elapsed: 22.458ms

select
  i
from
  demo
where
  i = $1
  
2024-08-28T16:27:45.577196Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.986973ms, first_consume: 5.694464ms, do_get_cost: 2.68899ms
2024-08-28T16:27:45.578258Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.584882Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.585186Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.585519Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.585856Z  INFO log: insert into demo values(?, …; rows affected: 1, rows returned: 0, elapsed: 9.964ms

insert into
  demo
values
(?, ?, ?, ?, ?)
  
2024-08-28T16:27:45.585914Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.586191Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.586219Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.586543Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.587210Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.587312Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 286.291µs }
2024-08-28T16:27:45.587512Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 681.683µs
2024-08-28T16:27:45.587739Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.961413ms, build_parts_cost: 92.316µs, build_reader_cost: 681.683µs, scan_cost: 104.571µs, convert_cost: 22.338µs, yield_cost: 27.435µs, total_cost: 2.889907ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.98179ms
2024-08-28T16:27:45.587797Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.587824Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 619.96µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 596.404µs }
2024-08-28T16:27:45.587915Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 10, num_batches: 1, scan_cost: 263.491µs }
2024-08-28T16:27:45.587936Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 410.869µs
2024-08-28T16:27:45.588294Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.630833ms, build_parts_cost: 89.101µs, build_reader_cost: 410.869µs, scan_cost: 220.753µs, convert_cost: 17.793µs, yield_cost: 25.756µs, total_cost: 2.414089ms, num_batches: 1, num_rows: 10, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.650039ms
2024-08-28T16:27:45.588381Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.588418Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 514.866µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 10, num_output_rows: 10, fetch_cost: 498.078µs }
2024-08-28T16:27:45.589501Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 1.892633ms, first_consume: 4.830194ms, do_get_cost: 2.918779ms
2024-08-28T16:27:45.589809Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 1.525743ms, first_consume: 3.867591ms, do_get_cost: 2.324394ms
2024-08-28T16:27:45.590703Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.591991Z  INFO log: delete from demo; rows affected: 10, rows returned: 0, elapsed: 14.340ms  
2024-08-28T16:27:45.594600Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {}, params: "")
2024-08-28T16:27:45.594719Z DEBUG servers::mysql::handler: Mysql execute prepared plan: MergeScan [is_placeholder=false]
2024-08-28T16:27:45.598437Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.598757Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.599198Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.599922Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.599898Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 2, 3, 4]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.600266Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.600740Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.601530Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 295.96µs }
2024-08-28T16:27:45.601623Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.601674Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 654.243µs
2024-08-28T16:27:45.601688Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.601899Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.605186ms, build_parts_cost: 105.763µs, build_reader_cost: 654.243µs, scan_cost: 97.138µs, convert_cost: 17.933µs, yield_cost: 28.312µs, total_cost: 3.505035ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.627366ms
2024-08-28T16:27:45.601909Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.601969Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.602004Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 585.782µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 558.041µs }
2024-08-28T16:27:45.602254Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.602913Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.602979Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 10, num_batches: 1, scan_cost: 419.336µs }
2024-08-28T16:27:45.603220Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 827.517µs
2024-08-28T16:27:45.603377Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 2.361675ms, first_consume: 5.550213ms, do_get_cost: 3.16987ms
2024-08-28T16:27:45.603491Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.507757ms, build_parts_cost: 117.125µs, build_reader_cost: 827.517µs, scan_cost: 117.178µs, convert_cost: 19.872µs, yield_cost: 36.452µs, total_cost: 3.626145ms, num_batches: 1, num_rows: 10, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.533883ms
2024-08-28T16:27:45.603593Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.603668Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 753.295µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 10, num_output_rows: 10, fetch_cost: 732.409µs }
2024-08-28T16:27:45.604128Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 10, num_batches: 1, scan_cost: 777.603µs }
2024-08-28T16:27:45.604224Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 1.013076ms
2024-08-28T16:27:45.604417Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.599141ms, build_parts_cost: 82.872µs, build_reader_cost: 1.013076ms, scan_cost: 114.851µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 2.817648ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.618332ms
2024-08-28T16:27:45.604487Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 10, num_deleted_rows: 10 }
2024-08-28T16:27:45.604484Z DEBUG log: executing simple query: SET DATESTYLE='SQL', 'DMY'    
2024-08-28T16:27:45.604525Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 972.86µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 10, num_output_rows: 10, fetch_cost: 949.164µs }
2024-08-28T16:27:45.606014Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 0ns, first_consume: 0ns, do_get_cost: 2.90791ms
2024-08-28T16:27:45.606004Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.606569Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.384268ms, first_consume: 7.217543ms, do_get_cost: 4.809691ms
2024-08-28T16:27:45.607955Z  INFO log: select i from demo; rows affected: 0, rows returned: 0, elapsed: 15.360ms  
2024-08-28T16:27:45.608500Z  INFO servers::server: Postgres server is shutdown.
2024-08-28T16:27:45.611734Z  INFO log: select i, d, dt, …; rows affected: 0, rows returned: 10, elapsed: 22.240ms

select
  i,
  d,
  dt,
  b
from
  demo
  
2024-08-28T16:27:45.613090Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.613407Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.613830Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.614519Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.615574Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 198µs }
2024-08-28T16:27:45.615657Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 471.512µs
2024-08-28T16:27:45.615868Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.110077ms, build_parts_cost: 87.679µs, build_reader_cost: 471.512µs, scan_cost: 78.841µs, convert_cost: 18.987µs, yield_cost: 27.873µs, total_cost: 2.808583ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.128885ms
2024-08-28T16:27:45.615925Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.615962Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 379.221µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 345.012µs }
2024-08-28T16:27:45.617429Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 1.708261ms, first_consume: 4.83971ms, do_get_cost: 3.113609ms
2024-08-28T16:27:45.618511Z DEBUG log: executing simple query: SELECT d FROM date_test    
test integration_sql_file_test::test_postgres_crud ... ok
2024-08-28T16:27:45.624994Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.625313Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.625356Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
}, params: "(Value(Int(6)), MYSQL_TYPE_LONG)")
2024-08-28T16:27:45.625528Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Filter: demo.i = Int64(6)
  Projection: demo.i
    MergeScan [is_placeholder=false]
2024-08-28T16:27:45.625729Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.626367Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.628259Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 257.371µs }
2024-08-28T16:27:45.628298Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 483.443µs
2024-08-28T16:27:45.628551Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.85503ms, build_parts_cost: 83.447µs, build_reader_cost: 483.443µs, scan_cost: 138.956µs, convert_cost: 18.56µs, yield_cost: 20.085µs, total_cost: 3.60156ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.870796ms
2024-08-28T16:27:45.628620Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.628651Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 470.706µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 445.06µs }
2024-08-28T16:27:45.629012Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 2.527935ms, first_consume: 5.857429ms, do_get_cost: 3.312109ms
2024-08-28T16:27:45.630047Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.635439Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3, 4]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.635974Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.636605Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.636713Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.637063Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.637515Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.637863Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.638241Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.639144Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 260.984µs }
2024-08-28T16:27:45.639192Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 593.014µs
2024-08-28T16:27:45.639575Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.907882ms, build_parts_cost: 92.4µs, build_reader_cost: 593.014µs, scan_cost: 271.14µs, convert_cost: 18.811µs, yield_cost: 22.685µs, total_cost: 2.89868ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.926901ms
2024-08-28T16:27:45.639650Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.639678Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 701.712µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 678.171µs }
2024-08-28T16:27:45.639848Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 10, num_batches: 1, scan_cost: 481.663µs }
2024-08-28T16:27:45.640141Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 1.050914ms
2024-08-28T16:27:45.640345Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.673319ms, build_parts_cost: 154.51µs, build_reader_cost: 1.050914ms, scan_cost: 77.548µs, convert_cost: 17.671µs, yield_cost: 28.422µs, total_cost: 4.966171ms, num_batches: 1, num_rows: 10, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.708224ms
2024-08-28T16:27:45.640410Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.640445Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 894.485µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 10, num_output_rows: 10, fetch_cost: 876.168µs }
2024-08-28T16:27:45.641171Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 1.708316ms, first_consume: 5.133796ms, do_get_cost: 3.407995ms
2024-08-28T16:27:45.642319Z DEBUG log: executing simple query: SET DATESTYLE='SQL', 'YMD'    
2024-08-28T16:27:45.642583Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 3.001741ms, first_consume: 7.425274ms, do_get_cost: 4.399659ms
2024-08-28T16:27:45.643565Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
test integration_http_file_test::test_sql_api ... ok
2024-08-28T16:27:45.647173Z  INFO log: select i from demo …; rows affected: 0, rows returned: 1, elapsed: 31.593ms

select
  i
from
  demo
where
  i = ?
  
2024-08-28T16:27:45.651709Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.651983Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.652377Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.653059Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.655261Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
}, params: "(Value(Bytes([116, 101, 115, 116])), MYSQL_TYPE_VAR_STRING)")
2024-08-28T16:27:45.655278Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 308.966µs }
2024-08-28T16:27:45.655328Z DEBUG servers::mysql::writer: Failed to handle mysql query, code: InvalidArguments, db: public, error: 0: Expected type: Int64(Int64Type), actual: MYSQL_TYPE_VAR_STRING, at src/servers/src/mysql/helper.rs:169:14
2024-08-28T16:27:45.655380Z DEBUG servers::mysql::handler: Failed to replace params on execute, kind: ER_WRONG_ARGUMENTS, err: (InvalidArguments): Expected type: Int64(Int64Type), actual: MYSQL_TYPE_VAR_STRING
2024-08-28T16:27:45.655401Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 718.556µs
2024-08-28T16:27:45.655619Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.987165ms, build_parts_cost: 93.053µs, build_reader_cost: 718.556µs, scan_cost: 82.834µs, convert_cost: 23.993µs, yield_cost: 26.615µs, total_cost: 3.942128ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.012315ms
2024-08-28T16:27:45.655686Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.655716Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 641.641µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 617.774µs }
2024-08-28T16:27:45.656192Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.913936ms, first_consume: 6.044936ms, do_get_cost: 3.110491ms
2024-08-28T16:27:45.657073Z  INFO log: select i from demo …; rows affected: 0, rows returned: 0, elapsed: 7.620ms

select
  i
from
  demo
where
  i = ?
  
2024-08-28T16:27:45.657297Z  INFO main::sql: Error is error returned from database: 1210 (HY000): (InvalidArguments): Expected type: Int64(Int64Type), actual: MYSQL_TYPE_VAR_STRING
2024-08-28T16:27:45.657337Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.662537Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {}, params: "")
2024-08-28T16:27:45.662633Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Delete] table=[demo]
  MergeScan [is_placeholder=false]
2024-08-28T16:27:45.664229Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.664556Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.664998Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.665703Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.665866Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3, 4]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.666203Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.666612Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.666825Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 339.522µs }
2024-08-28T16:27:45.666929Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 661.933µs
2024-08-28T16:27:45.667169Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.06551ms, build_parts_cost: 91.497µs, build_reader_cost: 661.933µs, scan_cost: 102.61µs, convert_cost: 21.853µs, yield_cost: 30.941µs, total_cost: 2.980239ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.08579ms
2024-08-28T16:27:45.667239Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.667278Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 597.802µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 569.84µs }
2024-08-28T16:27:45.667570Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.668192Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 1.875749ms, first_consume: 5.294033ms, do_get_cost: 3.39641ms
2024-08-28T16:27:45.668464Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 10, num_batches: 1, scan_cost: 313.541µs }
2024-08-28T16:27:45.668559Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 578.053µs
2024-08-28T16:27:45.668839Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.11931ms, build_parts_cost: 147.29µs, build_reader_cost: 578.053µs, scan_cost: 119.657µs, convert_cost: 28.67µs, yield_cost: 33.941µs, total_cost: 2.992897ms, num_batches: 1, num_rows: 10, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.142507ms
2024-08-28T16:27:45.668921Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.668969Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 517.981µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 10, num_output_rows: 10, fetch_cost: 489.144µs }
2024-08-28T16:27:45.669066Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.671088Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 1.377772ms, first_consume: 4.468633ms, do_get_cost: 3.064998ms
2024-08-28T16:27:45.672983Z  INFO log: delete from demo; rows affected: 10, rows returned: 0, elapsed: 15.259ms  
2024-08-28T16:27:45.675300Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.675608Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.676062Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.676844Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.677971Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 289.105µs }
2024-08-28T16:27:45.678006Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 564.298µs
2024-08-28T16:27:45.678257Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {}, params: "")
2024-08-28T16:27:45.678328Z DEBUG servers::mysql::handler: Mysql execute prepared plan: MergeScan [is_placeholder=false]
2024-08-28T16:27:45.678409Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.146367ms, build_parts_cost: 95.254µs, build_reader_cost: 564.298µs, scan_cost: 278.434µs, convert_cost: 17.108µs, yield_cost: 19.804µs, total_cost: 3.138677ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.174398ms
2024-08-28T16:27:45.678475Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.678503Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 699.173µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 677.5µs }
2024-08-28T16:27:45.679307Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 1.928957ms, first_consume: 5.375869ms, do_get_cost: 3.429855ms
2024-08-28T16:27:45.680240Z DEBUG log: executing simple query: SET DATESTYLE='Postgres', 'MDY'    
2024-08-28T16:27:45.681182Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.681289Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.681436Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.681745Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.682372Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.684089Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 10, num_batches: 1, scan_cost: 1.042425ms }
2024-08-28T16:27:45.684139Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 1.328925ms
2024-08-28T16:27:45.684385Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.643297ms, build_parts_cost: 87.532µs, build_reader_cost: 1.328925ms, scan_cost: 180.829µs, convert_cost: 0ns, yield_cost: 0ns, total_cost: 3.230937ms, num_batches: 0, num_rows: 0, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.662374ms
2024-08-28T16:27:45.684446Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 10, num_deleted_rows: 10 }
2024-08-28T16:27:45.684473Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 1.368859ms, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 10, num_output_rows: 10, fetch_cost: 1.339777ms }
2024-08-28T16:27:45.684765Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 0ns, first_consume: 0ns, do_get_cost: 2.814968ms
2024-08-28T16:27:45.685619Z  INFO log: select i from demo; rows affected: 0, rows returned: 0, elapsed: 11.996ms  
2024-08-28T16:27:45.687151Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.687424Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.687821Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.688599Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.689591Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 211.038µs }
2024-08-28T16:27:45.689663Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 530.259µs
2024-08-28T16:27:45.689925Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.993559ms, build_parts_cost: 88.759µs, build_reader_cost: 530.259µs, scan_cost: 88.333µs, convert_cost: 21.893µs, yield_cost: 30.513µs, total_cost: 2.797911ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.013884ms
2024-08-28T16:27:45.689996Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.690033Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 460.854µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 434.69µs }
2024-08-28T16:27:45.691191Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 1.745174ms, first_consume: 4.970953ms, do_get_cost: 3.203433ms
2024-08-28T16:27:45.692080Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.692665Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
}, params: "(Value(Int(99)), MYSQL_TYPE_LONG)")
2024-08-28T16:27:45.692793Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, TimestampMillisecond(1724862465688, None) AS ts, Date32("NULL") AS d, Date64("NULL") AS dt, Binary(NULL) AS b
    Values: (Int64(99))
2024-08-28T16:27:45.698272Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.698576Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.698846Z  INFO log: insert into demo(i) values(?); rows affected: 1, rows returned: 0, elapsed: 12.449ms  
2024-08-28T16:27:45.698991Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.699785Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.701700Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 561.415µs
2024-08-28T16:27:45.701686Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 302.876µs }
2024-08-28T16:27:45.702018Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.8801ms, build_parts_cost: 96.105µs, build_reader_cost: 561.415µs, scan_cost: 174.384µs, convert_cost: 23.111µs, yield_cost: 29.948µs, total_cost: 3.764382ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.896122ms
2024-08-28T16:27:45.702101Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.702144Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 576.79µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 550.34µs }
2024-08-28T16:27:45.702674Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 2.680777ms, first_consume: 6.098125ms, do_get_cost: 3.39435ms
2024-08-28T16:27:45.703990Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.709520Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {
    "$1": Some(
        Int64(
            Int64Type,
        ),
    ),
}, params: "(Value(Int(-99)), MYSQL_TYPE_LONG)")
2024-08-28T16:27:45.709668Z DEBUG servers::mysql::handler: Mysql execute prepared plan: Dml: op=[Insert Into] table=[demo]
  Projection: column1 AS i, TimestampMillisecond(1724862465703, None) AS ts, Date32("NULL") AS d, Date64("NULL") AS dt, Binary(NULL) AS b
    Values: (Int64(-99))
2024-08-28T16:27:45.711777Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.712069Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.712444Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.713144Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.714841Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 544.116µs
2024-08-28T16:27:45.714838Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 324.624µs }
2024-08-28T16:27:45.715133Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.548333ms, build_parts_cost: 92.332µs, build_reader_cost: 544.116µs, scan_cost: 175.512µs, convert_cost: 18.488µs, yield_cost: 22.992µs, total_cost: 3.396245ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.565725ms
2024-08-28T16:27:45.715194Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.715223Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 569.552µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 544.715µs }
2024-08-28T16:27:45.715628Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 2.354216ms, first_consume: 5.343093ms, do_get_cost: 2.967675ms
2024-08-28T16:27:45.716411Z  INFO log: insert into demo(i) values(?); rows affected: 1, rows returned: 0, elapsed: 16.776ms  
2024-08-28T16:27:45.716696Z DEBUG log: executing simple query: SET DATESTYLE='Postgres', 'DMY'    
2024-08-28T16:27:45.717657Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.724571Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.724867Z DEBUG servers::mysql::handler: replace_params_with_values(param_types: {}, params: "")
2024-08-28T16:27:45.724875Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.724982Z DEBUG servers::mysql::handler: Mysql execute prepared plan: MergeScan [is_placeholder=false]
2024-08-28T16:27:45.725268Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.726050Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.727508Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 257.649µs }
2024-08-28T16:27:45.727559Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 522.527µs
2024-08-28T16:27:45.727923Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.477157ms, build_parts_cost: 102.94µs, build_reader_cost: 522.527µs, scan_cost: 262.231µs, convert_cost: 16.462µs, yield_cost: 21.688µs, total_cost: 3.39024ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.504905ms
2024-08-28T16:27:45.727989Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.728015Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 635.851µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 615.388µs }
2024-08-28T16:27:45.729496Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0, 1, 2, 3, 4]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.729666Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.242123ms, first_consume: 5.587278ms, do_get_cost: 3.325455ms
2024-08-28T16:27:45.729777Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.730118Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.730815Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.730827Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.733092Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 1.290098ms
2024-08-28T16:27:45.733079Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 12, num_batches: 1, scan_cost: 1.062047ms }
2024-08-28T16:27:45.733453Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.306719ms, build_parts_cost: 87.012µs, build_reader_cost: 1.290098ms, scan_cost: 241.003µs, convert_cost: 22.954µs, yield_cost: 26.943µs, total_cost: 3.976092ms, num_batches: 1, num_rows: 2, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.328223ms
2024-08-28T16:27:45.733516Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 10, num_deleted_rows: 10 }
2024-08-28T16:27:45.733545Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 1.320329ms, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 12, num_output_rows: 12, fetch_cost: 1.298784ms }
2024-08-28T16:27:45.733902Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.98379ms, first_consume: 6.612301ms, do_get_cost: 3.607356ms
2024-08-28T16:27:45.735024Z  INFO log: select * from demo; rows affected: 0, rows returned: 2, elapsed: 17.734ms  
2024-08-28T16:27:45.735492Z  INFO servers::server: MySQL server is shutdown.
2024-08-28T16:27:45.738609Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.738878Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.739249Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.739979Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.741494Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 239.976µs }
2024-08-28T16:27:45.741576Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 499.699µs
2024-08-28T16:27:45.742920Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.482384ms, build_parts_cost: 99.738µs, build_reader_cost: 499.699µs, scan_cost: 1.224747ms, convert_cost: 21.632µs, yield_cost: 25.827µs, total_cost: 4.337003ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.500631ms
2024-08-28T16:27:45.742991Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.743021Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 1.579176ms, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 1.554328ms }
2024-08-28T16:27:45.743368Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 3.007965ms, first_consume: 6.133135ms, do_get_cost: 3.103409ms
test integration_sql_file_test::test_mysql_crud ... ok
2024-08-28T16:27:45.744274Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.750298Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.750549Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.750873Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.751502Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.752962Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 227.181µs }
2024-08-28T16:27:45.752984Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 429.041µs
2024-08-28T16:27:45.753283Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.263672ms, build_parts_cost: 81.178µs, build_reader_cost: 429.041µs, scan_cost: 162.65µs, convert_cost: 19.256µs, yield_cost: 22.342µs, total_cost: 3.005199ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.282719ms
2024-08-28T16:27:45.753356Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.753401Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 466.092µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 443.495µs }
2024-08-28T16:27:45.754284Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 1.854291ms, first_consume: 4.635217ms, do_get_cost: 2.763001ms
2024-08-28T16:27:45.755132Z DEBUG log: executing simple query: SET DATESTYLE='Postgres', 'YMD'    
2024-08-28T16:27:45.756158Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.762057Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.762298Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.762649Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.763352Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.765118Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 202.378µs }
2024-08-28T16:27:45.765276Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 546.873µs
2024-08-28T16:27:45.765489Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.686997ms, build_parts_cost: 86.953µs, build_reader_cost: 546.873µs, scan_cost: 83.328µs, convert_cost: 21.14µs, yield_cost: 29.324µs, total_cost: 3.447992ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.697756ms
2024-08-28T16:27:45.765564Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.765598Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 487.918µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 459.124µs }
2024-08-28T16:27:45.766078Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.549167ms, first_consume: 5.428052ms, do_get_cost: 2.857984ms
2024-08-28T16:27:45.767064Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.773438Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.773718Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.774112Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.774861Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.775721Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 272.884µs }
2024-08-28T16:27:45.775764Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 542.637µs
2024-08-28T16:27:45.776221Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.789252ms, build_parts_cost: 91.539µs, build_reader_cost: 542.637µs, scan_cost: 321.459µs, convert_cost: 19.617µs, yield_cost: 26.396µs, total_cost: 2.801209ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.810446ms
2024-08-28T16:27:45.776304Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.776341Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 722.273µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 700.835µs }
2024-08-28T16:27:45.777242Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 1.809461ms, first_consume: 5.040327ms, do_get_cost: 3.21091ms
2024-08-28T16:27:45.778129Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.784375Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.784655Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.785036Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.785769Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.786820Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 254.228µs }
2024-08-28T16:27:45.786929Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 595.755µs
2024-08-28T16:27:45.787163Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.961802ms, build_parts_cost: 91.307µs, build_reader_cost: 595.755µs, scan_cost: 100.274µs, convert_cost: 21.761µs, yield_cost: 27.335µs, total_cost: 2.809433ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.983609ms
2024-08-28T16:27:45.787222Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.787250Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 533.329µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 506.932µs }
2024-08-28T16:27:45.788275Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 1.777267ms, first_consume: 4.910703ms, do_get_cost: 3.114462ms
2024-08-28T16:27:45.789142Z DEBUG log: executing simple query: SET DATESTYLE='German', 'MDY'    
2024-08-28T16:27:45.790166Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.796255Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.796523Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.796907Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.797721Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.798635Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 288.324µs }
2024-08-28T16:27:45.798655Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 555.333µs
2024-08-28T16:27:45.799074Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.835842ms, build_parts_cost: 93.182µs, build_reader_cost: 555.333µs, scan_cost: 257.358µs, convert_cost: 20.706µs, yield_cost: 25.623µs, total_cost: 2.838667ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.871026ms
2024-08-28T16:27:45.799148Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.799176Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 663.73µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 636.949µs }
2024-08-28T16:27:45.800337Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 1.745647ms, first_consume: 5.009757ms, do_get_cost: 3.247652ms
2024-08-28T16:27:45.801330Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.807840Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.808136Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.808542Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.809357Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.811178Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 280.296µs }
2024-08-28T16:27:45.811204Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 573.63µs
2024-08-28T16:27:45.811538Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.804889ms, build_parts_cost: 99.342µs, build_reader_cost: 573.63µs, scan_cost: 189.649µs, convert_cost: 23.087µs, yield_cost: 32.073µs, total_cost: 3.716428ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.81909ms
2024-08-28T16:27:45.811632Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.811682Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 589.127µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 562.775µs }
2024-08-28T16:27:45.812174Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 2.653893ms, first_consume: 6.137857ms, do_get_cost: 3.457294ms
2024-08-28T16:27:45.813374Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.821276Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.821597Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.821997Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.822777Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.824491Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 570.716µs
2024-08-28T16:27:45.824493Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 307.208µs }
2024-08-28T16:27:45.824979Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.66356ms, build_parts_cost: 97.44µs, build_reader_cost: 570.716µs, scan_cost: 344.148µs, convert_cost: 24.564µs, yield_cost: 28.602µs, total_cost: 3.735039ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.686372ms
2024-08-28T16:27:45.825062Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.825106Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 731.058µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 705.058µs }
2024-08-28T16:27:45.826230Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 2.673112ms, first_consume: 6.132699ms, do_get_cost: 3.439037ms
2024-08-28T16:27:45.827352Z DEBUG log: executing simple query: SET DATESTYLE='German', 'DMY'    
2024-08-28T16:27:45.828536Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.835373Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.835630Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.836069Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.836806Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.837862Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 251.291µs }
2024-08-28T16:27:45.837908Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 536.777µs
2024-08-28T16:27:45.838347Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.012125ms, build_parts_cost: 98.084µs, build_reader_cost: 536.777µs, scan_cost: 325.467µs, convert_cost: 18.865µs, yield_cost: 24.986µs, total_cost: 3.002418ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.033643ms
2024-08-28T16:27:45.838420Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.838454Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 703.991µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 678.399µs }
2024-08-28T16:27:45.839660Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 1.931945ms, first_consume: 4.866661ms, do_get_cost: 2.91707ms
2024-08-28T16:27:45.840647Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.847169Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.847491Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.847935Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.848715Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.851473Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 606.779µs
2024-08-28T16:27:45.851468Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 332.965µs }
2024-08-28T16:27:45.851771Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.427921ms, build_parts_cost: 98.34µs, build_reader_cost: 606.779µs, scan_cost: 180.066µs, convert_cost: 19.112µs, yield_cost: 21.795µs, total_cost: 4.636729ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.707511ms
2024-08-28T16:27:45.851832Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.851860Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 628.536µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 606.007µs }
2024-08-28T16:27:45.852211Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 3.404132ms, first_consume: 6.866886ms, do_get_cost: 3.445712ms
2024-08-28T16:27:45.853205Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.859909Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.860293Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.860801Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.861528Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.863341Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 318.007µs }
2024-08-28T16:27:45.863358Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 608.556µs
2024-08-28T16:27:45.863737Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.874523ms, build_parts_cost: 94.426µs, build_reader_cost: 608.556µs, scan_cost: 191.272µs, convert_cost: 32.881µs, yield_cost: 33.662µs, total_cost: 3.863314ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.889811ms
2024-08-28T16:27:45.863830Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.863877Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 639.394µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 609.621µs }
2024-08-28T16:27:45.864446Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 2.582173ms, first_consume: 6.415082ms, do_get_cost: 3.8091ms
2024-08-28T16:27:45.865822Z DEBUG log: executing simple query: SET DATESTYLE='German', 'YMD'    
2024-08-28T16:27:45.867059Z DEBUG log: executing simple query: SELECT ts FROM ts_test    
2024-08-28T16:27:45.874934Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4398046511104(1024, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.875196Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.875524Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.876117Z DEBUG read_from_region: mito2::read::scan_region: Region 4398046511104(1024, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.878062Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4398046511104(1024, 0), range_id: 0, from sources, build_reader_cost: 588.281µs
2024-08-28T16:27:45.878053Z DEBUG mito2::memtable::time_series: Iter 4398046511104(1024, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 306.512µs }
2024-08-28T16:27:45.878365Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4398046511104(1024, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 2.571482ms, build_parts_cost: 77.488µs, build_reader_cost: 588.281µs, scan_cost: 177.02µs, convert_cost: 21.438µs, yield_cost: 24.195µs, total_cost: 3.466218ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 2.582947ms
2024-08-28T16:27:45.878432Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.878460Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 601.602µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 575.696µs }
2024-08-28T16:27:45.878863Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4398046511104(1024, 0), poll_duration: 2.595741ms, first_consume: 5.333795ms, do_get_cost: 2.720642ms
2024-08-28T16:27:45.879979Z DEBUG log: executing simple query: SELECT d FROM date_test    
2024-08-28T16:27:45.887237Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4402341478400(1025, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.887526Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.887902Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.888543Z DEBUG read_from_region: mito2::read::scan_region: Region 4402341478400(1025, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.891695Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4402341478400(1025, 0), range_id: 0, from sources, build_reader_cost: 555.818µs
2024-08-28T16:27:45.891705Z DEBUG mito2::memtable::time_series: Iter 4402341478400(1025, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 267.436µs }
2024-08-28T16:27:45.892078Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4402341478400(1025, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 3.921145ms, build_parts_cost: 87.31µs, build_reader_cost: 555.818µs, scan_cost: 253.936µs, convert_cost: 20.813µs, yield_cost: 27.195µs, total_cost: 4.867898ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 3.937896ms
2024-08-28T16:27:45.892162Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.892189Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 636.971µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 611.866µs }
2024-08-28T16:27:45.892546Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4402341478400(1025, 0), poll_duration: 3.881764ms, first_consume: 6.915611ms, do_get_cost: 3.016776ms
2024-08-28T16:27:45.893543Z DEBUG log: executing simple query: SELECT dt FROM dt_test    
2024-08-28T16:27:45.899942Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan:handle_query: mito2::read::scan_region: Scan region 4406636445696(1026, 0), request: ScanRequest { projection: Some([0]), filters: [], output_ordering: None, limit: None, series_row_selector: None }, memtables: 1, ssts_to_read: 0, append_mode: false
2024-08-28T16:27:45.900260Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:create_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.900636Z DEBUG RegionInvoker::handle_query:handle_read:exec_query_plan:optimize_physical_plan: query::optimizer::parallelize_scan: Assign 0 ranges to 51 partitions
2024-08-28T16:27:45.901333Z DEBUG read_from_region: mito2::read::scan_region: Region 4406636445696(1026, 0) prune 0 files, cost is 0ns
2024-08-28T16:27:45.902237Z DEBUG mito2::memtable::time_series: Iter 4406636445696(1026, 0) time series memtable, metrics: Metrics { total_series: 1, num_pruned_series: 0, num_rows: 1, num_batches: 1, scan_cost: 302.794µs }
2024-08-28T16:27:45.902335Z DEBUG read_from_region: mito2::read::seq_scan: Build reader region: 4406636445696(1026, 0), range_id: 0, from sources, build_reader_cost: 670.494µs
2024-08-28T16:27:45.902542Z DEBUG read_from_region: mito2::read::seq_scan: Seq scan finished, region_id: 4406636445696(1026, 0), partition: 0, id: 0, metrics: ScannerMetrics { prepare_scan_cost: 1.740715ms, build_parts_cost: 87.512µs, build_reader_cost: 670.494µs, scan_cost: 86.307µs, convert_cost: 18.265µs, yield_cost: 26.147µs, total_cost: 2.634785ms, num_batches: 1, num_rows: 1, filter_metrics: ReaderFilterMetrics { num_row_groups_before_filtering: 0, num_row_groups_fulltext_index_filtered: 0, num_row_groups_inverted_index_filtered: 0, num_row_groups_min_max_filtered: 0, num_rows_precise_filtered: 0, num_rows_in_row_group_before_filtering: 0, num_rows_in_row_group_fulltext_index_filtered: 0, num_rows_in_row_group_inverted_index_filtered: 0 } }, first_poll: 1.758919ms
2024-08-28T16:27:45.902599Z DEBUG read_from_region: mito2::read::dedup: Dedup reader finished, metrics: DedupMetrics { num_unselected_rows: 0, num_deleted_rows: 0 }
2024-08-28T16:27:45.902627Z DEBUG read_from_region: mito2::read::merge: Merge reader finished, metrics: Metrics { scan_cost: 592.808µs, num_fetch_by_batches: 1, num_fetch_by_rows: 0, num_input_rows: 1, num_output_rows: 1, fetch_cost: 566.504µs }
2024-08-28T16:27:45.903957Z DEBUG query::dist_plan::merge_scan: Merge scan stop poll stream, partition: 0, region_id: 4406636445696(1026, 0), poll_duration: 1.554337ms, first_consume: 4.65568ms, do_get_cost: 3.084453ms
2024-08-28T16:27:45.905482Z  INFO servers::server: Postgres server is shutdown.
test integration_sql_file_test::test_postgres_datestyle ... ok

failures:

---- integration_http_file_test::test_pipeline_api stdout ----
thread 'integration_http_file_test::test_pipeline_api' panicked at tests-integration/tests/http.rs:1109:5:
assertion `left == right` failed
  left: 400
 right: 200
note: run with `RUST_BACKTRACE=1` environment variable to display a backtrace


failures:
    integration_http_file_test::test_pipeline_api

test result: FAILED. 185 passed; 1 failed; 0 ignored; 0 measured; 0 filtered out; finished in 3.26s

